<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>yaze: Build Instructions</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../yaze.ico"/></td>
  <td id="projectalign">
   <div id="projectname">yaze<span id="projectnumber">&#160;0.3.2</span>
   </div>
   <div id="projectbrief">Link to the Past ROM Editor</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dc/d42/md_docs_2B1-build-instructions.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Build Instructions</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md24"></a> yaze uses a modern CMake build system with presets for easy configuration. This guide covers how to build yaze on macOS, Linux, and Windows.</p>
<h1><a class="anchor" id="autotoc_md25"></a>
1. Environment Verification</h1>
<p><b>Before your first build</b>, run the verification script to ensure your environment is configured correctly.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
Windows (PowerShell)</h2>
<div class="fragment"><div class="line">.\scripts\verify-build-environment.ps1</div>
<div class="line"> </div>
<div class="line"># With automatic fixes</div>
<div class="line">.\scripts\verify-build-environment.ps1 -FixIssues</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md27"></a>
macOS &amp; Linux (Bash)</h2>
<div class="fragment"><div class="line">./scripts/verify-build-environment.sh</div>
<div class="line"> </div>
<div class="line"># With automatic fixes</div>
<div class="line">./scripts\verify-build-environment.sh --fix</div>
</div><!-- fragment --><p>The script checks for required tools like CMake, a C++23 compiler, and platform-specific dependencies.</p>
<h1><a class="anchor" id="autotoc_md28"></a>
2. Quick Start: Building with Presets</h1>
<p>We use CMake Presets for simple, one-command builds. See the <a class="el" href="../../d7/d51/md_docs_2B3-build-presets.html">CMake Presets Guide</a> for a full list.</p>
<h2><a class="anchor" id="autotoc_md29"></a>
macOS</h2>
<div class="fragment"><div class="line"># Configure a debug build (Apple Silicon)</div>
<div class="line">cmake --preset mac-dbg</div>
<div class="line"> </div>
<div class="line"># Build the project</div>
<div class="line">cmake --build --preset mac-dbg</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md30"></a>
Linux</h2>
<div class="fragment"><div class="line"># Configure a debug build</div>
<div class="line">cmake --preset lin-dbg</div>
<div class="line"> </div>
<div class="line"># Build the project</div>
<div class="line">cmake --build --preset lin-dbg</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md31"></a>
Windows</h2>
<div class="fragment"><div class="line"># Configure a debug build for Visual Studio (x64)</div>
<div class="line">cmake --preset win-dbg</div>
<div class="line"> </div>
<div class="line"># Build the project</div>
<div class="line">cmake --build --preset win-dbg</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md32"></a>
AI-Enabled Build (All Platforms)</h2>
<p>To build with the <code>z3ed</code> AI agent features: </p><div class="fragment"><div class="line"># macOS</div>
<div class="line">cmake --preset mac-ai</div>
<div class="line">cmake --build --preset mac-ai</div>
<div class="line"> </div>
<div class="line"># Windows</div>
<div class="line">cmake --preset win-ai</div>
<div class="line">cmake --build --preset win-ai</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md33"></a>
3. Dependencies</h1>
<ul>
<li><b>Required</b>: CMake 3.16+, C++23 Compiler (GCC 13+, Clang 16+, MSVC 2019+), Git.</li>
<li><b>Bundled</b>: All other dependencies (SDL2, <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a>, Abseil, Asar, GoogleTest, etc.) are included as Git submodules or managed by CMake's <code>FetchContent</code>. No external package manager is required for a basic build.</li>
<li><b>Optional</b>:<ul>
<li><b>gRPC</b>: For GUI test automation. Can be enabled with <code>-DYAZE_WITH_GRPC=ON</code>.</li>
<li><b>vcpkg (Windows)</b>: Can be used for dependency management, but is not required.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md34"></a>
4. Platform Setup</h1>
<h2><a class="anchor" id="autotoc_md35"></a>
macOS</h2>
<div class="fragment"><div class="line"># Install Xcode Command Line Tools</div>
<div class="line">xcode-select --install</div>
<div class="line"> </div>
<div class="line"># Recommended: Install build tools via Homebrew</div>
<div class="line">brew install cmake pkg-config</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md36"></a>
Linux (Ubuntu/Debian)</h2>
<div class="fragment"><div class="line">sudo apt-get update</div>
<div class="line">sudo apt-get install -y build-essential cmake ninja-build pkg-config \</div>
<div class="line">  libgtk-3-dev libdbus-1-dev</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md37"></a>
Windows</h2>
<ul>
<li><b>Visual Studio 2022</b> is required, with the "Desktop development with C++" workload.</li>
<li>The <code>verify-build-environment.ps1</code> script will help identify any missing components.</li>
<li>For building with gRPC, see the "Windows Build Optimization" section below.</li>
</ul>
<h1><a class="anchor" id="autotoc_md38"></a>
5. Testing</h1>
<p>The project uses CTest and GoogleTest. Tests are organized into categories using labels. See the <a class="el" href="../../d6/d10/md_docs_2A1-testing-guide.html">Testing Guide</a> for details.</p>
<h2><a class="anchor" id="autotoc_md39"></a>
Running Tests with Presets</h2>
<p>The easiest way to run tests is with <code>ctest</code> presets.</p>
<div class="fragment"><div class="line"># Configure a development build (enables ROM-dependent tests)</div>
<div class="line">cmake --preset mac-dev -DYAZE_TEST_ROM_PATH=/path/to/your/zelda3.sfc</div>
<div class="line"> </div>
<div class="line"># Build the tests</div>
<div class="line">cmake --build --preset mac-dev --target yaze_test</div>
<div class="line"> </div>
<div class="line"># Run stable tests (fast, run in CI)</div>
<div class="line">ctest --preset dev</div>
<div class="line"> </div>
<div class="line"># Run all tests, including ROM-dependent and experimental</div>
<div class="line">ctest --preset all</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md40"></a>
Running Tests Manually</h2>
<p>You can also run tests by invoking the test executable directly or using CTest with labels.</p>
<div class="fragment"><div class="line"># Run all tests via the executable</div>
<div class="line">./build/bin/yaze_test</div>
<div class="line"> </div>
<div class="line"># Run only stable tests using CTest labels</div>
<div class="line">ctest --test-dir build --label-regex &quot;STABLE&quot;</div>
<div class="line"> </div>
<div class="line"># Run tests matching a name</div>
<div class="line">ctest --test-dir build -R &quot;AsarWrapperTest&quot;</div>
<div class="line"> </div>
<div class="line"># Exclude ROM-dependent tests</div>
<div class="line">ctest --test-dir build --label-exclude &quot;ROM_DEPENDENT&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md41"></a>
6. IDE Integration</h1>
<h2><a class="anchor" id="autotoc_md42"></a>
VS Code (Recommended)</h2>
<ol type="1">
<li>Install the <b>CMake Tools</b> extension.</li>
<li>Open the project folder.</li>
<li>Select a preset from the status bar (e.g., <code>mac-ai</code>).</li>
<li>Press F5 to build and debug.</li>
<li>After changing presets, run <code>cp build/compile_commands.json .</code> to update IntelliSense.</li>
</ol>
<h2><a class="anchor" id="autotoc_md43"></a>
Visual Studio (Windows)</h2>
<ol type="1">
<li>Select <b>File → Open → Folder</b> and choose the <code>yaze</code> directory.</li>
<li>Visual Studio will automatically detect <code>CMakePresets.json</code>.</li>
<li>Select the desired preset (e.g., <code>win-dbg</code> or <code>win-ai</code>) from the configuration dropdown.</li>
<li>Press F5 to build and run.</li>
</ol>
<h2><a class="anchor" id="autotoc_md44"></a>
Xcode (macOS)</h2>
<div class="fragment"><div class="line"># Generate an Xcode project from a preset</div>
<div class="line">cmake --preset mac-dbg -G Xcode</div>
<div class="line"> </div>
<div class="line"># Open the project</div>
<div class="line">open build/yaze.xcodeproj</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md45"></a>
7. Windows Build Optimization</h1>
<h2><a class="anchor" id="autotoc_md46"></a>
The Problem: Slow gRPC Builds</h2>
<p>Building with gRPC on Windows (<code>-DYAZE_WITH_GRPC=ON</code>) can take <b>15-20 minutes</b> the first time, as it compiles gRPC and its dependencies from source.</p>
<h2><a class="anchor" id="autotoc_md47"></a>
Solution: Use vcpkg for Pre-compiled Binaries</h2>
<p>Using <code>vcpkg</code> to manage gRPC is the recommended approach for Windows developers who need GUI automation features.</p>
<p><b>Step 1: Install vcpkg and Dependencies</b> </p><div class="fragment"><div class="line"># This only needs to be done once</div>
<div class="line">vcpkg install grpc:x64-windows protobuf:x64-windows abseil:x64-windows</div>
</div><!-- fragment --><p><b>Step 2: Configure CMake to Use vcpkg</b> Pass the <code>vcpkg.cmake</code> toolchain file to your configure command.</p>
<div class="fragment"><div class="line"># Configure a build that uses vcpkg for gRPC</div>
<div class="line">cmake -B build -DYAZE_WITH_GRPC=ON `</div>
<div class="line">  -DCMAKE_TOOLCHAIN_FILE=&quot;$VCPKG_ROOT/scripts/buildsystems/vcpkg.cmake&quot;</div>
<div class="line"> </div>
<div class="line"># Build (will now be much faster)</div>
<div class="line">cmake --build build</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md48"></a>
8. Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md49"></a>
"nlohmann/json.hpp: No such file or directory"</h2>
<p><b>Cause</b>: You are building code that requires AI features without using an AI-enabled preset. <b>Solution</b>: Use an AI preset like <code>win-ai</code> or <code>mac-ai</code>. </p><div class="fragment"><div class="line">cmake --preset win-ai</div>
<div class="line">cmake --build --preset win-ai</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md50"></a>
"Cannot open file 'yaze.exe': Permission denied"</h2>
<p><b>Cause</b>: A previous instance of <code>yaze.exe</code> is still running in the background. <b>Solution</b>: Close it using Task Manager or run: </p><div class="fragment"><div class="line">taskkill /F /IM yaze.exe</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md51"></a>
"C++ standard 'cxx_std_23' not supported"</h2>
<p><b>Cause</b>: Your compiler is too old. <b>Solution</b>: Update your tools. You need Visual Studio 2022 17.4+, GCC 13+, or Clang 16+.</p>
<h2><a class="anchor" id="autotoc_md52"></a>
Visual Studio Can't Find Presets</h2>
<p><b>Cause</b>: VS failed to parse <code>CMakePresets.json</code>. <b>Solution</b>: Close and reopen the folder (<code>File -&gt; Close Folder</code>). If that fails, check the "CMake" pane in the Output window for specific JSON parsing errors.</p>
<h2><a class="anchor" id="autotoc_md53"></a>
General Advice</h2>
<ol type="1">
<li><b>Start Simple</b>: Begin with a basic preset like <code>win-dbg</code> or <code>mac-dbg</code>.</li>
<li><b>Clean Build</b>: If you switch presets or make major changes to <code>CMakeLists.txt</code>, delete the <code>build</code> directory and re-configure.</li>
<li><b>Use the Script</b>: <code>verify-build-environment.sh</code> and <code>.ps1</code> can diagnose most toolchain issues. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
