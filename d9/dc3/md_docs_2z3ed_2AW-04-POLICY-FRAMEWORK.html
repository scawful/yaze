<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>yaze: Policy Evaluation Framework (AW-04)</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../yaze.ico"/></td>
  <td id="projectalign">
   <div id="projectname">yaze<span id="projectnumber">&#160;0.3.1</span>
   </div>
   <div id="projectbrief">Link to the Past ROM Editor</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d9/dc3/md_docs_2z3ed_2AW-04-POLICY-FRAMEWORK.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Policy Evaluation Framework (AW-04)</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1131"></a> <b>Status</b>: Implementation In Progress <br  />
 <b>Priority</b>: High (Next Phase) <br  />
 <b>Time Estimate</b>: 6-8 hours <br  />
 <b>Last Updated</b>: October 2, 2025</p>
<h1><a class="anchor" id="autotoc_md1132"></a>
Overview</h1>
<p>The Policy Evaluation Framework provides a YAML-based constraint system for gating proposal acceptance in the z3ed agent workflow. It ensures that AI-generated ROM modifications meet quality, safety, and testing requirements before being merged into the main ROM.</p>
<h1><a class="anchor" id="autotoc_md1133"></a>
Goals</h1>
<ol type="1">
<li><b>Quality Gates</b>: Enforce minimum test pass rates and code quality standards</li>
<li><b>Safety Constraints</b>: Prevent modifications to critical ROM regions (headers, checksums)</li>
<li><b>Scope Limits</b>: Restrict changes to reasonable byte counts and specific banks</li>
<li><b>Human Review</b>: Require manual review for large or complex changes</li>
<li><b>Flexibility</b>: Allow policy overrides with confirmation and logging</li>
</ol>
<h1><a class="anchor" id="autotoc_md1134"></a>
Architecture</h1>
<div class="fragment"><div class="line">┌─────────────────────────────────────────────────────────┐</div>
<div class="line">│ ProposalDrawer (GUI)                                    │</div>
<div class="line">│  └─ Accept button gated by PolicyEvaluator             │</div>
<div class="line">└────────────────────┬────────────────────────────────────┘</div>
<div class="line">                     │</div>
<div class="line">                     ▼</div>
<div class="line">┌─────────────────────────────────────────────────────────┐</div>
<div class="line">│ PolicyEvaluator (Singleton Service)                     │</div>
<div class="line">│  ├─ LoadPolicies() from .yaze/policies/                │</div>
<div class="line">│  ├─ EvaluateProposal(proposal_id) → PolicyResult       │</div>
<div class="line">│  └─ Cache of parsed YAML policies                      │</div>
<div class="line">└────────────────────┬────────────────────────────────────┘</div>
<div class="line">                     │</div>
<div class="line">                     ▼</div>
<div class="line">┌─────────────────────────────────────────────────────────┐</div>
<div class="line">│ .yaze/policies/agent.yaml (YAML Configuration)          │</div>
<div class="line">│  ├─ test_requirements (min pass rates)                 │</div>
<div class="line">│  ├─ change_constraints (byte limits, allowed banks)    │</div>
<div class="line">│  ├─ review_requirements (human review triggers)        │</div>
<div class="line">│  └─ forbidden_ranges (protected ROM regions)           │</div>
<div class="line">└─────────────────────────────────────────────────────────┘</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1135"></a>
YAML Policy Schema</h1>
<h2><a class="anchor" id="autotoc_md1136"></a>
Example Policy File</h2>
<div class="fragment"><div class="line"># .yaze/policies/agent.yaml</div>
<div class="line">version: 1.0</div>
<div class="line">enabled: true</div>
<div class="line"> </div>
<div class="line">policies:</div>
<div class="line">  # Policy 1: Test Requirements</div>
<div class="line">  - name: require_tests</div>
<div class="line">    type: test_requirement</div>
<div class="line">    enabled: true</div>
<div class="line">    severity: critical  # critical | warning | info</div>
<div class="line">    rules:</div>
<div class="line">      - test_suite: &quot;overworld_rendering&quot;</div>
<div class="line">        min_pass_rate: 0.95</div>
<div class="line">      - test_suite: &quot;palette_integrity&quot;</div>
<div class="line">        min_pass_rate: 1.0</div>
<div class="line">      - test_suite: &quot;dungeon_logic&quot;</div>
<div class="line">        min_pass_rate: 0.90</div>
<div class="line">    message: &quot;All required test suites must pass before accepting proposal&quot;</div>
<div class="line"> </div>
<div class="line">  # Policy 2: Change Scope Limits</div>
<div class="line">  - name: limit_change_scope</div>
<div class="line">    type: change_constraint</div>
<div class="line">    enabled: true</div>
<div class="line">    severity: critical</div>
<div class="line">    rules:</div>
<div class="line">      - max_bytes_changed: 10240  # 10KB limit</div>
<div class="line">      - allowed_banks: [0x00, 0x01, 0x0E, 0x0F]  # Graphics banks only</div>
<div class="line">      - max_commands_executed: 20</div>
<div class="line">    message: &quot;Proposal exceeds allowed change scope&quot;</div>
<div class="line"> </div>
<div class="line">  # Policy 3: Protected ROM Regions</div>
<div class="line">  - name: protect_critical_regions</div>
<div class="line">    type: forbidden_range</div>
<div class="line">    enabled: true</div>
<div class="line">    severity: critical</div>
<div class="line">    ranges:</div>
<div class="line">      - start: 0xFFB0  # ROM header</div>
<div class="line">        end: 0xFFFF</div>
<div class="line">        reason: &quot;ROM header is protected&quot;</div>
<div class="line">      - start: 0x00FFC0  # Internal header</div>
<div class="line">        end: 0x00FFDF</div>
<div class="line">        reason: &quot;Internal ROM header&quot;</div>
<div class="line">    message: &quot;Proposal modifies protected ROM region&quot;</div>
<div class="line"> </div>
<div class="line">  # Policy 4: Human Review Requirements</div>
<div class="line">  - name: human_review_required</div>
<div class="line">    type: review_requirement</div>
<div class="line">    enabled: true</div>
<div class="line">    severity: warning</div>
<div class="line">    conditions:</div>
<div class="line">      - if: bytes_changed &gt; 1024</div>
<div class="line">        then: require_diff_review</div>
<div class="line">        message: &quot;Large change requires diff review&quot;</div>
<div class="line">      - if: commands_executed &gt; 10</div>
<div class="line">        then: require_log_review</div>
<div class="line">        message: &quot;Complex operation requires log review&quot;</div>
<div class="line">      - if: test_failures &gt; 0</div>
<div class="line">        then: require_explanation</div>
<div class="line">        message: &quot;Test failures require explanation&quot;</div>
<div class="line"> </div>
<div class="line">  # Policy 5: Palette Modifications</div>
<div class="line">  - name: palette_safety</div>
<div class="line">    type: change_constraint</div>
<div class="line">    enabled: true</div>
<div class="line">    severity: warning</div>
<div class="line">    rules:</div>
<div class="line">      - max_palettes_changed: 5</div>
<div class="line">      - preserve_transparency: true  # Don&#39;t modify color index 0</div>
<div class="line">    message: &quot;Palette changes exceed safety threshold&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1137"></a>
Schema Definition</h2>
<div class="fragment"><div class="line"># Policy file structure</div>
<div class="line">version: string  # Semantic version (e.g., &quot;1.0&quot;)</div>
<div class="line">enabled: boolean  # Master enable/disable</div>
<div class="line"> </div>
<div class="line">policies:</div>
<div class="line">  - name: string  # Unique policy identifier</div>
<div class="line">    type: enum  # test_requirement | change_constraint | forbidden_range | review_requirement</div>
<div class="line">    enabled: boolean  # Policy-specific enable/disable</div>
<div class="line">    severity: enum  # critical | warning | info</div>
<div class="line">    </div>
<div class="line">    # Type-specific fields:</div>
<div class="line">    rules: array  # For test_requirement, change_constraint</div>
<div class="line">    ranges: array  # For forbidden_range</div>
<div class="line">    conditions: array  # For review_requirement</div>
<div class="line">    </div>
<div class="line">    message: string  # User-facing error message</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1138"></a>
Implementation Plan</h1>
<h2><a class="anchor" id="autotoc_md1139"></a>
Phase 1: Core Infrastructure (2 hours)</h2>
<h3><a class="anchor" id="autotoc_md1140"></a>
1.1 Create PolicyEvaluator Service</h3>
<p><b>File</b>: <code><a class="el" href="../../db/dd6/policy__evaluator_8h.html">src/cli/service/policy_evaluator.h</a></code></p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef YAZE_CLI_SERVICE_POLICY_EVALUATOR_H</span></div>
<div class="line"><span class="preprocessor">#define YAZE_CLI_SERVICE_POLICY_EVALUATOR_H</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;absl/status/status.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;absl/status/statusor.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;absl/strings/string_view.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../dc/d46/namespaceyaze.html">yaze</a> {</div>
<div class="line"><span class="keyword">namespace </span>cli {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Policy violation severity levels</span></div>
<div class="line"><span class="keyword">enum class</span> <a class="code hl_enumeration" href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16">PolicySeverity</a> {</div>
<div class="line">  <a class="code hl_enumvalue" href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16a176a473e63c17ccdac91640c67f149bf">kInfo</a>,      <span class="comment">// Informational, doesn&#39;t block acceptance</span></div>
<div class="line">  <a class="code hl_enumvalue" href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16aec0da41f4e48b52c362303eb27ed5dee">kWarning</a>,   <span class="comment">// Warning, can be overridden</span></div>
<div class="line">  <a class="code hl_enumvalue" href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16a5a20548c220f372fc701cae6de94040b">kCritical</a>   <span class="comment">// Critical, blocks acceptance</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Individual policy violation</span></div>
<div class="line"><span class="keyword">struct </span>PolicyViolation {</div>
<div class="line">  std::string <a class="code hl_variable" href="../../d2/d16/structyaze_1_1cli_1_1PolicyViolation.html#a659edc272cf9707d9ad89ca97dfd4327">policy_name</a>;</div>
<div class="line">  <a class="code hl_enumeration" href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16">PolicySeverity</a> <a class="code hl_variable" href="../../d2/d16/structyaze_1_1cli_1_1PolicyViolation.html#a9288c89834838fbddec62eaaa1afd36e">severity</a>;</div>
<div class="line">  std::string <a class="code hl_variable" href="../../d2/d16/structyaze_1_1cli_1_1PolicyViolation.html#a0f339b99ee588a15213fd4b584dc078f">message</a>;</div>
<div class="line">  std::string <a class="code hl_variable" href="../../d2/d16/structyaze_1_1cli_1_1PolicyViolation.html#a5d92f84733796b4cdde5336512b7c6dc">details</a>;  <span class="comment">// Additional context</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Result of policy evaluation</span></div>
<div class="line"><span class="keyword">struct </span>PolicyResult {</div>
<div class="line">  <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a9c2d7a9eb9b185641b730230ed88b63a">passed</a>;  <span class="comment">// True if all critical policies passed</span></div>
<div class="line">  std::vector&lt;PolicyViolation&gt; <a class="code hl_variable" href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#aefcc2d5a587652e65b19f3fd2b5022b1">violations</a>;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Categorized violations</span></div>
<div class="line">  std::vector&lt;PolicyViolation&gt; <a class="code hl_variable" href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#adec0cbad14764198af200df2c528aec6">critical_violations</a>;</div>
<div class="line">  std::vector&lt;PolicyViolation&gt; <a class="code hl_variable" href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a28c62dd1ebf773a12822b15cfa2bb388">warnings</a>;</div>
<div class="line">  std::vector&lt;PolicyViolation&gt; <a class="code hl_variable" href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a4777d0033a308e9002b9dcf91555c992">info</a>;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Helper methods</span></div>
<div class="line">  <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a3472ed033f9c448725c1f4db6c32ae3c">has_critical_violations</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !<a class="code hl_variable" href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#adec0cbad14764198af200df2c528aec6">critical_violations</a>.empty(); }</div>
<div class="line">  <span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a3ddbeba30768bcc9ac258900662e4db2">can_accept_with_override</a>()<span class="keyword"> const </span>{ </div>
<div class="line">    <span class="keywordflow">return</span> !<a class="code hl_function" href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a3472ed033f9c448725c1f4db6c32ae3c">has_critical_violations</a>() &amp;&amp; !<a class="code hl_variable" href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a28c62dd1ebf773a12822b15cfa2bb388">warnings</a>.empty(); </div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Singleton service for evaluating proposals against policies</span></div>
<div class="line"><span class="keyword">class </span>PolicyEvaluator {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ac23637d2d391ade541026e0a46c3f71b">PolicyEvaluator</a>&amp; <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a55e6ffff6b2ba3c3e98bbdbbcd6d7d1b">GetInstance</a>();</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Load policies from disk (.yaze/policies/agent.yaml)</span></div>
<div class="line">  absl::Status <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ae2b4ae50b514f9576fa888b072058141">LoadPolicies</a>(absl::string_view policy_dir = <span class="stringliteral">&quot;.yaze/policies&quot;</span>);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Evaluate a proposal against all loaded policies</span></div>
<div class="line">  absl::StatusOr&lt;PolicyResult&gt; <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a2ec3e8221c30ec6ef43f27fbc57fd78c">EvaluateProposal</a>(</div>
<div class="line">      absl::string_view proposal_id);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Reload policies from disk (for live editing)</span></div>
<div class="line">  absl::Status <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#af144c91f09003ff17f782ca33dfd3569">ReloadPolicies</a>();</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Check if policies are loaded and enabled</span></div>
<div class="line">  <span class="keywordtype">bool</span> <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a8a59cbf06fdb470d466c03b5cac61a86">IsEnabled</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ad09ddbd66f60755c597f9559cbb9dab0">enabled_</a>; }</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Get policy configuration path</span></div>
<div class="line">  std::string <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ae0d284faebf74075a091e30273f2e4a9">GetPolicyPath</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a703a1e9773772d09f8fdd735f748d02c">policy_path_</a>; }</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ac23637d2d391ade541026e0a46c3f71b">PolicyEvaluator</a>() = <span class="keywordflow">default</span>;</div>
<div class="line">  <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a05d10bb13b6986c4c42f74a9b1fea3be">~PolicyEvaluator</a>() = <span class="keywordflow">default</span>;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Non-copyable, non-movable</span></div>
<div class="line">  <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ac23637d2d391ade541026e0a46c3f71b">PolicyEvaluator</a>(<span class="keyword">const</span> <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ac23637d2d391ade541026e0a46c3f71b">PolicyEvaluator</a>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">  <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ac23637d2d391ade541026e0a46c3f71b">PolicyEvaluator</a>&amp; <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a3adfaeaa067b41ee5593491d8e3976eb">operator=</a>(<span class="keyword">const</span> <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ac23637d2d391ade541026e0a46c3f71b">PolicyEvaluator</a>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Parse YAML policy file</span></div>
<div class="line">  absl::Status <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a12d21e8c1174b214d00bd011be002578">ParsePolicyFile</a>(absl::string_view yaml_content);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Evaluate individual policy types</span></div>
<div class="line">  <span class="keywordtype">void</span> <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a64d50942006a8f144667df3477497d86">EvaluateTestRequirements</a>(</div>
<div class="line">      absl::string_view proposal_id, PolicyResult* result);</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ae4e49f036d32c46540fc4495b4b2dea9">EvaluateChangeConstraints</a>(</div>
<div class="line">      absl::string_view proposal_id, PolicyResult* result);</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ad4e2aed1137f31aa3ce38b6a843496a0">EvaluateForbiddenRanges</a>(</div>
<div class="line">      absl::string_view proposal_id, PolicyResult* result);</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a23e852f9a5c3dc388967b4c4beedcba1">EvaluateReviewRequirements</a>(</div>
<div class="line">      absl::string_view proposal_id, PolicyResult* result);</div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ad09ddbd66f60755c597f9559cbb9dab0">enabled_</a> = <span class="keyword">false</span>;</div>
<div class="line">  std::string <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a703a1e9773772d09f8fdd735f748d02c">policy_path_</a>;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Parsed policy structures (implementation detail)</span></div>
<div class="line">  <span class="keyword">struct </span>PolicyConfig;</div>
<div class="line">  std::unique_ptr&lt;PolicyConfig&gt; <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a4964db288c174701ec449e0dd2c6622e">config_</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}  <span class="comment">// namespace cli</span></div>
<div class="line">}  <span class="comment">// namespace yaze</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif  </span><span class="comment">// YAZE_CLI_SERVICE_POLICY_EVALUATOR_H</span></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_a05d10bb13b6986c4c42f74a9b1fea3be"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a05d10bb13b6986c4c42f74a9b1fea3be">yaze::cli::PolicyEvaluator::~PolicyEvaluator</a></div><div class="ttdeci">~PolicyEvaluator()=default</div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_a12d21e8c1174b214d00bd011be002578"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a12d21e8c1174b214d00bd011be002578">yaze::cli::PolicyEvaluator::ParsePolicyFile</a></div><div class="ttdeci">absl::Status ParsePolicyFile(absl::string_view yaml_content)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00119">policy_evaluator.cc:119</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_a23e852f9a5c3dc388967b4c4beedcba1"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a23e852f9a5c3dc388967b4c4beedcba1">yaze::cli::PolicyEvaluator::EvaluateReviewRequirements</a></div><div class="ttdeci">void EvaluateReviewRequirements(absl::string_view proposal_id, PolicyResult *result)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00299">policy_evaluator.cc:299</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_a2ec3e8221c30ec6ef43f27fbc57fd78c"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a2ec3e8221c30ec6ef43f27fbc57fd78c">yaze::cli::PolicyEvaluator::EvaluateProposal</a></div><div class="ttdeci">absl::StatusOr&lt; PolicyResult &gt; EvaluateProposal(absl::string_view proposal_id)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00205">policy_evaluator.cc:205</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_a3adfaeaa067b41ee5593491d8e3976eb"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a3adfaeaa067b41ee5593491d8e3976eb">yaze::cli::PolicyEvaluator::operator=</a></div><div class="ttdeci">PolicyEvaluator &amp; operator=(const PolicyEvaluator &amp;)=delete</div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_a4964db288c174701ec449e0dd2c6622e"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a4964db288c174701ec449e0dd2c6622e">yaze::cli::PolicyEvaluator::config_</a></div><div class="ttdeci">std::unique_ptr&lt; PolicyConfig &gt; config_</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00103">policy_evaluator.h:103</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_a55e6ffff6b2ba3c3e98bbdbbcd6d7d1b"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a55e6ffff6b2ba3c3e98bbdbbcd6d7d1b">yaze::cli::PolicyEvaluator::GetInstance</a></div><div class="ttdeci">static PolicyEvaluator &amp; GetInstance()</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00069">policy_evaluator.cc:69</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_a64d50942006a8f144667df3477497d86"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a64d50942006a8f144667df3477497d86">yaze::cli::PolicyEvaluator::EvaluateTestRequirements</a></div><div class="ttdeci">void EvaluateTestRequirements(absl::string_view proposal_id, PolicyResult *result)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00230">policy_evaluator.cc:230</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_a703a1e9773772d09f8fdd735f748d02c"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a703a1e9773772d09f8fdd735f748d02c">yaze::cli::PolicyEvaluator::policy_path_</a></div><div class="ttdeci">std::string policy_path_</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00098">policy_evaluator.h:98</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_a8a59cbf06fdb470d466c03b5cac61a86"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a8a59cbf06fdb470d466c03b5cac61a86">yaze::cli::PolicyEvaluator::IsEnabled</a></div><div class="ttdeci">bool IsEnabled() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00065">policy_evaluator.h:65</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_ac23637d2d391ade541026e0a46c3f71b"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ac23637d2d391ade541026e0a46c3f71b">yaze::cli::PolicyEvaluator::PolicyEvaluator</a></div><div class="ttdeci">PolicyEvaluator()=default</div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_ad09ddbd66f60755c597f9559cbb9dab0"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ad09ddbd66f60755c597f9559cbb9dab0">yaze::cli::PolicyEvaluator::enabled_</a></div><div class="ttdeci">bool enabled_</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00097">policy_evaluator.h:97</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_ad4e2aed1137f31aa3ce38b6a843496a0"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ad4e2aed1137f31aa3ce38b6a843496a0">yaze::cli::PolicyEvaluator::EvaluateForbiddenRanges</a></div><div class="ttdeci">void EvaluateForbiddenRanges(absl::string_view proposal_id, PolicyResult *result)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00287">policy_evaluator.cc:287</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_ae0d284faebf74075a091e30273f2e4a9"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ae0d284faebf74075a091e30273f2e4a9">yaze::cli::PolicyEvaluator::GetPolicyPath</a></div><div class="ttdeci">std::string GetPolicyPath() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00068">policy_evaluator.h:68</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_ae2b4ae50b514f9576fa888b072058141"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ae2b4ae50b514f9576fa888b072058141">yaze::cli::PolicyEvaluator::LoadPolicies</a></div><div class="ttdeci">absl::Status LoadPolicies(absl::string_view policy_dir=&quot;.yaze/policies&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00074">policy_evaluator.cc:74</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_ae4e49f036d32c46540fc4495b4b2dea9"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ae4e49f036d32c46540fc4495b4b2dea9">yaze::cli::PolicyEvaluator::EvaluateChangeConstraints</a></div><div class="ttdeci">void EvaluateChangeConstraints(absl::string_view proposal_id, PolicyResult *result)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00243">policy_evaluator.cc:243</a></div></div>
<div class="ttc" id="aclassyaze_1_1cli_1_1PolicyEvaluator_html_af144c91f09003ff17f782ca33dfd3569"><div class="ttname"><a href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#af144c91f09003ff17f782ca33dfd3569">yaze::cli::PolicyEvaluator::ReloadPolicies</a></div><div class="ttdeci">absl::Status ReloadPolicies()</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00094">policy_evaluator.cc:94</a></div></div>
<div class="ttc" id="anamespaceyaze_1_1cli_html_a0c9d838871edcd8b94461f8013be2b16"><div class="ttname"><a href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16">yaze::cli::PolicySeverity</a></div><div class="ttdeci">PolicySeverity</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00016">policy_evaluator.h:16</a></div></div>
<div class="ttc" id="anamespaceyaze_1_1cli_html_a0c9d838871edcd8b94461f8013be2b16a176a473e63c17ccdac91640c67f149bf"><div class="ttname"><a href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16a176a473e63c17ccdac91640c67f149bf">yaze::cli::PolicySeverity::kInfo</a></div><div class="ttdeci">@ kInfo</div></div>
<div class="ttc" id="anamespaceyaze_1_1cli_html_a0c9d838871edcd8b94461f8013be2b16a5a20548c220f372fc701cae6de94040b"><div class="ttname"><a href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16a5a20548c220f372fc701cae6de94040b">yaze::cli::PolicySeverity::kCritical</a></div><div class="ttdeci">@ kCritical</div></div>
<div class="ttc" id="anamespaceyaze_1_1cli_html_a0c9d838871edcd8b94461f8013be2b16aec0da41f4e48b52c362303eb27ed5dee"><div class="ttname"><a href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16aec0da41f4e48b52c362303eb27ed5dee">yaze::cli::PolicySeverity::kWarning</a></div><div class="ttdeci">@ kWarning</div></div>
<div class="ttc" id="anamespaceyaze_html"><div class="ttname"><a href="../../dc/d46/namespaceyaze.html">yaze</a></div><div class="ttdoc">Main namespace for the application.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d17/asar__wrapper_8cc_source.html#l00014">asar_wrapper.cc:14</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyResult_html_a28c62dd1ebf773a12822b15cfa2bb388"><div class="ttname"><a href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a28c62dd1ebf773a12822b15cfa2bb388">yaze::cli::PolicyResult::warnings</a></div><div class="ttdeci">std::vector&lt; PolicyViolation &gt; warnings</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00037">policy_evaluator.h:37</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyResult_html_a3472ed033f9c448725c1f4db6c32ae3c"><div class="ttname"><a href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a3472ed033f9c448725c1f4db6c32ae3c">yaze::cli::PolicyResult::has_critical_violations</a></div><div class="ttdeci">bool has_critical_violations() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00041">policy_evaluator.h:41</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyResult_html_a3ddbeba30768bcc9ac258900662e4db2"><div class="ttname"><a href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a3ddbeba30768bcc9ac258900662e4db2">yaze::cli::PolicyResult::can_accept_with_override</a></div><div class="ttdeci">bool can_accept_with_override() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00042">policy_evaluator.h:42</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyResult_html_a4777d0033a308e9002b9dcf91555c992"><div class="ttname"><a href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a4777d0033a308e9002b9dcf91555c992">yaze::cli::PolicyResult::info</a></div><div class="ttdeci">std::vector&lt; PolicyViolation &gt; info</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00038">policy_evaluator.h:38</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyResult_html_a9c2d7a9eb9b185641b730230ed88b63a"><div class="ttname"><a href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#a9c2d7a9eb9b185641b730230ed88b63a">yaze::cli::PolicyResult::passed</a></div><div class="ttdeci">bool passed</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00032">policy_evaluator.h:32</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyResult_html_adec0cbad14764198af200df2c528aec6"><div class="ttname"><a href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#adec0cbad14764198af200df2c528aec6">yaze::cli::PolicyResult::critical_violations</a></div><div class="ttdeci">std::vector&lt; PolicyViolation &gt; critical_violations</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00036">policy_evaluator.h:36</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyResult_html_aefcc2d5a587652e65b19f3fd2b5022b1"><div class="ttname"><a href="../../da/d57/structyaze_1_1cli_1_1PolicyResult.html#aefcc2d5a587652e65b19f3fd2b5022b1">yaze::cli::PolicyResult::violations</a></div><div class="ttdeci">std::vector&lt; PolicyViolation &gt; violations</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00033">policy_evaluator.h:33</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyViolation_html_a0f339b99ee588a15213fd4b584dc078f"><div class="ttname"><a href="../../d2/d16/structyaze_1_1cli_1_1PolicyViolation.html#a0f339b99ee588a15213fd4b584dc078f">yaze::cli::PolicyViolation::message</a></div><div class="ttdeci">std::string message</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00026">policy_evaluator.h:26</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyViolation_html_a5d92f84733796b4cdde5336512b7c6dc"><div class="ttname"><a href="../../d2/d16/structyaze_1_1cli_1_1PolicyViolation.html#a5d92f84733796b4cdde5336512b7c6dc">yaze::cli::PolicyViolation::details</a></div><div class="ttdeci">std::string details</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00027">policy_evaluator.h:27</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyViolation_html_a659edc272cf9707d9ad89ca97dfd4327"><div class="ttname"><a href="../../d2/d16/structyaze_1_1cli_1_1PolicyViolation.html#a659edc272cf9707d9ad89ca97dfd4327">yaze::cli::PolicyViolation::policy_name</a></div><div class="ttdeci">std::string policy_name</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00024">policy_evaluator.h:24</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyViolation_html_a9288c89834838fbddec62eaaa1afd36e"><div class="ttname"><a href="../../d2/d16/structyaze_1_1cli_1_1PolicyViolation.html#a9288c89834838fbddec62eaaa1afd36e">yaze::cli::PolicyViolation::severity</a></div><div class="ttdeci">PolicySeverity severity</div><div class="ttdef"><b>Definition</b> <a href="../../db/dd6/policy__evaluator_8h_source.html#l00025">policy_evaluator.h:25</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1141"></a>
1.2 Create Policy Configuration Structures</h3>
<p><b>File</b>: <code><a class="el" href="../../d1/d57/policy__evaluator_8cc.html">src/cli/service/policy_evaluator.cc</a></code> (partial)</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/dd6/policy__evaluator_8h.html">src/cli/service/policy_evaluator.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;absl/strings/str_format.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d4/d3d/proposal__registry_8h.html">src/cli/service/proposal_registry.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// If YAML parsing is available</span></div>
<div class="line"><span class="preprocessor">#ifdef YAZE_WITH_YAML</span></div>
<div class="line"><span class="preprocessor">#include &lt;yaml-cpp/yaml.h&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../dc/d46/namespaceyaze.html">yaze</a> {</div>
<div class="line"><span class="keyword">namespace </span>cli {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Internal policy configuration structures</span></div>
<div class="line"><span class="keyword">struct </span>PolicyEvaluator::PolicyConfig {</div>
<div class="line">  std::string <a class="code hl_variable" href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#a591dd5b9842f330e0a70f41297ca21b9">version</a>;</div>
<div class="line">  <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#a796dd0e5126ee6c354ac46132a3fe239">enabled</a>;</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">struct </span>TestRequirement {</div>
<div class="line">    std::string <a class="code hl_variable" href="../../d1/db8/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement.html#a588f1338cd89fe595f55e4d40a8fabac">name</a>;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d1/db8/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement.html#a0a5cbd4bf66c8c330427497763a9cb6f">enabled</a>;</div>
<div class="line">    <a class="code hl_enumeration" href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16">PolicySeverity</a> <a class="code hl_variable" href="../../d1/db8/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement.html#a7b66e17af8112fe54e30c38f78c4d7ee">severity</a>;</div>
<div class="line">    std::vector&lt;std::pair&lt;std::string, double&gt;&gt; <a class="code hl_variable" href="../../d1/db8/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement.html#a55ce7a3e06cf07fdacabc0e19474dec7">test_suites</a>;  <span class="comment">// suite name → min pass rate</span></div>
<div class="line">    std::string <a class="code hl_variable" href="../../d1/db8/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement.html#a9b70961028ead6c5661a75d64506ac1b">message</a>;</div>
<div class="line">  };</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">struct </span>ChangeConstraint {</div>
<div class="line">    std::string <a class="code hl_variable" href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a075e8f96a3f02edf131ad38d768dbe7f">name</a>;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a59a2f5643c5522815367b2911ad0a4ad">enabled</a>;</div>
<div class="line">    <a class="code hl_enumeration" href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16">PolicySeverity</a> <a class="code hl_variable" href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#ada4487916e0d231b74630561dc289d45">severity</a>;</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a22e2b0d9884b0bec7fade88a6fef09cb">max_bytes_changed</a> = -1;</div>
<div class="line">    std::vector&lt;int&gt; <a class="code hl_variable" href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#aeb5af110eaa0a4e4a57178c2e38cb269">allowed_banks</a>;</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a71cfbc6d96897ca35677f67b7b6da8be">max_commands_executed</a> = -1;</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#ab5ea165ad74d69b611c63e1cff2c1631">max_palettes_changed</a> = -1;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a3f1d0519fc8a549ed46bfdc0308f71fe">preserve_transparency</a> = <span class="keyword">false</span>;</div>
<div class="line">    std::string <a class="code hl_variable" href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a3dba5c009b44e1c9c70a5e7f2116012c">message</a>;</div>
<div class="line">  };</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">struct </span>ForbiddenRange {</div>
<div class="line">    std::string <a class="code hl_variable" href="../../d9/dbf/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange.html#a5fe501789d80d0bb0795cefcba7edc93">name</a>;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d9/dbf/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange.html#ae1b562b34ef3bf14ede67bae6faa3836">enabled</a>;</div>
<div class="line">    <a class="code hl_enumeration" href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16">PolicySeverity</a> <a class="code hl_variable" href="../../d9/dbf/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange.html#a104f03ee8c8e47ca30d0af5f0e5a65e8">severity</a>;</div>
<div class="line">    std::vector&lt;std::tuple&lt;int, int, std::string&gt;&gt; <a class="code hl_variable" href="../../d9/dbf/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange.html#a2df907efa6fc7619a7cba096c67a7691">ranges</a>;  <span class="comment">// start, end, reason</span></div>
<div class="line">    std::string <a class="code hl_variable" href="../../d9/dbf/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange.html#af639d52111164b89ab857650bb7d85ee">message</a>;</div>
<div class="line">  };</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">struct </span>ReviewRequirement {</div>
<div class="line">    std::string <a class="code hl_variable" href="../../de/d07/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement.html#ab45367e9b2a221c969a9bcf34a92c47b">name</a>;</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../de/d07/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement.html#a1194ffb7276e2e3d2256c7b77ef67b7c">enabled</a>;</div>
<div class="line">    <a class="code hl_enumeration" href="../../dd/d63/namespaceyaze_1_1cli.html#a0c9d838871edcd8b94461f8013be2b16">PolicySeverity</a> <a class="code hl_variable" href="../../de/d07/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement.html#a03f0760c671f680cdd943418a1979f65">severity</a>;</div>
<div class="line">    std::vector&lt;std::string&gt; <a class="code hl_variable" href="../../de/d07/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement.html#aec0fc3c99b6dac729254c0583a7c1c43">conditions</a>;</div>
<div class="line">    std::string <a class="code hl_variable" href="../../de/d07/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement.html#a10e6595914e0f92c8ad2ee51c2a09622">message</a>;</div>
<div class="line">  };</div>
<div class="line">  </div>
<div class="line">  std::vector&lt;TestRequirement&gt; <a class="code hl_variable" href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#a29fa979f90f5958775b2cc751393359f">test_requirements</a>;</div>
<div class="line">  std::vector&lt;ChangeConstraint&gt; <a class="code hl_variable" href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#abc9bf1eed7d9a5d50ae2c5f693ffc7da">change_constraints</a>;</div>
<div class="line">  std::vector&lt;ForbiddenRange&gt; <a class="code hl_variable" href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#a77573916089e96bc2f9e7f243e8e9070">forbidden_ranges</a>;</div>
<div class="line">  std::vector&lt;ReviewRequirement&gt; <a class="code hl_variable" href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#a9be60a5146243ba2bb2bfce58d6edf9f">review_requirements</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Singleton instance</span></div>
<div class="line">PolicyEvaluator&amp; <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a55e6ffff6b2ba3c3e98bbdbbcd6d7d1b">PolicyEvaluator::GetInstance</a>() {</div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ac23637d2d391ade541026e0a46c3f71b">PolicyEvaluator</a> instance;</div>
<div class="line">  <span class="keywordflow">return</span> instance;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">absl::Status <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ae2b4ae50b514f9576fa888b072058141">PolicyEvaluator::LoadPolicies</a>(absl::string_view policy_dir) {</div>
<div class="line">  <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a703a1e9773772d09f8fdd735f748d02c">policy_path_</a> = absl::StrFormat(<span class="stringliteral">&quot;%s/agent.yaml&quot;</span>, policy_dir);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Check if file exists</span></div>
<div class="line">  std::ifstream file(<a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a703a1e9773772d09f8fdd735f748d02c">policy_path_</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (!file.good()) {</div>
<div class="line">    <span class="comment">// No policy file - policies disabled</span></div>
<div class="line">    <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ad09ddbd66f60755c597f9559cbb9dab0">enabled_</a> = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordflow">return</span> absl::OkStatus();</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Read file content</span></div>
<div class="line">  std::stringstream buffer;</div>
<div class="line">  buffer &lt;&lt; file.rdbuf();</div>
<div class="line">  std::string yaml_content = buffer.str();</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a12d21e8c1174b214d00bd011be002578">ParsePolicyFile</a>(yaml_content);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">absl::Status <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a12d21e8c1174b214d00bd011be002578">PolicyEvaluator::ParsePolicyFile</a>(absl::string_view yaml_content) {</div>
<div class="line"><span class="preprocessor">#ifndef YAZE_WITH_YAML</span></div>
<div class="line">  <span class="keywordflow">return</span> absl::UnimplementedError(</div>
<div class="line">      <span class="stringliteral">&quot;YAML support not compiled. Build with YAZE_WITH_YAML=ON&quot;</span>);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    YAML::Node root = YAML::Load(std::string(yaml_content));</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a4964db288c174701ec449e0dd2c6622e">config_</a> = std::make_unique&lt;PolicyConfig&gt;();</div>
<div class="line">    <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a4964db288c174701ec449e0dd2c6622e">config_</a>-&gt;version = root[<span class="stringliteral">&quot;version&quot;</span>].as&lt;std::string&gt;(<span class="stringliteral">&quot;1.0&quot;</span>);</div>
<div class="line">    <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a4964db288c174701ec449e0dd2c6622e">config_</a>-&gt;enabled = root[<span class="stringliteral">&quot;enabled&quot;</span>].as&lt;<span class="keywordtype">bool</span>&gt;(<span class="keyword">true</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a4964db288c174701ec449e0dd2c6622e">config_</a>-&gt;enabled) {</div>
<div class="line">      <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ad09ddbd66f60755c597f9559cbb9dab0">enabled_</a> = <span class="keyword">false</span>;</div>
<div class="line">      <span class="keywordflow">return</span> absl::OkStatus();</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Parse policies array</span></div>
<div class="line">    <span class="keywordflow">if</span> (root[<span class="stringliteral">&quot;policies&quot;</span>]) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; policy_node : root[<span class="stringliteral">&quot;policies&quot;</span>]) {</div>
<div class="line">        std::string type = policy_node[<span class="stringliteral">&quot;type&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;test_requirement&quot;</span>) {</div>
<div class="line">          <span class="comment">// Parse test requirement policy</span></div>
<div class="line">          <span class="comment">// ... (implementation continues)</span></div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;change_constraint&quot;</span>) {</div>
<div class="line">          <span class="comment">// Parse change constraint policy</span></div>
<div class="line">          <span class="comment">// ... (implementation continues)</span></div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;forbidden_range&quot;</span>) {</div>
<div class="line">          <span class="comment">// Parse forbidden range policy</span></div>
<div class="line">          <span class="comment">// ... (implementation continues)</span></div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;review_requirement&quot;</span>) {</div>
<div class="line">          <span class="comment">// Parse review requirement policy</span></div>
<div class="line">          <span class="comment">// ... (implementation continues)</span></div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_variable" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#ad09ddbd66f60755c597f9559cbb9dab0">enabled_</a> = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">return</span> absl::OkStatus();</div>
<div class="line">    </div>
<div class="line">  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> YAML::Exception&amp; e) {</div>
<div class="line">    <span class="keywordflow">return</span> absl::InvalidArgumentError(</div>
<div class="line">        absl::StrFormat(<span class="stringliteral">&quot;Failed to parse policy YAML: %s&quot;</span>, e.what()));</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ... (implementation continues with evaluation methods)</span></div>
<div class="line"> </div>
<div class="line">}  <span class="comment">// namespace cli</span></div>
<div class="line">}  <span class="comment">// namespace yaze</span></div>
<div class="ttc" id="apolicy__evaluator_8h_html"><div class="ttname"><a href="../../db/dd6/policy__evaluator_8h.html">policy_evaluator.h</a></div></div>
<div class="ttc" id="aproposal__registry_8h_html"><div class="ttname"><a href="../../d4/d3d/proposal__registry_8h.html">proposal_registry.h</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint_html_a075e8f96a3f02edf131ad38d768dbe7f"><div class="ttname"><a href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a075e8f96a3f02edf131ad38d768dbe7f">yaze::cli::PolicyEvaluator::PolicyConfig::ChangeConstraint::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00029">policy_evaluator.cc:29</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint_html_a22e2b0d9884b0bec7fade88a6fef09cb"><div class="ttname"><a href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a22e2b0d9884b0bec7fade88a6fef09cb">yaze::cli::PolicyEvaluator::PolicyConfig::ChangeConstraint::max_bytes_changed</a></div><div class="ttdeci">int max_bytes_changed</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00032">policy_evaluator.cc:32</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint_html_a3dba5c009b44e1c9c70a5e7f2116012c"><div class="ttname"><a href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a3dba5c009b44e1c9c70a5e7f2116012c">yaze::cli::PolicyEvaluator::PolicyConfig::ChangeConstraint::message</a></div><div class="ttdeci">std::string message</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00037">policy_evaluator.cc:37</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint_html_a3f1d0519fc8a549ed46bfdc0308f71fe"><div class="ttname"><a href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a3f1d0519fc8a549ed46bfdc0308f71fe">yaze::cli::PolicyEvaluator::PolicyConfig::ChangeConstraint::preserve_transparency</a></div><div class="ttdeci">bool preserve_transparency</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00036">policy_evaluator.cc:36</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint_html_a59a2f5643c5522815367b2911ad0a4ad"><div class="ttname"><a href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a59a2f5643c5522815367b2911ad0a4ad">yaze::cli::PolicyEvaluator::PolicyConfig::ChangeConstraint::enabled</a></div><div class="ttdeci">bool enabled</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00030">policy_evaluator.cc:30</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint_html_a71cfbc6d96897ca35677f67b7b6da8be"><div class="ttname"><a href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#a71cfbc6d96897ca35677f67b7b6da8be">yaze::cli::PolicyEvaluator::PolicyConfig::ChangeConstraint::max_commands_executed</a></div><div class="ttdeci">int max_commands_executed</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00034">policy_evaluator.cc:34</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint_html_ab5ea165ad74d69b611c63e1cff2c1631"><div class="ttname"><a href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#ab5ea165ad74d69b611c63e1cff2c1631">yaze::cli::PolicyEvaluator::PolicyConfig::ChangeConstraint::max_palettes_changed</a></div><div class="ttdeci">int max_palettes_changed</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00035">policy_evaluator.cc:35</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint_html_ada4487916e0d231b74630561dc289d45"><div class="ttname"><a href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#ada4487916e0d231b74630561dc289d45">yaze::cli::PolicyEvaluator::PolicyConfig::ChangeConstraint::severity</a></div><div class="ttdeci">PolicySeverity severity</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00031">policy_evaluator.cc:31</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint_html_aeb5af110eaa0a4e4a57178c2e38cb269"><div class="ttname"><a href="../../de/ddb/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ChangeConstraint.html#aeb5af110eaa0a4e4a57178c2e38cb269">yaze::cli::PolicyEvaluator::PolicyConfig::ChangeConstraint::allowed_banks</a></div><div class="ttdeci">std::vector&lt; int &gt; allowed_banks</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00033">policy_evaluator.cc:33</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange_html_a104f03ee8c8e47ca30d0af5f0e5a65e8"><div class="ttname"><a href="../../d9/dbf/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange.html#a104f03ee8c8e47ca30d0af5f0e5a65e8">yaze::cli::PolicyEvaluator::PolicyConfig::ForbiddenRange::severity</a></div><div class="ttdeci">PolicySeverity severity</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00043">policy_evaluator.cc:43</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange_html_a2df907efa6fc7619a7cba096c67a7691"><div class="ttname"><a href="../../d9/dbf/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange.html#a2df907efa6fc7619a7cba096c67a7691">yaze::cli::PolicyEvaluator::PolicyConfig::ForbiddenRange::ranges</a></div><div class="ttdeci">std::vector&lt; std::tuple&lt; int, int, std::string &gt; &gt; ranges</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00045">policy_evaluator.cc:45</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange_html_a5fe501789d80d0bb0795cefcba7edc93"><div class="ttname"><a href="../../d9/dbf/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange.html#a5fe501789d80d0bb0795cefcba7edc93">yaze::cli::PolicyEvaluator::PolicyConfig::ForbiddenRange::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00041">policy_evaluator.cc:41</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange_html_ae1b562b34ef3bf14ede67bae6faa3836"><div class="ttname"><a href="../../d9/dbf/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange.html#ae1b562b34ef3bf14ede67bae6faa3836">yaze::cli::PolicyEvaluator::PolicyConfig::ForbiddenRange::enabled</a></div><div class="ttdeci">bool enabled</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00042">policy_evaluator.cc:42</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange_html_af639d52111164b89ab857650bb7d85ee"><div class="ttname"><a href="../../d9/dbf/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ForbiddenRange.html#af639d52111164b89ab857650bb7d85ee">yaze::cli::PolicyEvaluator::PolicyConfig::ForbiddenRange::message</a></div><div class="ttdeci">std::string message</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00046">policy_evaluator.cc:46</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement_html_a03f0760c671f680cdd943418a1979f65"><div class="ttname"><a href="../../de/d07/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement.html#a03f0760c671f680cdd943418a1979f65">yaze::cli::PolicyEvaluator::PolicyConfig::ReviewRequirement::severity</a></div><div class="ttdeci">PolicySeverity severity</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00052">policy_evaluator.cc:52</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement_html_a10e6595914e0f92c8ad2ee51c2a09622"><div class="ttname"><a href="../../de/d07/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement.html#a10e6595914e0f92c8ad2ee51c2a09622">yaze::cli::PolicyEvaluator::PolicyConfig::ReviewRequirement::message</a></div><div class="ttdeci">std::string message</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00059">policy_evaluator.cc:59</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement_html_a1194ffb7276e2e3d2256c7b77ef67b7c"><div class="ttname"><a href="../../de/d07/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement.html#a1194ffb7276e2e3d2256c7b77ef67b7c">yaze::cli::PolicyEvaluator::PolicyConfig::ReviewRequirement::enabled</a></div><div class="ttdeci">bool enabled</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00051">policy_evaluator.cc:51</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement_html_ab45367e9b2a221c969a9bcf34a92c47b"><div class="ttname"><a href="../../de/d07/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement.html#ab45367e9b2a221c969a9bcf34a92c47b">yaze::cli::PolicyEvaluator::PolicyConfig::ReviewRequirement::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00050">policy_evaluator.cc:50</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement_html_aec0fc3c99b6dac729254c0583a7c1c43"><div class="ttname"><a href="../../de/d07/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1ReviewRequirement.html#aec0fc3c99b6dac729254c0583a7c1c43">yaze::cli::PolicyEvaluator::PolicyConfig::ReviewRequirement::conditions</a></div><div class="ttdeci">std::vector&lt; Condition &gt; conditions</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00058">policy_evaluator.cc:58</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement_html_a0a5cbd4bf66c8c330427497763a9cb6f"><div class="ttname"><a href="../../d1/db8/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement.html#a0a5cbd4bf66c8c330427497763a9cb6f">yaze::cli::PolicyEvaluator::PolicyConfig::TestRequirement::enabled</a></div><div class="ttdeci">bool enabled</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00021">policy_evaluator.cc:21</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement_html_a55ce7a3e06cf07fdacabc0e19474dec7"><div class="ttname"><a href="../../d1/db8/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement.html#a55ce7a3e06cf07fdacabc0e19474dec7">yaze::cli::PolicyEvaluator::PolicyConfig::TestRequirement::test_suites</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; std::string, double &gt; &gt; test_suites</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00024">policy_evaluator.cc:24</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement_html_a588f1338cd89fe595f55e4d40a8fabac"><div class="ttname"><a href="../../d1/db8/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement.html#a588f1338cd89fe595f55e4d40a8fabac">yaze::cli::PolicyEvaluator::PolicyConfig::TestRequirement::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00020">policy_evaluator.cc:20</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement_html_a7b66e17af8112fe54e30c38f78c4d7ee"><div class="ttname"><a href="../../d1/db8/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement.html#a7b66e17af8112fe54e30c38f78c4d7ee">yaze::cli::PolicyEvaluator::PolicyConfig::TestRequirement::severity</a></div><div class="ttdeci">PolicySeverity severity</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00022">policy_evaluator.cc:22</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement_html_a9b70961028ead6c5661a75d64506ac1b"><div class="ttname"><a href="../../d1/db8/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_1_1TestRequirement.html#a9b70961028ead6c5661a75d64506ac1b">yaze::cli::PolicyEvaluator::PolicyConfig::TestRequirement::message</a></div><div class="ttdeci">std::string message</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00025">policy_evaluator.cc:25</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_html_a29fa979f90f5958775b2cc751393359f"><div class="ttname"><a href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#a29fa979f90f5958775b2cc751393359f">yaze::cli::PolicyEvaluator::PolicyConfig::test_requirements</a></div><div class="ttdeci">std::vector&lt; TestRequirement &gt; test_requirements</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00062">policy_evaluator.cc:62</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_html_a591dd5b9842f330e0a70f41297ca21b9"><div class="ttname"><a href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#a591dd5b9842f330e0a70f41297ca21b9">yaze::cli::PolicyEvaluator::PolicyConfig::version</a></div><div class="ttdeci">std::string version</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00016">policy_evaluator.cc:16</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_html_a77573916089e96bc2f9e7f243e8e9070"><div class="ttname"><a href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#a77573916089e96bc2f9e7f243e8e9070">yaze::cli::PolicyEvaluator::PolicyConfig::forbidden_ranges</a></div><div class="ttdeci">std::vector&lt; ForbiddenRange &gt; forbidden_ranges</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00064">policy_evaluator.cc:64</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_html_a796dd0e5126ee6c354ac46132a3fe239"><div class="ttname"><a href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#a796dd0e5126ee6c354ac46132a3fe239">yaze::cli::PolicyEvaluator::PolicyConfig::enabled</a></div><div class="ttdeci">bool enabled</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00017">policy_evaluator.cc:17</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_html_a9be60a5146243ba2bb2bfce58d6edf9f"><div class="ttname"><a href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#a9be60a5146243ba2bb2bfce58d6edf9f">yaze::cli::PolicyEvaluator::PolicyConfig::review_requirements</a></div><div class="ttdeci">std::vector&lt; ReviewRequirement &gt; review_requirements</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00065">policy_evaluator.cc:65</a></div></div>
<div class="ttc" id="astructyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig_html_abc9bf1eed7d9a5d50ae2c5f693ffc7da"><div class="ttname"><a href="../../d7/de7/structyaze_1_1cli_1_1PolicyEvaluator_1_1PolicyConfig.html#abc9bf1eed7d9a5d50ae2c5f693ffc7da">yaze::cli::PolicyEvaluator::PolicyConfig::change_constraints</a></div><div class="ttdeci">std::vector&lt; ChangeConstraint &gt; change_constraints</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d57/policy__evaluator_8cc_source.html#l00063">policy_evaluator.cc:63</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1142"></a>
Phase 2: Policy Evaluation Logic (2-3 hours)</h2>
<p>Implement the core evaluation methods that check proposals against each policy type.</p>
<h2><a class="anchor" id="autotoc_md1143"></a>
Phase 3: GUI Integration (2 hours)</h2>
<h3><a class="anchor" id="autotoc_md1144"></a>
3.1 Update ProposalDrawer</h3>
<p><b>File</b>: <code><a class="el" href="../../d1/d96/proposal__drawer_8cc.html">src/app/editor/system/proposal_drawer.cc</a></code></p>
<p>Add policy status display and gating logic:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/dd6/policy__evaluator_8h.html">src/cli/service/policy_evaluator.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> ProposalDrawer::DrawProposalDetail(<span class="keyword">const</span> std::string&amp; proposal_id) {</div>
<div class="line">  <span class="comment">// ... existing detail view code ...</span></div>
<div class="line">  </div>
<div class="line">  <span class="comment">// === Policy Status Section ===</span></div>
<div class="line">  ImGui::Separator();</div>
<div class="line">  ImGui::TextUnformatted(<span class="stringliteral">&quot;Policy Status:&quot;</span>);</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">auto</span>&amp; policy_eval = cli::PolicyEvaluator::GetInstance();</div>
<div class="line">  <span class="keywordflow">if</span> (policy_eval.IsEnabled()) {</div>
<div class="line">    <span class="keyword">auto</span> policy_result = policy_eval.EvaluateProposal(proposal_id);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (policy_result.ok()) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; result = policy_result.value();</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">if</span> (result.passed) {</div>
<div class="line">        ImGui::TextColored(ImVec4(0, 1, 0, 1), <span class="stringliteral">&quot;✓ All policies passed&quot;</span>);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">// Show violations</span></div>
<div class="line">        <span class="keywordflow">if</span> (result.has_critical_violations()) {</div>
<div class="line">          ImGui::TextColored(ImVec4(1, 0, 0, 1), <span class="stringliteral">&quot;⛔ Critical violations:&quot;</span>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; violation : result.critical_violations) {</div>
<div class="line">            ImGui::BulletText(<span class="stringliteral">&quot;%s: %s&quot;</span>, </div>
<div class="line">                violation.policy_name.c_str(), </div>
<div class="line">                violation.message.c_str());</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (!result.warnings.empty()) {</div>
<div class="line">          ImGui::TextColored(ImVec4(1, 1, 0, 1), <span class="stringliteral">&quot;⚠️ Warnings:&quot;</span>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; violation : result.warnings) {</div>
<div class="line">            ImGui::BulletText(<span class="stringliteral">&quot;%s: %s&quot;</span>, </div>
<div class="line">                violation.policy_name.c_str(), </div>
<div class="line">                violation.message.c_str());</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      <span class="comment">// Gate Accept button</span></div>
<div class="line">      ImGui::Separator();</div>
<div class="line">      <span class="keywordtype">bool</span> can_accept = !result.has_critical_violations();</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">if</span> (!can_accept) {</div>
<div class="line">        ImGui::BeginDisabled();</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">if</span> (ImGui::Button(<span class="stringliteral">&quot;Accept Proposal&quot;</span>)) {</div>
<div class="line">        <span class="keywordflow">if</span> (result.can_accept_with_override() &amp;&amp; !override_confirmed_) {</div>
<div class="line">          <span class="comment">// Show override confirmation dialog</span></div>
<div class="line">          ImGui::OpenPopup(<span class="stringliteral">&quot;Override Policy&quot;</span>);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          AcceptProposal(proposal_id);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">if</span> (!can_accept) {</div>
<div class="line">        ImGui::EndDisabled();</div>
<div class="line">        ImGui::SameLine();</div>
<div class="line">        ImGui::TextColored(ImVec4(1, 0, 0, 1), </div>
<div class="line">            <span class="stringliteral">&quot;(Accept blocked by policy violations)&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      <span class="comment">// Override confirmation dialog</span></div>
<div class="line">      <span class="keywordflow">if</span> (ImGui::BeginPopupModal(<span class="stringliteral">&quot;Override Policy&quot;</span>, <span class="keyword">nullptr</span>, </div>
<div class="line">          ImGuiWindowFlags_AlwaysAutoResize)) {</div>
<div class="line">        ImGui::Text(<span class="stringliteral">&quot;This proposal has policy warnings.&quot;</span>);</div>
<div class="line">        ImGui::Text(<span class="stringliteral">&quot;Do you want to override and accept anyway?&quot;</span>);</div>
<div class="line">        ImGui::Text(<span class="stringliteral">&quot;This action will be logged.&quot;</span>);</div>
<div class="line">        ImGui::Separator();</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (ImGui::Button(<span class="stringliteral">&quot;Override and Accept&quot;</span>)) {</div>
<div class="line">          override_confirmed_ = <span class="keyword">true</span>;</div>
<div class="line">          AcceptProposal(proposal_id);</div>
<div class="line">          ImGui::CloseCurrentPopup();</div>
<div class="line">        }</div>
<div class="line">        ImGui::SameLine();</div>
<div class="line">        <span class="keywordflow">if</span> (ImGui::Button(<span class="stringliteral">&quot;Cancel&quot;</span>)) {</div>
<div class="line">          ImGui::CloseCurrentPopup();</div>
<div class="line">        }</div>
<div class="line">        ImGui::EndPopup();</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      ImGui::TextColored(ImVec4(1, 0, 0, 1), </div>
<div class="line">          <span class="stringliteral">&quot;Policy evaluation failed: %s&quot;</span>, </div>
<div class="line">          policy_result.status().message().data());</div>
<div class="line">    }</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    ImGui::TextColored(ImVec4(0.5, 0.5, 0.5, 1), </div>
<div class="line">        <span class="stringliteral">&quot;No policies configured&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1145"></a>
Phase 4: Testing &amp; Documentation (1-2 hours)</h2>
<h3><a class="anchor" id="autotoc_md1146"></a>
4.1 Example Policy File</h3>
<p>Create <code>.yaze/policies/agent.yaml.example</code>:</p>
<div class="fragment"><div class="line"># Example agent policy configuration</div>
<div class="line"># Copy to .yaze/policies/agent.yaml and customize</div>
<div class="line"> </div>
<div class="line">version: 1.0</div>
<div class="line">enabled: true</div>
<div class="line"> </div>
<div class="line">policies:</div>
<div class="line">  # Require test suites to pass</div>
<div class="line">  - name: require_tests</div>
<div class="line">    type: test_requirement</div>
<div class="line">    enabled: false  # Disabled by default (no tests yet)</div>
<div class="line">    severity: critical</div>
<div class="line">    rules:</div>
<div class="line">      - test_suite: &quot;smoke_test&quot;</div>
<div class="line">        min_pass_rate: 1.0</div>
<div class="line">    message: &quot;All smoke tests must pass&quot;</div>
<div class="line"> </div>
<div class="line">  # Limit change scope</div>
<div class="line">  - name: limit_changes</div>
<div class="line">    type: change_constraint</div>
<div class="line">    enabled: true</div>
<div class="line">    severity: warning</div>
<div class="line">    rules:</div>
<div class="line">      - max_bytes_changed: 5120  # 5KB</div>
<div class="line">      - max_commands_executed: 15</div>
<div class="line">    message: &quot;Keep changes small and focused&quot;</div>
<div class="line"> </div>
<div class="line">  # Protect ROM header</div>
<div class="line">  - name: protect_header</div>
<div class="line">    type: forbidden_range</div>
<div class="line">    enabled: true</div>
<div class="line">    severity: critical</div>
<div class="line">    ranges:</div>
<div class="line">      - start: 0xFFB0</div>
<div class="line">        end: 0xFFFF</div>
<div class="line">        reason: &quot;ROM header&quot;</div>
<div class="line">    message: &quot;Cannot modify ROM header&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1147"></a>
4.2 Unit Tests</h3>
<p>Create <code>test/cli/policy_evaluator_test.cc</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/dd6/policy__evaluator_8h.html">src/cli/service/policy_evaluator.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;gtest/gtest.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../dc/d46/namespaceyaze.html">yaze</a> {</div>
<div class="line"><span class="keyword">namespace </span>cli {</div>
<div class="line"><span class="keyword">namespace </span>{</div>
<div class="line"> </div>
<div class="line">TEST(PolicyEvaluatorTest, LoadPoliciesSuccess) {</div>
<div class="line">  <span class="keyword">auto</span>&amp; eval = <a class="code hl_function" href="../../d5/d67/classyaze_1_1cli_1_1PolicyEvaluator.html#a55e6ffff6b2ba3c3e98bbdbbcd6d7d1b">PolicyEvaluator::GetInstance</a>();</div>
<div class="line">  <span class="keyword">auto</span> status = eval.LoadPolicies(<span class="stringliteral">&quot;test/fixtures/policies&quot;</span>);</div>
<div class="line">  EXPECT_TRUE(status.ok());</div>
<div class="line">  EXPECT_TRUE(eval.IsEnabled());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">TEST(PolicyEvaluatorTest, EvaluateProposal_NoViolations) {</div>
<div class="line">  <span class="comment">// ... test implementation</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/d01/namespaceyaze_1_1cli_1_1anonymous__namespace_02resource__catalog__test_8cc_03.html#a8a4b8ed88b34f98740dd871905b3e979">TEST</a>(PolicyEvaluatorTest, EvaluateProposal_CriticalViolation) {</div>
<div class="line">  <span class="comment">// ... test implementation</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">}  <span class="comment">// namespace</span></div>
<div class="line">}  <span class="comment">// namespace cli</span></div>
<div class="line">}  <span class="comment">// namespace yaze</span></div>
<div class="ttc" id="anamespaceyaze_1_1cli_1_1anonymous__namespace_02resource__catalog__test_8cc_03_html_a8a4b8ed88b34f98740dd871905b3e979"><div class="ttname"><a href="../../d8/d01/namespaceyaze_1_1cli_1_1anonymous__namespace_02resource__catalog__test_8cc_03.html#a8a4b8ed88b34f98740dd871905b3e979">yaze::cli::anonymous_namespace{resource_catalog_test.cc}::TEST</a></div><div class="ttdeci">TEST(ResourceCatalogTest, SerializeResourceIncludesReturnsArray)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d72/resource__catalog__test_8cc_source.html#l00012">resource_catalog_test.cc:12</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1148"></a>
Deliverables</h1>
<ul>
<li>[x] Policy evaluator service interface</li>
<li>[ ] YAML policy parser implementation</li>
<li>[ ] Policy evaluation logic for all 4 types</li>
<li>[ ] ProposalDrawer GUI integration</li>
<li>[ ] Policy override workflow</li>
<li>[ ] Example policy configurations</li>
<li>[ ] Unit tests</li>
<li>[ ] Documentation and usage guide</li>
</ul>
<h1><a class="anchor" id="autotoc_md1149"></a>
Success Criteria</h1>
<ol type="1">
<li><b>Functional</b>:<ul>
<li>Policies load from YAML files</li>
<li>Proposals evaluated against all enabled policies</li>
<li>Accept button gated by critical violations</li>
<li>Override workflow for warnings</li>
</ul>
</li>
<li><b>User Experience</b>:<ul>
<li>Clear policy status display in ProposalDrawer</li>
<li>Helpful violation messages</li>
<li>Override confirmation dialog</li>
<li>Policy evaluation fast (&lt; 100ms)</li>
</ul>
</li>
<li><b>Quality</b>:<ul>
<li>Unit test coverage &gt; 80%</li>
<li>No crashes or memory leaks</li>
<li>Graceful handling of malformed YAML</li>
<li>Works with policies disabled</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md1150"></a>
Future Enhancements</h1>
<ul>
<li>Policy templates for common scenarios</li>
<li>Policy violation history/analytics</li>
<li>Auto-fix suggestions for violations</li>
<li>Integration with CI/CD for automated policy checks</li>
<li>Policy versioning and migration</li>
</ul>
<hr  />
<p><b>Status</b>: Ready for implementation <br  />
 <b>Next Step</b>: Create PolicyEvaluator skeleton and wire into build system <br  />
 <b>Estimated Completion</b>: October 3-4, 2025 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
