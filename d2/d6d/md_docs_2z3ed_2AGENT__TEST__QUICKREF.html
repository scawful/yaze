<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>yaze: z3ed Agent Test Command - Quick Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../yaze.ico"/></td>
  <td id="projectalign">
   <div id="projectname">yaze<span id="projectnumber">&#160;0.3.1</span>
   </div>
   <div id="projectbrief">Link to the Past ROM Editor</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d2/d6d/md_docs_2z3ed_2AGENT__TEST__QUICKREF.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">z3ed Agent Test Command - Quick Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1125"></a> <b>Last Updated</b>: October 2, 2025 <br  />
 <b>Feature</b>: IT-02 CLI Agent Test Command</p>
<hr  />
<h1><a class="anchor" id="autotoc_md1127"></a>
Command Syntax</h1>
<div class="fragment"><div class="line">z3ed agent test --prompt &quot;&lt;natural_language_prompt&gt;&quot; \</div>
<div class="line">  [--host &lt;hostname&gt;] \</div>
<div class="line">  [--port &lt;port&gt;] \</div>
<div class="line">  [--timeout &lt;seconds&gt;]</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1129"></a>
Supported Prompts</h1>
<h2><a class="anchor" id="autotoc_md1130"></a>
1. Open Editor</h2>
<p><b>Pattern</b>: "Open &lt;Editor&gt; editor" <br  />
 <b>Example</b>: <code>"Open Overworld editor"</code> <br  />
 <b>Actions</b>:</p><ul>
<li>Click button → Wait for window</li>
</ul>
<div class="fragment"><div class="line">z3ed agent test --prompt &quot;Open Overworld editor&quot;</div>
<div class="line">z3ed agent test --prompt &quot;Open Dungeon editor&quot;</div>
<div class="line">z3ed agent test --prompt &quot;Open Sprite editor&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1131"></a>
2. Open and Verify</h2>
<p><b>Pattern</b>: "Open &lt;Editor&gt; and verify it loads" <br  />
 <b>Example</b>: <code>"Open Dungeon editor and verify it loads"</code> <br  />
 <b>Actions</b>:</p><ul>
<li>Click button → Wait for window → Assert visible</li>
</ul>
<div class="fragment"><div class="line">z3ed agent test --prompt &quot;Open Overworld editor and verify it loads&quot;</div>
<div class="line">z3ed agent test --prompt &quot;Open Dungeon editor and verify it loads&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1132"></a>
3. Click Button</h2>
<p><b>Pattern</b>: "Click &lt;Button&gt;" <br  />
 <b>Example</b>: <code>"Click Open ROM button"</code> <br  />
 <b>Actions</b>:</p><ul>
<li>Single click action</li>
</ul>
<div class="fragment"><div class="line">z3ed agent test --prompt &quot;Click Open ROM button&quot;</div>
<div class="line">z3ed agent test --prompt &quot;Click Save button&quot;</div>
<div class="line">z3ed agent test --prompt &quot;Click Overworld&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1133"></a>
4. Type Input</h2>
<p><b>Pattern</b>: "Type '&lt;text&gt;' in &lt;input&gt;" <br  />
 <b>Example</b>: &lsquo;"Type 'zelda3.sfc&amp;rsquo; in filename input"` <br  />
 <b>Actions</b>:</p><ul>
<li>Click input → Type text (with clear_first)</li>
</ul>
<div class="fragment"><div class="line">z3ed agent test --prompt &quot;Type &#39;zelda3.sfc&#39; in filename input&quot;</div>
<div class="line">z3ed agent test --prompt &quot;Type &#39;test&#39; in search&quot;</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1135"></a>
Prerequisites</h1>
<h2><a class="anchor" id="autotoc_md1136"></a>
1. Build with gRPC</h2>
<div class="fragment"><div class="line">cmake -B build-grpc-test -DYAZE_WITH_GRPC=ON</div>
<div class="line">cmake --build build-grpc-test --target yaze -j$(sysctl -n hw.ncpu)</div>
<div class="line">cmake --build build-grpc-test --target z3ed -j$(sysctl -n hw.ncpu)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1137"></a>
2. Start YAZE Test Harness</h2>
<div class="fragment"><div class="line">./build-grpc-test/bin/yaze.app/Contents/MacOS/yaze \</div>
<div class="line">  --enable_test_harness \</div>
<div class="line">  --test_harness_port=50052 \</div>
<div class="line">  --rom_file=assets/zelda3.sfc &amp;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1138"></a>
3. Verify Connection</h2>
<div class="fragment"><div class="line"># Check if server is running</div>
<div class="line">lsof -i :50052</div>
<div class="line"> </div>
<div class="line"># Quick health check</div>
<div class="line">grpcurl -plaintext -import-path src/app/core/proto \</div>
<div class="line">  -proto imgui_test_harness.proto \</div>
<div class="line">  -d &#39;{&quot;message&quot;:&quot;test&quot;}&#39; \</div>
<div class="line">  127.0.0.1:50052 yaze.test.ImGuiTestHarness/Ping</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1140"></a>
Example Workflows</h1>
<h2><a class="anchor" id="autotoc_md1141"></a>
Full Overworld Editor Test</h2>
<div class="fragment"><div class="line"># 1. Start test harness (if not running)</div>
<div class="line">./build-grpc-test/bin/yaze.app/Contents/MacOS/yaze \</div>
<div class="line">  --enable_test_harness \</div>
<div class="line">  --test_harness_port=50052 \</div>
<div class="line">  --rom_file=assets/zelda3.sfc &amp;</div>
<div class="line"> </div>
<div class="line"># 2. Wait for startup</div>
<div class="line">sleep 3</div>
<div class="line"> </div>
<div class="line"># 3. Run test</div>
<div class="line">./build-grpc-test/bin/z3ed agent test \</div>
<div class="line">  --prompt &quot;Open Overworld editor and verify it loads&quot;</div>
<div class="line"> </div>
<div class="line"># Expected output:</div>
<div class="line"># === GUI Automation Test ===</div>
<div class="line"># Prompt: Open Overworld editor and verify it loads</div>
<div class="line"># Server: localhost:50052</div>
<div class="line">#</div>
<div class="line"># Generated workflow:</div>
<div class="line"># Workflow: Open and verify Overworld Editor</div>
<div class="line">#   1. Click(button:Overworld)</div>
<div class="line">#   2. Wait(window_visible:Overworld Editor, 5000ms)</div>
<div class="line">#   3. Assert(visible:Overworld Editor)</div>
<div class="line">#</div>
<div class="line"># ✓ Connected to test harness</div>
<div class="line">#</div>
<div class="line"># [1/3] Click(button:Overworld) ... ✓ (125ms)</div>
<div class="line"># [2/3] Wait(window_visible:Overworld Editor, 5000ms) ... ✓ (1250ms)</div>
<div class="line"># [3/3] Assert(visible:Overworld Editor) ... ✓ (50ms)</div>
<div class="line">#</div>
<div class="line"># ✅ Test passed in 1425ms</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1142"></a>
Custom Server Configuration</h2>
<div class="fragment"><div class="line"># Connect to remote test harness</div>
<div class="line">./build-grpc-test/bin/z3ed agent test \</div>
<div class="line">  --prompt &quot;Open Dungeon editor&quot; \</div>
<div class="line">  --host 192.168.1.100 \</div>
<div class="line">  --port 50053 \</div>
<div class="line">  --timeout 60</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1144"></a>
Error Messages</h1>
<h2><a class="anchor" id="autotoc_md1145"></a>
Connection Error</h2>
<div class="fragment"><div class="line">Failed to connect to test harness at localhost:50052</div>
<div class="line">Make sure YAZE is running with:</div>
<div class="line">  ./yaze --enable_test_harness --test_harness_port=50052 --rom_file=&lt;rom&gt;</div>
<div class="line"> </div>
<div class="line">Error: Connection refused</div>
</div><!-- fragment --><p><b>Solution</b>: Start YAZE with test harness enabled</p>
<h2><a class="anchor" id="autotoc_md1146"></a>
Unsupported Prompt</h2>
<div class="fragment"><div class="line">Unable to parse prompt: &quot;Do something complex&quot;</div>
<div class="line"> </div>
<div class="line">Supported patterns:</div>
<div class="line">  - Open &lt;Editor&gt; editor</div>
<div class="line">  - Open &lt;Editor&gt; and verify it loads</div>
<div class="line">  - Type &#39;&lt;text&gt;&#39; in &lt;input&gt;</div>
<div class="line">  - Click &lt;button&gt;</div>
<div class="line"> </div>
<div class="line">Examples:</div>
<div class="line">  - Open Overworld editor</div>
<div class="line">  - Open Dungeon editor and verify it loads</div>
<div class="line">  - Type &#39;zelda3.sfc&#39; in filename input</div>
<div class="line">  - Click Open ROM button</div>
</div><!-- fragment --><p><b>Solution</b>: Use one of the supported prompt patterns</p>
<h2><a class="anchor" id="autotoc_md1147"></a>
Widget Not Found</h2>
<div class="fragment"><div class="line">[1/2] Click(button:NonExistent) ... ✗ FAILED</div>
<div class="line">  Error: Button &#39;NonExistent&#39; not found</div>
<div class="line"> </div>
<div class="line">Step 1 failed: Button &#39;NonExistent&#39; not found</div>
</div><!-- fragment --><p><b>Solution</b>:</p><ul>
<li>Verify widget exists in YAZE</li>
<li>Check spelling (case-sensitive)</li>
<li>Use exact label from GUI</li>
</ul>
<h2><a class="anchor" id="autotoc_md1148"></a>
Timeout Error</h2>
<div class="fragment"><div class="line">[2/2] Wait(window_visible:Slow Editor, 5000ms) ... ✗ FAILED</div>
<div class="line">  Error: Condition not met after 5000 ms</div>
<div class="line"> </div>
<div class="line">Step 2 failed: Condition not met after 5000 ms</div>
</div><!-- fragment --><p><b>Solution</b>:</p><ul>
<li>Increase timeout: <code>--timeout 10</code></li>
<li>Verify window actually opens</li>
<li>Check for errors in YAZE</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md1150"></a>
Exit Codes</h1>
<ul>
<li><code>0</code> - Success (all steps passed)</li>
<li><code>1</code> - Failure (connection, parsing, or execution error)</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md1152"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md1153"></a>
Port Already in Use</h2>
<div class="fragment"><div class="line"># Kill existing instances</div>
<div class="line">killall yaze</div>
<div class="line"> </div>
<div class="line"># Wait for cleanup</div>
<div class="line">sleep 2</div>
<div class="line"> </div>
<div class="line"># Use different port</div>
<div class="line">./yaze --enable_test_harness --test_harness_port=50053 ...</div>
<div class="line">./z3ed agent test --port 50053 ...</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1154"></a>
gRPC Not Available</h2>
<div class="fragment"><div class="line">GUI automation requires YAZE_WITH_GRPC=ON at build time.</div>
<div class="line">Rebuild with: cmake -B build -DYAZE_WITH_GRPC=ON</div>
</div><!-- fragment --><p><b>Solution</b>: Rebuild with gRPC support enabled</p>
<h2><a class="anchor" id="autotoc_md1155"></a>
Widget Names Unknown</h2>
<div class="fragment"><div class="line"># Manual exploration with grpcurl</div>
<div class="line">grpcurl -plaintext -import-path src/app/core/proto \</div>
<div class="line">  -proto imgui_test_harness.proto \</div>
<div class="line">  -d &#39;{&quot;condition&quot;:&quot;visible:Main Window&quot;}&#39; \</div>
<div class="line">  127.0.0.1:50052 yaze.test.ImGuiTestHarness/Assert</div>
<div class="line"> </div>
<div class="line"># Try different widget names until you find the right one</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1157"></a>
Advanced Usage</h1>
<h2><a class="anchor" id="autotoc_md1158"></a>
Shell Script Integration</h2>
<div class="fragment"><div class="line">#!/bin/bash</div>
<div class="line">set -e</div>
<div class="line"> </div>
<div class="line"># Start YAZE</div>
<div class="line">./yaze --enable_test_harness --rom_file=zelda3.sfc &amp;</div>
<div class="line">YAZE_PID=$!</div>
<div class="line">sleep 3</div>
<div class="line"> </div>
<div class="line"># Run tests</div>
<div class="line">./z3ed agent test --prompt &quot;Open Overworld editor&quot; || exit 1</div>
<div class="line">./z3ed agent test --prompt &quot;Open Dungeon editor&quot; || exit 1</div>
<div class="line"> </div>
<div class="line"># Cleanup</div>
<div class="line">kill $YAZE_PID</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1159"></a>
CI/CD Pipeline</h2>
<div class="fragment"><div class="line"># .github/workflows/gui-tests.yml</div>
<div class="line">- name: Start YAZE Test Harness</div>
<div class="line">  run: |</div>
<div class="line">    ./yaze --enable_test_harness --rom_file=zelda3.sfc &amp;</div>
<div class="line">    sleep 5</div>
<div class="line"> </div>
<div class="line">- name: Run GUI Tests</div>
<div class="line">  run: |</div>
<div class="line">    ./z3ed agent test --prompt &quot;Open Overworld editor&quot;</div>
<div class="line">    ./z3ed agent test --prompt &quot;Open Dungeon editor&quot;</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1161"></a>
Performance Characteristics</h1>
<h2><a class="anchor" id="autotoc_md1162"></a>
Typical Timings</h2>
<ul>
<li><b>Click</b>: 50-200ms</li>
<li><b>Type</b>: 100-300ms</li>
<li><b>Wait</b>: 100-5000ms (depends on condition)</li>
<li><b>Assert</b>: 10-100ms</li>
</ul>
<h2><a class="anchor" id="autotoc_md1163"></a>
Total Test Duration</h2>
<ul>
<li>Simple click: ~100ms</li>
<li>Open editor: ~1-2s</li>
<li>Open + verify: ~1.5-2.5s</li>
<li>Complex workflow: ~3-5s</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md1165"></a>
Extending Functionality</h1>
<h2><a class="anchor" id="autotoc_md1166"></a>
Add New Pattern Type</h2>
<ol type="1">
<li><b>Add pattern matcher</b> (<code><a class="el" href="../../d8/dfb/test__workflow__generator_8h.html">test_workflow_generator.h</a></code>): <div class="fragment"><div class="line"><span class="keywordtype">bool</span> MatchesYourPattern(<span class="keyword">const</span> std::string&amp; prompt, ...);</div>
</div><!-- fragment --></li>
<li><b>Add workflow builder</b> (<code><a class="el" href="../../db/d09/test__workflow__generator_8cc.html">test_workflow_generator.cc</a></code>): <div class="fragment"><div class="line">TestWorkflow BuildYourPatternWorkflow(...);</div>
</div><!-- fragment --></li>
<li><b>Add to GenerateWorkflow()</b> (<code><a class="el" href="../../db/d09/test__workflow__generator_8cc.html">test_workflow_generator.cc</a></code>): <div class="fragment"><div class="line"><span class="keywordflow">if</span> (MatchesYourPattern(prompt, &amp;params)) {</div>
<div class="line">  <span class="keywordflow">return</span> BuildYourPatternWorkflow(params);</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="autotoc_md1167"></a>
Add New Widget Type</h2>
<p>Currently supported: <code>button:</code>, <code>input:</code>, <code>window:</code></p>
<p>To add more, extend the target format in RPC calls.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md1169"></a>
See Also</h1>
<ul>
<li><b>Full Documentation</b>: <a class="el" href="../../d3/dd9/md_docs_2z3ed_2IT-01-QUICKSTART.html">IT-01-QUICKSTART.md</a></li>
<li><b>E2E Validation</b>: <a class="el" href="../../d2/d1e/md_docs_2z3ed_2E2E__VALIDATION__GUIDE.html">E2E_VALIDATION_GUIDE.md</a></li>
<li><b>Implementation Details</b>: <a class="el" href="../../de/dd1/md_docs_2z3ed_2IMPLEMENTATION__PROGRESS__OCT2.html">IMPLEMENTATION_PROGRESS_OCT2.md</a></li>
<li><b>Architecture Overview</b>: <a class="el" href="../../df/da9/md_docs_2z3ed_2E6-z3ed-implementation-plan.html">E6-z3ed-implementation-plan.md</a></li>
</ul>
<hr  />
<p><b>Last Updated</b>: October 2, 2025 <br  />
 <b>Version</b>: IT-02 Complete <br  />
 <b>Status</b>: Ready for validation </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
