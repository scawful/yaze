name: Doxygen Documentation Check

# Only run when documentation-related files are modified
on:
  pull_request:
    branches: [ master ]
    paths:
      - 'src/**/*.h'
      - 'src/**/*.cc'
      - 'src/**/*.cpp'
      - 'docs/**'
      - 'Doxyfile'
      - '.github/workflows/doxy.yml'

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  check-docs:
    name: Check Documentation Build
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0

    - name: Install Graphviz
      run: |
        sudo apt-get update
        sudo apt-get install -y graphviz

    - name: Install Doxygen 1.10.0
      uses: ssciwr/doxygen-install@v1
      with:
        version: "1.10.0"

    - name: Generate Doxygen documentation
      run: |
        mkdir -p build/docs
        doxygen Doxyfile
    
    - name: Verify Generation
      run: |
        if [ -d "build/docs/html" ]; then
          echo "✅ Documentation generated successfully"
        else
          echo "❌ Documentation generation failed"
          exit 1
        fi
