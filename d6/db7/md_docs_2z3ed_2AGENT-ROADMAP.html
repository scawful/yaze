<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>yaze: z3ed Agent Roadmap</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../yaze.ico"/></td>
  <td id="projectalign">
   <div id="projectname">yaze<span id="projectnumber">&#160;0.3.1</span>
   </div>
   <div id="projectbrief">Link to the Past ROM Editor</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d6/db7/md_docs_2z3ed_2AGENT-ROADMAP.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">z3ed Agent Roadmap</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1217"></a> <b>Last Updated</b>: October 3, 2025</p>
<h1><a class="anchor" id="autotoc_md1218"></a>
Current Status</h1>
<h2><a class="anchor" id="autotoc_md1219"></a>
‚úÖ Production Ready</h2>
<ul>
<li><b>Build System</b>: Z3ED_AI flag consolidation complete</li>
<li><b>AI Backends</b>: Ollama (local) and Gemini (cloud) operational</li>
<li><b>Conversational Agent</b>: Multi-step tool execution with chat history</li>
<li><b>Tool Dispatcher</b>: 5 read-only tools (resource-list, dungeon-list-sprites, overworld-find-tile, overworld-describe-map, overworld-list-warps)</li>
<li><b>TUI Chat</b>: FTXUI-based interactive terminal interface</li>
<li><b>Simple Chat</b>: Text-mode REPL for AI testing (no FTXUI dependencies)</li>
<li><b>GUI Chat Widget</b>: ImGui-based widget (needs integration into main app)</li>
</ul>
<h2><a class="anchor" id="autotoc_md1220"></a>
üöß Active Work</h2>
<ol type="1">
<li><b>Live LLM Testing</b> (1-2h): Verify function calling with real models</li>
<li><b>GUI Integration</b> (4-6h): Wire AgentChatWidget into YAZE editor</li>
<li><b>Proposal Workflow</b> (6-8h): End-to-end integration from chat to ROM changes</li>
</ol>
<h1><a class="anchor" id="autotoc_md1221"></a>
Core Vision</h1>
<p>Transform z3ed from a command-line tool into a <b>conversational ROM hacking assistant</b> where users can:</p><ul>
<li>Ask questions about ROM contents ("What dungeons exist?")</li>
<li>Inspect game data interactively ("How many soldiers in room X?")</li>
<li>Build changes incrementally through dialogue</li>
<li>Generate proposals from conversation context</li>
</ul>
<h1><a class="anchor" id="autotoc_md1222"></a>
Technical Architecture</h1>
<h2><a class="anchor" id="autotoc_md1223"></a>
1. Conversational Agent Service ‚úÖ</h2>
<p><b>Status</b>: Complete</p><ul>
<li><code>ConversationalAgentService</code>: Manages chat sessions and tool execution</li>
<li>Integrates with Ollama/Gemini AI services</li>
<li>Handles tool calls with automatic JSON formatting</li>
<li>Maintains conversation history and context</li>
</ul>
<h2><a class="anchor" id="autotoc_md1224"></a>
2. Read-Only Tools ‚úÖ</h2>
<p><b>Status</b>: 5 tools implemented</p><ul>
<li><code>resource-list</code>: Enumerate labeled resources</li>
<li><code>dungeon-list-sprites</code>: Inspect sprites in rooms</li>
<li><code>overworld-find-tile</code>: Search for tile16 IDs</li>
<li><code>overworld-describe-map</code>: Get map metadata</li>
<li><code>overworld-list-warps</code>: List entrances/exits/holes</li>
</ul>
<p><b>Next</b>: Add dialogue, sprite info, and region inspection tools</p>
<h2><a class="anchor" id="autotoc_md1225"></a>
3. Chat Interfaces</h2>
<p><b>Status</b>: Multiple modes available</p><ul>
<li><b>TUI (FTXUI)</b>: Full-screen interactive terminal (‚úÖ complete)</li>
<li><b>Simple Mode</b>: Text REPL for automation/testing (‚úÖ complete)</li>
<li><b>GUI (<a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a>)</b>: Dockable widget in YAZE (‚ö†Ô∏è needs integration)</li>
</ul>
<h2><a class="anchor" id="autotoc_md1226"></a>
4. Proposal Workflow Integration</h2>
<p><b>Status</b>: Planned <b>Goal</b>: When user requests ROM changes, agent generates proposal</p><ol type="1">
<li>User chats to explore ROM</li>
<li>User requests change ("add two more soldiers")</li>
<li>Agent generates commands ‚Üí creates proposal</li>
<li>User reviews with <code>agent diff</code> or GUI</li>
<li>User accepts/rejects proposal</li>
</ol>
<h1><a class="anchor" id="autotoc_md1227"></a>
Immediate Priorities</h1>
<h2><a class="anchor" id="autotoc_md1228"></a>
Priority 1: Live LLM Testing (1-2 hours)</h2>
<p>Verify function calling works end-to-end:</p><ul>
<li>Test Gemini 2.0 with natural language prompts</li>
<li>Test Ollama (qwen2.5-coder) with tool discovery</li>
<li>Validate multi-step conversations</li>
<li>Exercise all 5 tools</li>
</ul>
<h2><a class="anchor" id="autotoc_md1229"></a>
Priority 2: GUI Chat Integration (4-6 hours)</h2>
<p>Wire AgentChatWidget into main YAZE editor:</p><ul>
<li>Add menu item: Debug ‚Üí Agent Chat</li>
<li>Connect to shared ConversationalAgentService</li>
<li>Test with loaded ROM context</li>
<li>Add history persistence</li>
</ul>
<h2><a class="anchor" id="autotoc_md1230"></a>
Priority 3: Proposal Generation (6-8 hours)</h2>
<h1><a class="anchor" id="autotoc_md1231"></a>
Technical Implementation Plan</h1>
<h2><a class="anchor" id="autotoc_md1232"></a>
1. Conversational Agent Service</h2>
<ul>
<li><b>Description</b>: A new service that will manage the back-and-forth between the user and the LLM. It will maintain chat history and orchestrate the agent's different modes (Q&amp;A vs. command generation).</li>
<li><b>Components</b>:<ul>
<li><code>ConversationalAgentService</code>: The main class for managing the chat session.</li>
<li>Integration with existing <code>AIService</code> implementations (Ollama, Gemini).</li>
</ul>
</li>
<li><b>Status</b>: In progress ‚Äî baseline service exists with chat history, tool loop handling, and structured response parsing. Next up: wiring in live ROM context and richer session state.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1233"></a>
2. Read-Only "Tools" for the Agent</h2>
<ul>
<li><b>Description</b>: To enable the agent to answer questions, we need to expand <code>z3ed</code> with a suite of read-only commands that the LLM can call. This is aligned with the "tool use" or "function calling" capabilities of modern LLMs.</li>
<li><b>Example Tools to Implement</b>:<ul>
<li><code>resource list --type &lt;dungeon|sprite|...&gt;</code>: List all user-defined labels of a certain type.</li>
<li><code>dungeon list-sprites --room &lt;id|label&gt;</code>: List all sprites in a given room.</li>
<li><code>dungeon get-info --room &lt;id|label&gt;</code>: Get metadata for a specific room.</li>
<li><code>overworld find-tile --tile &lt;id&gt;</code>: Find all occurrences of a specific tile on the overworld map.</li>
</ul>
</li>
<li><b>Advanced Editing Tools (for future implementation)</b>:<ul>
<li><code>overworld set-area --map &lt;id&gt; --x &lt;x&gt; --y &lt;y&gt; --width &lt;w&gt; --height &lt;h&gt; --tile &lt;id&gt;</code></li>
<li><code>overworld replace-tile --map &lt;id&gt; --from &lt;old_id&gt; --to &lt;new_id&gt;</code></li>
<li><code>overworld blend-tiles --map &lt;id&gt; --pattern &lt;name&gt; --density &lt;percent&gt;</code></li>
</ul>
</li>
<li><b>Status</b>: Foundational commands (<code>resource-list</code>, <code>dungeon-list-sprites</code>) are live with JSON output. Focus is shifting to high-value Overworld and dialogue inspection tools.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1234"></a>
3. TUI and GUI Chat Interfaces</h2>
<ul>
<li><b>Description</b>: User-facing components for interacting with the <code>ConversationalAgentService</code>.</li>
<li><b>Components</b>:<ul>
<li><b>TUI</b>: A new full-screen component in <code>z3ed</code> using FTXUI, providing a rich chat experience in the terminal.</li>
<li><b>GUI</b>: A new <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> widget that can be docked into the main <code>yaze</code> application window.</li>
</ul>
</li>
<li><b>Status</b>: In progress ‚Äî CLI/TUI and GUI chat widgets exist, now rendering tables/JSON with readable formatting. Need to improve input ergonomics and synchronized history navigation.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1235"></a>
4. Integration with the Proposal Workflow</h2>
<ul>
<li><b>Description</b>: The final step is to connect the conversation to the action. When a user's prompt implies a desire to modify the ROM (e.g., "Okay, now add two more soldiers"), the <code>ConversationalAgentService</code> will trigger the existing <code>Tile16ProposalGenerator</code> (and future proposal generators for other resource types) to create a proposal.</li>
<li><b>Workflow</b>:<ol type="1">
<li>User chats with the agent to explore the ROM.</li>
<li>User asks the agent to make a change.</li>
<li><code>ConversationalAgentService</code> generates the commands and passes them to the appropriate <code>ProposalGenerator</code>.</li>
<li>A new proposal is created and saved.</li>
<li>The TUI/GUI notifies the user that a proposal is ready for review.</li>
<li>User uses the <code>agent diff</code> and <code>agent accept</code> commands (or UI equivalents) to review and apply the changes.</li>
</ol>
</li>
<li><b>Status</b>: The proposal workflow itself is mostly implemented. This task involves integrating it with the new conversational service.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1236"></a>
Next Steps</h1>
<h2><a class="anchor" id="autotoc_md1237"></a>
Immediate Priorities</h2>
<ol type="1">
<li><b>‚úÖ Build System Consolidation</b> (COMPLETE - Oct 3, 2025):<ul>
<li>‚úÖ Created Z3ED_AI master flag for simplified builds</li>
<li>‚úÖ Fixed Gemini crash with graceful degradation</li>
<li>‚úÖ Updated documentation with new build instructions</li>
<li>‚úÖ Tested both Ollama and Gemini backends</li>
<li><b>Next</b>: Update CI/CD workflows to use <code>-DZ3ED_AI=ON</code></li>
</ul>
</li>
<li><b>Live LLM Testing</b> (NEXT UP - 1-2 hours):<ul>
<li>Verify function calling works with real Ollama/Gemini</li>
<li>Test multi-step tool execution</li>
<li>Validate all 5 tools with natural language prompts</li>
</ul>
</li>
<li><b>Expand Overworld Tool Coverage</b>:<ul>
<li>‚úÖ Ship read-only tile searches (<code>overworld find-tile</code>) with shared formatting for CLI and agent calls.</li>
<li>Next: add area summaries, teleport destination lookups, and keep JSON/Text parity for all new tools.</li>
</ul>
</li>
<li><b>Polish the TUI Chat Experience</b>:<ul>
<li>Tighten keyboard shortcuts, scrolling, and copy-to-clipboard behaviour.</li>
<li>Align log file output with on-screen formatting for easier debugging.</li>
</ul>
</li>
<li><b>Document &amp; Test the New Tooling</b>:<ul>
<li>Update the main <code>README.md</code> and relevant docs to cover the new chat formatting.</li>
<li>Add regression tests (unit or golden JSON fixtures) for the new Overworld tools.</li>
</ul>
</li>
</ol>
<ol type="1">
<li><b>Build GUI Chat Widget</b>:<ul>
<li>Create the <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> component.</li>
<li>Ensure it shares the same backend service as the TUI.</li>
</ul>
</li>
<li><b>Full Integration with Proposal System</b>:<ul>
<li>Implement the logic for the agent to transition from conversation to proposal generation.</li>
</ul>
</li>
<li><b>Expand Tool Arsenal</b>:<ul>
<li>Continuously add new read-only commands to give the agent more capabilities to inspect the ROM.</li>
</ul>
</li>
<li><b>Multi-Modal Agent</b>:<ul>
<li>Explore the possibility of the agent generating and displaying images (e.g., a map of a dungeon room) in the chat.</li>
</ul>
</li>
<li><b>Advanced Configuration</b>:<ul>
<li>Implement environment variables for selecting AI providers and models (e.g., <code>YAZE_AI_PROVIDER</code>, <code>OLLAMA_MODEL</code>).</li>
<li>Add CLI flags for overriding the provider and model on a per-command basis.</li>
</ul>
</li>
<li><b>Performance and Cost-Saving</b>:<ul>
<li>Implement a response cache to reduce latency and API costs.</li>
<li>Add token usage tracking and reporting.</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md1238"></a>
Current Status &amp; Next Steps (Updated: October 3, 2025)</h1>
<p>We have made significant progress in laying the foundation for the conversational agent.</p>
<h2><a class="anchor" id="autotoc_md1239"></a>
‚úÖ Completed</h2>
<ul>
<li><b>Build System Consolidation</b>: ‚úÖ <b>NEW</b> Z3ED_AI master flag (Oct 3, 2025)<ul>
<li>Single flag enables all AI features: <code>-DZ3ED_AI=ON</code></li>
<li>Auto-manages dependencies (JSON, YAML, httplib, OpenSSL)</li>
<li>Fixed Gemini crash when API key set but JSON disabled</li>
<li>Graceful degradation with clear error messages</li>
<li>Backward compatible with old flags</li>
<li>Ready for build modularization (enables optional <code>libyaze_agent.a</code>)</li>
<li><b>Docs</b>: <code>docs/z3ed/Z3ED_AI_FLAG_MIGRATION.md</code></li>
</ul>
</li>
<li>**<code>ConversationalAgentService</code>**: ‚úÖ Fully operational with multi-step tool execution loop<ul>
<li>Handles tool calls with automatic JSON output format</li>
<li>Prevents recursion through proper tool result replay</li>
<li>Supports conversation history and context management</li>
</ul>
</li>
<li><b>TUI Chat Interface</b>: ‚úÖ Production-ready (<code>z3ed agent chat</code>)<ul>
<li>Renders tables from JSON tool results</li>
<li>Pretty-prints JSON payloads with syntax formatting</li>
<li>Scrollable history with user/agent distinction</li>
</ul>
</li>
<li><b>Tool Dispatcher</b>: ‚úÖ Complete with 5 read-only tools<ul>
<li><code>resource-list</code>: Enumerate labeled resources (dungeons, sprites, palettes)</li>
<li><code>dungeon-list-sprites</code>: Inspect sprites in dungeon rooms</li>
<li><code>overworld-find-tile</code>: Search for tile16 IDs across maps</li>
<li><code>overworld-describe-map</code>: Get comprehensive map metadata</li>
<li><code>overworld-list-warps</code>: List entrances/exits/holes with filtering</li>
</ul>
</li>
<li><b>Structured Output Rendering</b>: ‚úÖ Both TUI formats support tables and JSON<ul>
<li>Automatic table generation from JSON arrays/objects</li>
<li>Column-aligned formatting with headers</li>
<li>Graceful fallback to text for malformed data</li>
</ul>
</li>
<li><b>ROM Context Integration</b>: ‚úÖ Tools can access loaded ROM or load from <code>--rom</code> flag<ul>
<li>Shared ROM context passed through ConversationalAgentService</li>
<li>Automatic ROM loading with error handling</li>
</ul>
</li>
<li><b>AI Service Foundation</b>: ‚úÖ Ollama and Gemini services operational<ul>
<li>Enhanced prompting system with resource catalogue loading</li>
<li>System instruction generation with examples</li>
<li>Health checks and model availability validation</li>
<li>Both backends tested and working in production</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1240"></a>
üöß In Progress</h2>
<ul>
<li><b>Live LLM Testing</b>: Ready to execute with real Ollama/Gemini<ul>
<li>All infrastructure complete (function calling, tool schemas, response parsing)</li>
<li>Need to verify multi-step tool execution with live models</li>
<li>Test scenarios prepared for all 5 tools</li>
<li><b>Estimated Time</b>: 1-2 hours</li>
</ul>
</li>
<li><b>GUI Chat Widget</b>: Not yet started<ul>
<li>TUI implementation complete and can serve as reference</li>
<li>Should reuse table/JSON rendering logic from TUI</li>
<li>Target: <code>src/app/gui/debug/agent_chat_widget.{h,cc}</code></li>
<li><b>Estimated Time</b>: 6-8 hours</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1241"></a>
üöÄ Next Steps (Priority Order)</h2>
<h3><a class="anchor" id="autotoc_md1242"></a>
Priority 1: Live LLM Testing with Function Calling (1-2 hours)</h3>
<p><b>Goal</b>: Verify Ollama/Gemini can autonomously invoke tools in production</p>
<p><b>Infrastructure Complete</b> ‚úÖ:</p><ul>
<li>‚úÖ Tool schema generation (<code>BuildFunctionCallSchemas()</code>)</li>
<li>‚úÖ System prompts include function definitions</li>
<li>‚úÖ AI services parse <code>tool_calls</code> from responses</li>
<li>‚úÖ ConversationalAgentService dispatches to ToolDispatcher</li>
<li>‚úÖ All 5 tools tested independently</li>
</ul>
<p><b>Testing Tasks</b>:</p><ol type="1">
<li><b>Gemini Testing</b> (30 min)<ul>
<li>Verify Gemini 2.0 generates correct <code>tool_calls</code> JSON</li>
<li>Test prompt: "What dungeons are in this ROM?"</li>
<li>Verify tool result fed back into conversation</li>
<li>Test multi-step: "Now list sprites in the first dungeon"</li>
</ul>
</li>
<li><b>Ollama Testing</b> (30 min)<ul>
<li>Verify qwen2.5-coder discovers and calls tools</li>
<li>Same test prompts as Gemini</li>
<li>Compare response quality between models</li>
</ul>
</li>
<li><b>Tool Coverage Testing</b> (30 min)<ul>
<li>Exercise all 5 tools with natural language prompts</li>
<li>Verify JSON output formats correctly</li>
<li>Test error handling (invalid room IDs, etc.)</li>
</ul>
</li>
</ol>
<p><b>Success Criteria</b>:</p><ul>
<li>LLM autonomously calls tools without explicit command syntax</li>
<li>Tool results incorporated into follow-up responses</li>
<li>Multi-turn conversations work with context</li>
</ul>
<h3><a class="anchor" id="autotoc_md1243"></a>
Priority 2: Implement GUI Chat Widget (6-8 hours)</h3>
<p><b>Goal</b>: Unified chat experience in YAZE application</p>
<ol type="1">
<li><b>Create <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> Chat Widget</b> (4 hours)<ul>
<li>File: <code>src/app/gui/debug/agent_chat_widget.{h,cc}</code></li>
<li>Reuse table/JSON rendering logic from TUI implementation</li>
<li>Add to Debug menu: <code>Debug ‚Üí Agent Chat</code></li>
<li>Share <code>ConversationalAgentService</code> instance with TUI</li>
</ul>
</li>
<li><b>Add Chat History Persistence</b> (2 hours)<ul>
<li>Save chat history to <code>.yaze/agent_chat_history.json</code></li>
<li>Load on startup, display in GUI/TUI</li>
<li>Add "Clear History" button</li>
</ul>
</li>
<li><b>Polish Input Experience</b> (2 hours)<ul>
<li>Multi-line input support (Shift+Enter for newline, Enter to send)</li>
<li>Keyboard shortcuts: Ctrl+L to clear, Ctrl+C to copy last response</li>
<li>Auto-scroll to bottom on new messages</li>
</ul>
</li>
</ol>
<h3><a class="anchor" id="autotoc_md1244"></a>
Priority 3: Proposal Generation (6-8 hours)</h3>
<p>Connect chat to ROM modification workflow:</p><ul>
<li>Detect action intents in conversation</li>
<li>Generate proposal from accumulated context</li>
<li>Link proposal to chat history</li>
<li>GUI notification when proposal ready</li>
</ul>
<h1><a class="anchor" id="autotoc_md1245"></a>
Command Reference</h1>
<h2><a class="anchor" id="autotoc_md1246"></a>
Chat Modes</h2>
<div class="fragment"><div class="line"># Interactive TUI chat (FTXUI)</div>
<div class="line">z3ed agent chat --rom zelda3.sfc</div>
<div class="line"> </div>
<div class="line"># Simple text mode (for automation/AI testing)</div>
<div class="line">z3ed agent simple-chat --rom zelda3.sfc</div>
<div class="line"> </div>
<div class="line"># Batch mode from file</div>
<div class="line">z3ed agent simple-chat --file tests.txt --rom zelda3.sfc</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1247"></a>
Tool Commands (for direct testing)</h2>
<div class="fragment"><div class="line"># List dungeons</div>
<div class="line">z3ed agent resource-list --type dungeon --format json</div>
<div class="line"> </div>
<div class="line"># Find tiles</div>
<div class="line">z3ed agent overworld-find-tile --tile 0x02E --map 0x05</div>
<div class="line"> </div>
<div class="line"># List sprites in room</div>
<div class="line">z3ed agent dungeon-list-sprites --room 0x012</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1248"></a>
Build Quick Reference</h1>
<div class="fragment"><div class="line"># Full AI features</div>
<div class="line">cmake -B build -DZ3ED_AI=ON</div>
<div class="line">cmake --build build --target z3ed</div>
<div class="line"> </div>
<div class="line"># With GUI automation/testing</div>
<div class="line">cmake -B build -DZ3ED_AI=ON -DYAZE_WITH_GRPC=ON</div>
<div class="line">cmake --build build</div>
<div class="line"> </div>
<div class="line"># Minimal (no AI)</div>
<div class="line">cmake -B build</div>
<div class="line">cmake --build build --target z3ed</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1249"></a>
Future Enhancements</h1>
<h2><a class="anchor" id="autotoc_md1250"></a>
Short Term (1-2 months)</h2>
<ul>
<li>Dialogue/text search tools</li>
<li>Sprite info inspection</li>
<li>Region/teleport tools</li>
<li>Response caching</li>
<li>Token usage tracking</li>
</ul>
<h2><a class="anchor" id="autotoc_md1251"></a>
Medium Term (3-6 months)</h2>
<ul>
<li>Multi-modal agent (image generation)</li>
<li>Advanced configuration (env vars, model selection)</li>
<li>Proposal templates for common edits</li>
<li>Undo/redo in conversations</li>
</ul>
<h2><a class="anchor" id="autotoc_md1252"></a>
Long Term (6+ months)</h2>
<ul>
<li>Visual diff viewer for proposals</li>
<li>Collaborative editing sessions</li>
<li>Learning from user feedback</li>
<li>Custom tool plugins <b>Goal</b>: Enable deeper ROM introspection for level design questions</li>
</ul>
<ol type="1">
<li><b>Dialogue/Text Tools</b> (3 hours)<ul>
<li><code>dialogue-search --text "search term"</code>: Find text in ROM dialogue</li>
<li><code>dialogue-get --id 0x...</code>: Get dialogue by message ID</li>
</ul>
</li>
<li><b>Sprite Tools</b> (3 hours)<ul>
<li><code>sprite-get-info --id 0x...</code>: Sprite metadata (HP, damage, AI)</li>
<li><code>overworld-list-sprites --map 0x...</code>: Sprites on overworld map</li>
</ul>
</li>
<li><b>Advanced Overworld Tools</b> (4 hours)<ul>
<li><code>overworld-get-region --map 0x...</code>: Region boundaries and properties</li>
<li><code>overworld-list-transitions --from-map 0x...</code>: Map transitions/scrolling</li>
<li><code>overworld-get-tile-at --map 0x... --x N --y N</code>: Get specific tile16 value</li>
</ul>
</li>
</ol>
<h3><a class="anchor" id="autotoc_md1253"></a>
Priority 4: Performance and Caching (4-6 hours)</h3>
<ol type="1">
<li><b>Response Caching</b> (3 hours)<ul>
<li>Implement LRU cache for identical prompts</li>
<li>Cache tool results by (tool_name, args) key</li>
<li>Configurable TTL (default: 5 minutes for ROM introspection)</li>
</ul>
</li>
<li><b>Token Usage Tracking</b> (2 hours)<ul>
<li>Log tokens per request (Ollama and Gemini APIs provide this)</li>
<li>Display in chat footer: "Last response: 1234 tokens, ~$0.02"</li>
<li>Add <code>--show-token-usage</code> flag to CLI commands</li>
</ul>
</li>
<li><b>Streaming Responses</b> (optional, 3-4 hours)<ul>
<li>Use Ollama/Gemini streaming APIs</li>
<li>Update GUI/TUI to show partial responses as they arrive</li>
<li>Improves perceived latency for long responses</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md1254"></a>
z3ed Build Quick Reference</h1>
<div class="fragment"><div class="line"># Full AI features (Ollama + Gemini)</div>
<div class="line">cmake -B build -DZ3ED_AI=ON</div>
<div class="line">cmake --build build --target z3ed</div>
<div class="line"> </div>
<div class="line"># AI + GUI automation/testing</div>
<div class="line">cmake -B build -DZ3ED_AI=ON -DYAZE_WITH_GRPC=ON</div>
<div class="line">cmake --build build --target z3ed</div>
<div class="line"> </div>
<div class="line"># Minimal build (no AI)</div>
<div class="line">cmake -B build</div>
<div class="line">cmake --build build --target z3ed</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1255"></a>
Build Flags Explained</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag   </th><th class="markdownTableHeadNone">Purpose   </th><th class="markdownTableHeadNone">Dependencies   </th><th class="markdownTableHeadNone">When to Use    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Z3ED_AI=ON</code>   </td><td class="markdownTableBodyNone"><b>Master flag</b> for AI features   </td><td class="markdownTableBodyNone">JSON, YAML, httplib, (OpenSSL*)   </td><td class="markdownTableBodyNone">Want Ollama or Gemini support    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>YAZE_WITH_GRPC=ON</code>   </td><td class="markdownTableBodyNone">GUI automation &amp; testing   </td><td class="markdownTableBodyNone">gRPC, Protobuf, (auto-enables JSON)   </td><td class="markdownTableBodyNone">Want GUI test harness    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>YAZE_WITH_JSON=ON</code>   </td><td class="markdownTableBodyNone">Low-level JSON support   </td><td class="markdownTableBodyNone">nlohmann_json   </td><td class="markdownTableBodyNone">Auto-enabled by above flags   </td></tr>
</table>
<p>*OpenSSL optional - required for Gemini (HTTPS), Ollama works without it</p>
<h1><a class="anchor" id="autotoc_md1256"></a>
Feature Matrix</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Feature   </th><th class="markdownTableHeadNone">No Flags   </th><th class="markdownTableHeadNone">Z3ED_AI   </th><th class="markdownTableHeadNone">Z3ED_AI + GRPC    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Basic CLI   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Ollama (local)   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Gemini (cloud)   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚úÖ*   </td><td class="markdownTableBodyNone">‚úÖ*    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TUI Chat   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">GUI Test Automation   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚úÖ    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Tool Dispatcher   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Function Calling   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td></tr>
</table>
<p>*Requires OpenSSL for HTTPS</p>
<h1><a class="anchor" id="autotoc_md1257"></a>
Common Build Scenarios</h1>
<h2><a class="anchor" id="autotoc_md1258"></a>
Developer (AI features, no GUI testing)</h2>
<div class="fragment"><div class="line">cmake -B build -DZ3ED_AI=ON</div>
<div class="line">cmake --build build --target z3ed -j8</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1259"></a>
Full Stack (AI + GUI automation)</h2>
<div class="fragment"><div class="line">cmake -B build -DZ3ED_AI=ON -DYAZE_WITH_GRPC=ON</div>
<div class="line">cmake --build build --target z3ed -j8</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1260"></a>
CI/CD (minimal, fast)</h2>
<div class="fragment"><div class="line">cmake -B build -DYAZE_MINIMAL_BUILD=ON</div>
<div class="line">cmake --build build -j$(nproc)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1261"></a>
Release Build (optimized)</h2>
<div class="fragment"><div class="line">cmake -B build -DZ3ED_AI=ON -DCMAKE_BUILD_TYPE=Release</div>
<div class="line">cmake --build build --target z3ed -j8</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1262"></a>
Migration from Old Flags</h1>
<h2><a class="anchor" id="autotoc_md1263"></a>
Before (Confusing)</h2>
<div class="fragment"><div class="line">cmake -B build -DYAZE_WITH_GRPC=ON -DYAZE_WITH_JSON=ON</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1264"></a>
After (Clear Intent)</h2>
<div class="fragment"><div class="line">cmake -B build -DZ3ED_AI=ON -DYAZE_WITH_GRPC=ON</div>
</div><!-- fragment --><p><b>Note</b>: Old flags still work for backward compatibility!</p>
<h1><a class="anchor" id="autotoc_md1265"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md1266"></a>
"Build with -DZ3ED_AI=ON" warning</h2>
<p><b>Symptom</b>: AI commands fail with "JSON support required" <br  />
 <b>Fix</b>: Rebuild with AI flag </p><div class="fragment"><div class="line">rm -rf build &amp;&amp; cmake -B build -DZ3ED_AI=ON &amp;&amp; cmake --build build</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1267"></a>
"OpenSSL not found" warning</h2>
<p><b>Symptom</b>: Gemini API doesn't work <br  />
 <b>Impact</b>: Only affects Gemini (cloud). Ollama (local) works fine <br  />
 <b>Fix (optional)</b>: </p><div class="fragment"><div class="line"># macOS</div>
<div class="line">brew install openssl</div>
<div class="line"> </div>
<div class="line"># Linux</div>
<div class="line">sudo apt install libssl-dev</div>
<div class="line"> </div>
<div class="line"># Then rebuild</div>
<div class="line">cmake -B build -DZ3ED_AI=ON &amp;&amp; cmake --build build</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1268"></a>
Ollama vs Gemini not auto-detecting</h2>
<p><b>Symptom</b>: Wrong backend selected <br  />
 <b>Fix</b>: Set explicit provider </p><div class="fragment"><div class="line"># Force Ollama</div>
<div class="line">export YAZE_AI_PROVIDER=ollama</div>
<div class="line">./build/bin/z3ed agent plan --prompt &quot;test&quot;</div>
<div class="line"> </div>
<div class="line"># Force Gemini</div>
<div class="line">export YAZE_AI_PROVIDER=gemini</div>
<div class="line">export GEMINI_API_KEY=&quot;your-key&quot;</div>
<div class="line">./build/bin/z3ed agent plan --prompt &quot;test&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1269"></a>
Environment Variables</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Variable   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>YAZE_AI_PROVIDER</code>   </td><td class="markdownTableBodyNone">auto   </td><td class="markdownTableBodyNone">Force <code>ollama</code> or <code>gemini</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>GEMINI_API_KEY</code>   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Gemini API key (enables Gemini)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>OLLAMA_MODEL</code>   </td><td class="markdownTableBodyNone"><code>qwen2.5-coder:7b</code>   </td><td class="markdownTableBodyNone">Override Ollama model    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>GEMINI_MODEL</code>   </td><td class="markdownTableBodyNone"><code>gemini-2.5-flash</code>   </td><td class="markdownTableBodyNone">Override Gemini model   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md1270"></a>
Platform-Specific Notes</h1>
<h2><a class="anchor" id="autotoc_md1271"></a>
macOS</h2>
<ul>
<li>OpenSSL auto-detected via Homebrew</li>
<li>Keychain integration for SSL certs</li>
<li>Recommended: <code>brew install openssl ollama</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md1272"></a>
Linux</h2>
<ul>
<li>OpenSSL typically pre-installed</li>
<li>Install via: <code>sudo apt install libssl-dev</code></li>
<li>Ollama: Download from <a href="https://ollama.com">https://ollama.com</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md1273"></a>
Windows</h2>
<ul>
<li>Use Ollama (no SSL required)</li>
<li>Gemini requires OpenSSL (harder to setup on Windows)</li>
<li>Recommend: Focus on Ollama for Windows builds</li>
</ul>
<h1><a class="anchor" id="autotoc_md1274"></a>
Performance Tips</h1>
<h2><a class="anchor" id="autotoc_md1275"></a>
Faster Incremental Builds</h2>
<div class="fragment"><div class="line"># Use Ninja instead of Make</div>
<div class="line">cmake -B build -GNinja -DZ3ED_AI=ON</div>
<div class="line">ninja -C build z3ed</div>
<div class="line"> </div>
<div class="line"># Enable ccache</div>
<div class="line">export CMAKE_CXX_COMPILER_LAUNCHER=ccache</div>
<div class="line">cmake -B build -DZ3ED_AI=ON</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1276"></a>
Reduce Build Scope</h2>
<div class="fragment"><div class="line"># Only build z3ed (not full yaze app)</div>
<div class="line">cmake --build build --target z3ed</div>
<div class="line"> </div>
<div class="line"># Parallel build</div>
<div class="line">cmake --build build --target z3ed -j$(nproc)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1277"></a>
Related Documentation</h1>
<ul>
<li><b>Migration Guide</b>: Z3ED_AI_FLAG_MIGRATION.md</li>
<li><b>Technical Roadmap</b>: <a class="el" href="../../d6/db7/md_docs_2z3ed_2AGENT-ROADMAP.html">AGENT-ROADMAP.md</a></li>
<li><b>Main README</b>: <a class="el" href="../../d0/d30/md_README.html">README.md</a></li>
<li><b>Build Modularization</b>: <code>../../build_modularization_plan.md</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md1278"></a>
Quick Test</h1>
<p>Verify your build works:</p>
<div class="fragment"><div class="line"># Check z3ed runs</div>
<div class="line">./build/bin/z3ed --version</div>
<div class="line"> </div>
<div class="line"># Test AI detection</div>
<div class="line">./build/bin/z3ed agent plan --prompt &quot;test&quot; 2&gt;&amp;1 | head -5</div>
<div class="line"> </div>
<div class="line"># Expected output (with Z3ED_AI=ON):</div>
<div class="line"># ü§ñ Using Gemini AI with model: gemini-2.5-flash</div>
<div class="line"># or</div>
<div class="line"># ü§ñ Using Ollama AI with model: qwen2.5-coder:7b</div>
<div class="line"># or</div>
<div class="line"># ü§ñ Using MockAIService (no LLM configured)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1279"></a>
Support</h1>
<p>If you encounter issues:</p><ol type="1">
<li>Check this guide's troubleshooting section</li>
<li>Review Z3ED_AI_FLAG_MIGRATION.md</li>
<li>Verify CMake output for warnings</li>
<li>Open an issue with build logs</li>
</ol>
<h1><a class="anchor" id="autotoc_md1280"></a>
Summary</h1>
<p><b>Recommended for most users</b>: </p><div class="fragment"><div class="line">cmake -B build -DZ3ED_AI=ON</div>
<div class="line">cmake --build build --target z3ed -j8</div>
<div class="line">./build/bin/z3ed agent chat</div>
</div><!-- fragment --><p>This gives you:</p><ul>
<li>‚úÖ Ollama support (local, free)</li>
<li>‚úÖ Gemini support (cloud, API key required)</li>
<li>‚úÖ TUI chat interface</li>
<li>‚úÖ Tool dispatcher with 5 commands</li>
<li>‚úÖ Function calling support</li>
<li>‚úÖ All AI agent features </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
