<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>yaze: z3ed Agent Roadmap</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../yaze.ico"/></td>
  <td id="projectalign">
   <div id="projectname">yaze<span id="projectnumber">&#160;0.3.1</span>
   </div>
   <div id="projectbrief">Link to the Past ROM Editor</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d6/db7/md_docs_2z3ed_2AGENT-ROADMAP.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">z3ed Agent Roadmap</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1131"></a> This document outlines the strategic vision and concrete next steps for the <code>z3ed</code> AI agent, focusing on a transition from a command-line tool to a fully interactive, conversational assistant for ROM hacking.</p>
<h1><a class="anchor" id="autotoc_md1132"></a>
Core Vision: The Conversational ROM Hacking Assistant</h1>
<p>The next evolution of the <code>z3ed</code> agent is to create a chat-like interface where users can interact with the AI in a more natural and exploratory way. Instead of just issuing a single command, users will be able to have a dialogue with the agent to inspect the ROM, ask questions, and iteratively build up a set of changes.</p>
<p>This vision will be realized through a shared interface available in both the <code>z3ed</code> TUI and the main <code>yaze</code> GUI application.</p>
<h2><a class="anchor" id="autotoc_md1133"></a>
Key Features</h2>
<ol type="1">
<li><b>Interactive Chat Interface</b>: A familiar chat window for conversing with the agent.</li>
<li><b>ROM Introspection</b>: The agent will be able to answer questions about the ROM, such as "What dungeons are defined in this project?" or "How many soldiers are in the Hyrule Castle throne room?".</li>
<li><b>Contextual Awareness</b>: The agent will maintain the context of the conversation, allowing for follow-up questions and commands.</li>
<li><b>Seamless Transition to Action</b>: When the user is ready to make a change, the agent will use the conversation history to generate a comprehensive proposal for editing the ROM.</li>
<li><b>Shared Experience</b>: The same conversational agent will be accessible from both the terminal and the graphical user interface, providing a consistent experience.</li>
</ol>
<h1><a class="anchor" id="autotoc_md1134"></a>
Technical Implementation Plan</h1>
<h2><a class="anchor" id="autotoc_md1135"></a>
1. Conversational Agent Service</h2>
<ul>
<li><b>Description</b>: A new service that will manage the back-and-forth between the user and the LLM. It will maintain chat history and orchestrate the agent's different modes (Q&amp;A vs. command generation).</li>
<li><b>Components</b>:<ul>
<li><code>ConversationalAgentService</code>: The main class for managing the chat session.</li>
<li>Integration with existing <code>AIService</code> implementations (Ollama, Gemini).</li>
</ul>
</li>
<li><b>Status</b>: In progress — baseline service exists with chat history, tool loop handling, and structured response parsing. Next up: wiring in live ROM context and richer session state.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1136"></a>
2. Read-Only "Tools" for the Agent</h2>
<ul>
<li><b>Description</b>: To enable the agent to answer questions, we need to expand <code>z3ed</code> with a suite of read-only commands that the LLM can call. This is aligned with the "tool use" or "function calling" capabilities of modern LLMs.</li>
<li><b>Example Tools to Implement</b>:<ul>
<li><code>resource list --type &lt;dungeon|sprite|...&gt;</code>: List all user-defined labels of a certain type.</li>
<li><code>dungeon list-sprites --room &lt;id|label&gt;</code>: List all sprites in a given room.</li>
<li><code>dungeon get-info --room &lt;id|label&gt;</code>: Get metadata for a specific room.</li>
<li><code>overworld find-tile --tile &lt;id&gt;</code>: Find all occurrences of a specific tile on the overworld map.</li>
</ul>
</li>
<li><b>Advanced Editing Tools (for future implementation)</b>:<ul>
<li><code>overworld set-area --map &lt;id&gt; --x &lt;x&gt; --y &lt;y&gt; --width &lt;w&gt; --height &lt;h&gt; --tile &lt;id&gt;</code></li>
<li><code>overworld replace-tile --map &lt;id&gt; --from &lt;old_id&gt; --to &lt;new_id&gt;</code></li>
<li><code>overworld blend-tiles --map &lt;id&gt; --pattern &lt;name&gt; --density &lt;percent&gt;</code></li>
</ul>
</li>
<li><b>Status</b>: Foundational commands (<code>resource-list</code>, <code>dungeon-list-sprites</code>) are live with JSON output. Focus is shifting to high-value Overworld and dialogue inspection tools.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1137"></a>
3. TUI and GUI Chat Interfaces</h2>
<ul>
<li><b>Description</b>: User-facing components for interacting with the <code>ConversationalAgentService</code>.</li>
<li><b>Components</b>:<ul>
<li><b>TUI</b>: A new full-screen component in <code>z3ed</code> using FTXUI, providing a rich chat experience in the terminal.</li>
<li><b>GUI</b>: A new <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> widget that can be docked into the main <code>yaze</code> application window.</li>
</ul>
</li>
<li><b>Status</b>: In progress — CLI/TUI and GUI chat widgets exist, now rendering tables/JSON with readable formatting. Need to improve input ergonomics and synchronized history navigation.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1138"></a>
4. Integration with the Proposal Workflow</h2>
<ul>
<li><b>Description</b>: The final step is to connect the conversation to the action. When a user's prompt implies a desire to modify the ROM (e.g., "Okay, now add two more soldiers"), the <code>ConversationalAgentService</code> will trigger the existing <code>Tile16ProposalGenerator</code> (and future proposal generators for other resource types) to create a proposal.</li>
<li><b>Workflow</b>:<ol type="1">
<li>User chats with the agent to explore the ROM.</li>
<li>User asks the agent to make a change.</li>
<li><code>ConversationalAgentService</code> generates the commands and passes them to the appropriate <code>ProposalGenerator</code>.</li>
<li>A new proposal is created and saved.</li>
<li>The TUI/GUI notifies the user that a proposal is ready for review.</li>
<li>User uses the <code>agent diff</code> and <code>agent accept</code> commands (or UI equivalents) to review and apply the changes.</li>
</ol>
</li>
<li><b>Status</b>: The proposal workflow itself is mostly implemented. This task involves integrating it with the new conversational service.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1139"></a>
Next Steps</h1>
<h2><a class="anchor" id="autotoc_md1140"></a>
Immediate Priorities</h2>
<ol type="1">
<li><b>Expand Overworld Tool Coverage</b>:<ul>
<li>✅ Ship read-only tile searches (<code>overworld find-tile</code>) with shared formatting for CLI and agent calls.</li>
<li>Next: add area summaries, teleport destination lookups, and keep JSON/Text parity for all new tools.</li>
</ul>
</li>
<li><b>Polish the TUI Chat Experience</b>:<ul>
<li>Tighten keyboard shortcuts, scrolling, and copy-to-clipboard behaviour.</li>
<li>Align log file output with on-screen formatting for easier debugging.</li>
</ul>
</li>
<li><b>Integrate Tool Use with LLM</b>:<ul>
<li>Modify the <code>AIService</code> to support function calling/tool use.</li>
<li>Teach the agent to call the new read-only commands to answer questions.</li>
</ul>
</li>
<li><b>Document &amp; Test the New Tooling</b>:<ul>
<li>Update the main <code>README.md</code> and relevant docs to cover the new chat formatting.</li>
<li>Add regression tests (unit or golden JSON fixtures) for the new Overworld tools.</li>
</ul>
</li>
<li><b>Build GUI Chat Widget</b>:<ul>
<li>Create the <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> component.</li>
<li>Ensure it shares the same backend service as the TUI.</li>
</ul>
</li>
<li><b>Full Integration with Proposal System</b>:<ul>
<li>Implement the logic for the agent to transition from conversation to proposal generation.</li>
</ul>
</li>
<li><b>Expand Tool Arsenal</b>:<ul>
<li>Continuously add new read-only commands to give the agent more capabilities to inspect the ROM.</li>
</ul>
</li>
<li><b>Multi-Modal Agent</b>:<ul>
<li>Explore the possibility of the agent generating and displaying images (e.g., a map of a dungeon room) in the chat.</li>
</ul>
</li>
<li><b>Advanced Configuration</b>:<ul>
<li>Implement environment variables for selecting AI providers and models (e.g., <code>YAZE_AI_PROVIDER</code>, <code>OLLAMA_MODEL</code>).</li>
<li>Add CLI flags for overriding the provider and model on a per-command basis.</li>
</ul>
</li>
<li><b>Performance and Cost-Saving</b>:<ul>
<li>Implement a response cache to reduce latency and API costs.</li>
<li>Add token usage tracking and reporting.</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md1141"></a>
Current Status &amp; Next Steps (As of Oct 3, Session 2)</h1>
<p>We have made significant progress in laying the foundation for the conversational agent.</p>
<h2><a class="anchor" id="autotoc_md1142"></a>
✅ Completed</h2>
<ul>
<li><b>Initial <code>ConversationalAgentService</code></b>: The basic service is in place.</li>
<li><b>TUI Chat Stub</b>: A functional <code>agent chat</code> command exists.</li>
<li><b>GUI Chat Widget Stub</b>: An <code>AgentChatWidget</code> is integrated into the main GUI.</li>
<li><b>Initial Agent "Tools"</b>: <code>resource-list</code> and <code>dungeon-list-sprites</code> commands are implemented.</li>
<li><b>Tool Use Foundation</b>: The <code>ToolDispatcher</code> is implemented, and the AI services are aware of the new tool call format.<ul>
<li><b>Tool Loop Improvements</b>: Conversational flow now handles multi-step tool calls with default JSON output, allowing results to feed back into the chat without recursion.</li>
</ul>
</li>
<li><b>Structured Tool Output Rendering</b>: Both the TUI and GUI chat widgets now display tables and JSON payloads with friendly formatting, drastically improving readability.</li>
<li><b>Overworld Inspection Suite</b>: Added <code>overworld describe-map</code> and <code>overworld list-warps</code> commands producing text/JSON summaries for map metadata and warp points, with agent tooling hooks.</li>
<li><b>Overworld Tile Search Tool</b>: Added <code>overworld find-tile</code> across CLI and agent tooling with shared ROM context handling and regression tests.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1143"></a>
🚀 Next Steps</h2>
<ol type="1">
<li><b>Integrate Tool Use with LLM</b>:<ul>
<li>Modify the <code>AIService</code> to support function calling/tool use.</li>
<li>Teach the agent to call the new read-only commands to answer questions.</li>
</ul>
</li>
<li><b>Polish the TUI Chat Experience</b>:<ul>
<li>Tighten keyboard shortcuts, scrolling, and copy-to-clipboard behaviour.</li>
<li>Align log file output with on-screen formatting for easier debugging.</li>
</ul>
</li>
</ol>
<ol type="1">
<li><b>Expand Tool Coverage</b>: Target additional Overworld navigation helpers (region summaries, teleport lookups) and dialogue inspectors. Prioritize commands that unblock common level-design questions and emit concise table/JSON payloads. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
