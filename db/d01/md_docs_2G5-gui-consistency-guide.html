<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>yaze: G5 - GUI Consistency and Card-Based Architecture Guide</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../yaze.ico"/></td>
  <td id="projectalign">
   <div id="projectname">yaze<span id="projectnumber">&#160;0.3.2</span>
   </div>
   <div id="projectbrief">Link to the Past ROM Editor</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('db/d01/md_docs_2G5-gui-consistency-guide.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">G5 - GUI Consistency and Card-Based Architecture Guide</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1405"></a> This guide establishes standards for GUI consistency across all yaze editors, focusing on the modern card-based architecture, theming system, and layout patterns.</p>
<h1><a class="anchor" id="autotoc_md1406"></a>
Table of Contents</h1>
<ol type="1">
<li>Introduction</li>
<li>Card-Based Architecture</li>
<li>VSCode-Style Sidebar System</li>
<li>Toolset System</li>
<li>GUI Library Architecture</li>
<li>Themed Widget System</li>
<li>Begin/End Patterns</li>
<li>Currently Integrated Editors</li>
<li>Layout Helpers</li>
<li>Workspace Management</li>
<li>Future Editor Improvements</li>
<li>Migration Checklist</li>
<li>Code Examples</li>
<li>Common Pitfalls</li>
</ol>
<h1><a class="anchor" id="autotoc_md1407"></a>
1. Introduction</h1>
<h2><a class="anchor" id="autotoc_md1408"></a>
Purpose</h2>
<p>This guide establishes GUI consistency standards to ensure all editors in yaze provide a unified, modern user experience with maintainable code. The card-based architecture allows editors to present multiple independent windows that can be opened, closed, minimized, and managed independently.</p>
<h2><a class="anchor" id="autotoc_md1409"></a>
Benefits</h2>
<ul>
<li><b>User Experience</b>: Consistent keyboard shortcuts, visual styling, and interaction patterns</li>
<li><b>Maintainability</b>: Reusable components reduce duplication and bugs</li>
<li><b>Modularity</b>: Independent cards can be developed and tested separately</li>
<li><b>Flexibility</b>: Users can arrange their workspace as needed</li>
<li><b>Discoverability</b>: Central EditorCardManager makes all features accessible</li>
</ul>
<h2><a class="anchor" id="autotoc_md1410"></a>
Target Audience</h2>
<p>Contributors working on:</p><ul>
<li>New editor implementations</li>
<li>Refactoring existing editors</li>
<li>Adding new UI features to editors</li>
<li>Improving user experience consistency</li>
</ul>
<h1><a class="anchor" id="autotoc_md1411"></a>
2. Card-Based Architecture</h1>
<h2><a class="anchor" id="autotoc_md1412"></a>
Philosophy</h2>
<p>Modern yaze editors use <b>independent, modular windows</b> called "cards" rather than traditional tab-based or fixed-layout UIs. Each card:</p>
<ul>
<li>Is a top-level <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> window (not a child window)</li>
<li>Can be opened/closed independently via keyboard shortcuts</li>
<li>Can be minimized to a floating icon</li>
<li>Registers with <code>EditorCardManager</code> for centralized control</li>
<li>Has its own visibility flag synchronized with the manager</li>
</ul>
<h2><a class="anchor" id="autotoc_md1413"></a>
Core Components</h2>
<h3><a class="anchor" id="autotoc_md1414"></a>
EditorCardManager</h3>
<p>Central singleton registry for all editor cards across the application.</p>
<p><b>Key Features:</b></p><ul>
<li>Global card registration with metadata</li>
<li>Keyboard shortcut management</li>
<li>View menu integration</li>
<li>Workspace preset system</li>
<li>Programmatic card control</li>
</ul>
<p><b>Registration Example:</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> MyEditor::Initialize() {</div>
<div class="line">  <span class="keyword">auto</span>&amp; card_manager = gui::EditorCardManager::Get();</div>
<div class="line"> </div>
<div class="line">  card_manager.RegisterCard({</div>
<div class="line">      .card_id = <span class="stringliteral">&quot;myeditor.control_panel&quot;</span>,</div>
<div class="line">      .display_name = <span class="stringliteral">&quot;My Editor Controls&quot;</span>,</div>
<div class="line">      .icon = <a class="code hl_define" href="../../de/dbf/icons_8h.html#a14ded7148bef481ff6b688f261157597">ICON_MD_SETTINGS</a>,</div>
<div class="line">      .category = <span class="stringliteral">&quot;MyEditor&quot;</span>,</div>
<div class="line">      .shortcut_hint = <span class="stringliteral">&quot;Ctrl+Shift+M&quot;</span>,</div>
<div class="line">      .visibility_flag = &amp;show_control_panel_,</div>
<div class="line">      .priority = 10</div>
<div class="line">  });</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Register more cards...</span></div>
<div class="line">}</div>
<div class="ttc" id="aicons_8h_html_a14ded7148bef481ff6b688f261157597"><div class="ttname"><a href="../../de/dbf/icons_8h.html#a14ded7148bef481ff6b688f261157597">ICON_MD_SETTINGS</a></div><div class="ttdeci">#define ICON_MD_SETTINGS</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l01697">icons.h:1697</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1415"></a>
EditorCard</h3>
<p>Wrapper class for individual card windows with Begin/End pattern.</p>
<p><b>Key Features:</b></p><ul>
<li>Automatic positioning (Right, Left, Bottom, Floating, Free)</li>
<li>Default size management</li>
<li>Minimize/maximize support</li>
<li>Focus management</li>
<li>Docking control</li>
</ul>
<p><b>Usage Pattern:</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> MyEditor::DrawMyCard() {</div>
<div class="line">  gui::EditorCard card(<span class="stringliteral">&quot;Card Title&quot;</span>, ICON_MD_ICON, &amp;show_card_);</div>
<div class="line">  card.SetDefaultSize(400, 300);</div>
<div class="line">  card.SetPosition(gui::EditorCard::Position::Right);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (card.Begin(&amp;show_card_)) {</div>
<div class="line">    <span class="comment">// Draw card content here</span></div>
<div class="line">    ImGui::Text(<span class="stringliteral">&quot;Card content&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  card.End();</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1416"></a>
Centralized Visibility Pattern</h2>
<p>All editors now use the centralized visibility system where EditorCardManager owns and manages all visibility bools:</p>
<div class="fragment"><div class="line"><span class="comment">// Registration (in Initialize()):</span></div>
<div class="line">card_manager.RegisterCard({</div>
<div class="line">    .card_id = <span class="stringliteral">&quot;music.tracker&quot;</span>,</div>
<div class="line">    .display_name = <span class="stringliteral">&quot;Music Tracker&quot;</span>,</div>
<div class="line">    .icon = <a class="code hl_define" href="../../de/dbf/icons_8h.html#a7ff6da7cb09a3ff0031ab47a4fcc0c71">ICON_MD_MUSIC_NOTE</a>,</div>
<div class="line">    .category = <span class="stringliteral">&quot;Music&quot;</span></div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Usage (in Update()):</span></div>
<div class="line"><span class="keyword">static</span> gui::EditorCard card(<span class="stringliteral">&quot;Music Tracker&quot;</span>, <a class="code hl_define" href="../../de/dbf/icons_8h.html#a7ff6da7cb09a3ff0031ab47a4fcc0c71">ICON_MD_MUSIC_NOTE</a>);</div>
<div class="line"><span class="keywordflow">if</span> (card.Begin(card_manager.GetVisibilityFlag(<span class="stringliteral">&quot;music.tracker&quot;</span>))) {</div>
<div class="line">    DrawContent();</div>
<div class="line">    card.End();</div>
<div class="line">}</div>
<div class="ttc" id="aicons_8h_html_a7ff6da7cb09a3ff0031ab47a4fcc0c71"><div class="ttname"><a href="../../de/dbf/icons_8h.html#a7ff6da7cb09a3ff0031ab47a4fcc0c71">ICON_MD_MUSIC_NOTE</a></div><div class="ttdeci">#define ICON_MD_MUSIC_NOTE</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l01262">icons.h:1262</a></div></div>
</div><!-- fragment --><p><b>Benefits:</b></p><ul>
<li>Single source of truth for all card visibility</li>
<li>No scattered bool members in editor classes</li>
<li>Automatic X button close functionality</li>
<li>Consistent behavior across all cards</li>
<li>Easy to query/modify from anywhere</li>
</ul>
<h2><a class="anchor" id="autotoc_md1417"></a>
Reference Implementations</h2>
<p><b>Best Examples:</b></p><ul>
<li><code><a class="el" href="../../d0/d0d/dungeon__editor__v2_8cc.html">src/app/editor/dungeon/dungeon_editor_v2.cc</a></code> - Gold standard implementation</li>
<li><code><a class="el" href="../../dc/d3a/app_2editor_2palette_2palette__editor_8cc.html">src/app/editor/palette/palette_editor.cc</a></code> - Recently refactored, clean patterns</li>
</ul>
<p><b>Key Patterns from Dungeon Editor v2:</b></p><ul>
<li>Independent top-level cards (no parent wrapper)</li>
<li>Control panel with minimize-to-icon</li>
<li>Toolset integration</li>
<li>Proper card registration with shortcuts</li>
<li>Room cards in separate docking class</li>
</ul>
<h1><a class="anchor" id="autotoc_md1418"></a>
3. VSCode-Style Sidebar System</h1>
<h2><a class="anchor" id="autotoc_md1419"></a>
Overview</h2>
<p>The VSCode-style sidebar provides a unified interface for managing editor cards. It's a fixed 48px sidebar on the left edge with icon-based card toggles.</p>
<p><b>Key Features:</b></p><ul>
<li>Fixed position on left edge (48px width)</li>
<li>Icon-based card toggles</li>
<li>Category switcher for multi-editor sessions</li>
<li>Card browser button (Ctrl+Shift+B)</li>
<li>Collapse button (Ctrl+B)</li>
<li>Theme-aware styling</li>
<li>Recent categories stack (last 5 used)</li>
</ul>
<h2><a class="anchor" id="autotoc_md1420"></a>
Usage</h2>
<p>Each card-based editor simply calls:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyEditor::DrawToolset() {</div>
<div class="line">  <span class="keyword">auto</span>&amp; card_manager = gui::EditorCardManager::Get();</div>
<div class="line">  card_manager.DrawSidebar(<span class="stringliteral">&quot;MyEditor&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The sidebar automatically reads from the existing card registry - no per-editor configuration needed.</p>
<h2><a class="anchor" id="autotoc_md1421"></a>
Card Browser</h2>
<p>Press <code>Ctrl+Shift+B</code> to open the card browser:</p><ul>
<li>Search/filter cards by name</li>
<li>Category tabs</li>
<li>Visibility toggle for all cards</li>
<li>Statistics (total/visible cards)</li>
<li>Preset management</li>
<li>Batch operations (Show All, Hide All per category)</li>
</ul>
<h1><a class="anchor" id="autotoc_md1422"></a>
4. Toolset System</h1>
<h2><a class="anchor" id="autotoc_md1423"></a>
Overview</h2>
<p><code>gui::Toolset</code> provides an ultra-compact toolbar that merges mode buttons with inline settings. It's designed for minimal vertical space usage while maximizing functionality.</p>
<p><b>Design Philosophy:</b></p><ul>
<li>Single horizontal bar with everything inline</li>
<li>Small icon-only buttons for modes</li>
<li>Inline property editing (InputHex with scroll)</li>
<li>Vertical separators for visual grouping</li>
<li>No wasted space</li>
</ul>
<h2><a class="anchor" id="autotoc_md1424"></a>
Basic Usage</h2>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyEditor::DrawToolset() {</div>
<div class="line">  <span class="keyword">static</span> gui::Toolset toolbar;</div>
<div class="line">  toolbar.Begin();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add toggle buttons for cards</span></div>
<div class="line">  <span class="keywordflow">if</span> (toolbar.AddToggle(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a8a19ab9cdceeeda80823c1fd98867a77">ICON_MD_LIST</a>, &amp;show_list_, <span class="stringliteral">&quot;Show List (Ctrl+1)&quot;</span>)) {</div>
<div class="line">    <span class="comment">// Optional: React to toggle</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (toolbar.AddToggle(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a02efd072d0b725a38998bb0824c6dcd0">ICON_MD_GRID_VIEW</a>, &amp;show_grid_, <span class="stringliteral">&quot;Show Grid (Ctrl+2)&quot;</span>)) {</div>
<div class="line">    <span class="comment">// Toggled</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  toolbar.AddSeparator();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add action buttons</span></div>
<div class="line">  <span class="keywordflow">if</span> (toolbar.AddAction(<a class="code hl_define" href="../../de/dbf/icons_8h.html#acbbc3590e0cc448734c935ed0f31a6b2">ICON_MD_SAVE</a>, <span class="stringliteral">&quot;Save All&quot;</span>)) {</div>
<div class="line">    SaveAllChanges();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (toolbar.AddAction(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a5921579d0045db598703371c5a9b54a6">ICON_MD_REFRESH</a>, <span class="stringliteral">&quot;Reload&quot;</span>)) {</div>
<div class="line">    ReloadData();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  toolbar.End();</div>
<div class="line">}</div>
<div class="ttc" id="aicons_8h_html_a02efd072d0b725a38998bb0824c6dcd0"><div class="ttname"><a href="../../de/dbf/icons_8h.html#a02efd072d0b725a38998bb0824c6dcd0">ICON_MD_GRID_VIEW</a></div><div class="ttdeci">#define ICON_MD_GRID_VIEW</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l00895">icons.h:895</a></div></div>
<div class="ttc" id="aicons_8h_html_a5921579d0045db598703371c5a9b54a6"><div class="ttname"><a href="../../de/dbf/icons_8h.html#a5921579d0045db598703371c5a9b54a6">ICON_MD_REFRESH</a></div><div class="ttdeci">#define ICON_MD_REFRESH</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l01570">icons.h:1570</a></div></div>
<div class="ttc" id="aicons_8h_html_a8a19ab9cdceeeda80823c1fd98867a77"><div class="ttname"><a href="../../de/dbf/icons_8h.html#a8a19ab9cdceeeda80823c1fd98867a77">ICON_MD_LIST</a></div><div class="ttdeci">#define ICON_MD_LIST</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l01092">icons.h:1092</a></div></div>
<div class="ttc" id="aicons_8h_html_acbbc3590e0cc448734c935ed0f31a6b2"><div class="ttname"><a href="../../de/dbf/icons_8h.html#acbbc3590e0cc448734c935ed0f31a6b2">ICON_MD_SAVE</a></div><div class="ttdeci">#define ICON_MD_SAVE</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l01642">icons.h:1642</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1425"></a>
Advanced Features</h2>
<p><b>Inline Property Editing:</b> </p><div class="fragment"><div class="line"><span class="comment">// Hex properties with scroll wheel support</span></div>
<div class="line">toolbar.AddProperty(<a class="code hl_define" href="../../de/dbf/icons_8h.html#ad6ecee664ddafe14f73868b7a5ec8a01">ICON_MD_PALETTE</a>, <span class="stringliteral">&quot;Palette&quot;</span>, &amp;palette_id_,</div>
<div class="line">                   []() { OnPaletteChanged(); });</div>
<div class="line"> </div>
<div class="line">toolbar.AddProperty(<a class="code hl_define" href="../../de/dbf/icons_8h.html#ab5285341bfdd1ebbc5ec239bde9e66bc">ICON_MD_IMAGE</a>, <span class="stringliteral">&quot;GFX&quot;</span>, &amp;gfx_id_,</div>
<div class="line">                   []() { OnGfxChanged(); });</div>
<div class="ttc" id="aicons_8h_html_ab5285341bfdd1ebbc5ec239bde9e66bc"><div class="ttname"><a href="../../de/dbf/icons_8h.html#ab5285341bfdd1ebbc5ec239bde9e66bc">ICON_MD_IMAGE</a></div><div class="ttdeci">#define ICON_MD_IMAGE</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l00980">icons.h:980</a></div></div>
<div class="ttc" id="aicons_8h_html_ad6ecee664ddafe14f73868b7a5ec8a01"><div class="ttname"><a href="../../de/dbf/icons_8h.html#ad6ecee664ddafe14f73868b7a5ec8a01">ICON_MD_PALETTE</a></div><div class="ttdeci">#define ICON_MD_PALETTE</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l01368">icons.h:1368</a></div></div>
</div><!-- fragment --><p><b>Mode Button Groups:</b> </p><div class="fragment"><div class="line">toolbar.BeginModeGroup();</div>
<div class="line"><span class="keywordtype">bool</span> draw_mode = toolbar.ModeButton(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a53990b2049bbd408f3d2c5b43a20b80b">ICON_MD_BRUSH</a>, mode_ == Mode::Draw, <span class="stringliteral">&quot;Draw&quot;</span>);</div>
<div class="line"><span class="keywordtype">bool</span> erase_mode = toolbar.ModeButton(<a class="code hl_define" href="../../de/dbf/icons_8h.html#acfe2e24609756c3e475d0f9517181d2d">ICON_MD_DELETE</a>, mode_ == Mode::Erase, <span class="stringliteral">&quot;Erase&quot;</span>);</div>
<div class="line"><span class="keywordtype">bool</span> select_mode = toolbar.ModeButton(ICON_MD_SELECT, mode_ == Mode::Select, <span class="stringliteral">&quot;Select&quot;</span>);</div>
<div class="line">toolbar.EndModeGroup();</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (draw_mode) mode_ = Mode::Draw;</div>
<div class="line"><span class="keywordflow">if</span> (erase_mode) mode_ = Mode::Erase;</div>
<div class="line"><span class="keywordflow">if</span> (select_mode) mode_ = Mode::Select;</div>
<div class="ttc" id="aicons_8h_html_a53990b2049bbd408f3d2c5b43a20b80b"><div class="ttname"><a href="../../de/dbf/icons_8h.html#a53990b2049bbd408f3d2c5b43a20b80b">ICON_MD_BRUSH</a></div><div class="ttdeci">#define ICON_MD_BRUSH</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l00323">icons.h:323</a></div></div>
<div class="ttc" id="aicons_8h_html_acfe2e24609756c3e475d0f9517181d2d"><div class="ttname"><a href="../../de/dbf/icons_8h.html#acfe2e24609756c3e475d0f9517181d2d">ICON_MD_DELETE</a></div><div class="ttdeci">#define ICON_MD_DELETE</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l00528">icons.h:528</a></div></div>
</div><!-- fragment --><p><b>Version Badges:</b> </p><div class="fragment"><div class="line"><span class="comment">// For ROM version indicators</span></div>
<div class="line">toolbar.AddRomBadge(rom_-&gt;asm_version(), []() {</div>
<div class="line">  ShowUpgradeDialog();</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">toolbar.AddV3StatusBadge(rom_-&gt;asm_version(), []() {</div>
<div class="line">  ShowV3Settings();</div>
<div class="line">});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1426"></a>
Best Practices</h2>
<ol type="1">
<li><b>Keep it compact</b>: Only essential controls belong in the Toolset</li>
<li><b>Use icons</b>: Prefer icon-only buttons with tooltips</li>
<li><b>Group logically</b>: Use separators to group related controls</li>
<li><b>Provide shortcuts</b>: Include keyboard shortcuts in tooltips</li>
<li><b>Consistent ordering</b>: Toggles first, properties second, actions third</li>
</ol>
<h1><a class="anchor" id="autotoc_md1427"></a>
5. GUI Library Architecture</h1>
<h2><a class="anchor" id="autotoc_md1428"></a>
Modular Library Structure</h2>
<p>The yaze GUI is organized into focused, layered libraries for improved build times and maintainability:</p>
<p><b>gui_core (Foundation)</b></p><ul>
<li>Theme management, colors, styling</li>
<li>Icons, input handling, layout helpers</li>
<li>Dependencies: yaze_util, <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a>, SDL2</li>
</ul>
<p><b>canvas (Core Widget)</b></p><ul>
<li>Canvas widget system</li>
<li>Canvas utilities, modals, context menus</li>
<li>Dependencies: gui_core, yaze_gfx</li>
</ul>
<p><b>gui_widgets (Reusable Components)</b></p><ul>
<li>Themed widgets, palette widgets</li>
<li>Asset browser, text editor, tile selector</li>
<li>Dependencies: gui_core, yaze_gfx</li>
</ul>
<p><b>gui_automation (Testing &amp; AI)</b></p><ul>
<li>Widget ID registry, auto-registration</li>
<li>Widget state capture and measurement</li>
<li>Dependencies: gui_core</li>
</ul>
<p><b>gui_app (Application-Specific UI)</b></p><ul>
<li>EditorCardManager, EditorLayout</li>
<li>Background renderer, collaboration panel</li>
<li>Dependencies: gui_core, gui_widgets, gui_automation</li>
</ul>
<p><b>yaze_gui (Interface Library)</b></p><ul>
<li>Aggregates all sub-libraries</li>
<li>Single link target for executables</li>
</ul>
<h2><a class="anchor" id="autotoc_md1429"></a>
Theme-Aware Sizing System</h2>
<p>All UI sizing respects the theme's <code>compact_factor</code> (0.8-1.2) for global density control:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;app/gui/layout_helpers.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>gui::LayoutHelpers;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Standard widget sizing</span></div>
<div class="line"><span class="keywordtype">float</span> widget_height = LayoutHelpers::GetStandardWidgetHeight();</div>
<div class="line"><span class="keywordtype">float</span> spacing = LayoutHelpers::GetStandardSpacing();</div>
<div class="line"><span class="keywordtype">float</span> toolbar_height = LayoutHelpers::GetToolbarHeight();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// All sizing respects: theme.compact_factor * multiplier * ImGui::GetFontSize()</span></div>
</div><!-- fragment --><p><b>Layout Helpers API:</b></p><ul>
<li><code>BeginTableWithTheming()</code> - Tables with automatic theme colors</li>
<li><code>BeginCanvasPanel() / EndCanvasPanel()</code> - Canvas containers</li>
<li><code>BeginPaddedPanel() / EndPaddedPanel()</code> - Consistent padding</li>
<li><code>InputHexRow()</code> - Labeled hex inputs</li>
<li><code>BeginPropertyGrid() / EndPropertyGrid()</code> - 2-column property tables</li>
<li><code>PropertyRow()</code> - Label + widget in table row</li>
<li><code>SectionHeader()</code> - Colored section headers</li>
<li><code>HelpMarker()</code> - Tooltip help icons</li>
</ul>
<h1><a class="anchor" id="autotoc_md1430"></a>
6. Themed Widget System</h1>
<h2><a class="anchor" id="autotoc_md1431"></a>
Philosophy</h2>
<p><b>Never use hardcoded colors.</b> All UI elements must derive colors from the central theme system to ensure consistency and support for future dark/light theme switching.</p>
<h2><a class="anchor" id="autotoc_md1432"></a>
Themed Widget Prefixes</h2>
<p>All theme-aware widgets are prefixed with <code>Themed*</code>:</p>
<p><b>Available Widgets:</b></p><ul>
<li><code>ThemedButton()</code> - Standard button with theme colors</li>
<li><code>ThemedIconButton()</code> - Icon-only button</li>
<li><code>PrimaryButton()</code> - Emphasized primary action (e.g., Save)</li>
<li><code>DangerButton()</code> - Dangerous action (e.g., Delete, Discard)</li>
<li><code>SectionHeader()</code> - Visual section divider with text</li>
</ul>
<h2><a class="anchor" id="autotoc_md1433"></a>
Usage Examples</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;app/gui/core/themed_widgets.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>gui::ThemedButton;</div>
<div class="line"><span class="keyword">using </span>gui::ThemedIconButton;</div>
<div class="line"><span class="keyword">using </span>gui::PrimaryButton;</div>
<div class="line"><span class="keyword">using </span>gui::DangerButton;</div>
<div class="line"><span class="keyword">using </span>gui::SectionHeader;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> MyCard::DrawContent() {</div>
<div class="line">  SectionHeader(<span class="stringliteral">&quot;Settings&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (PrimaryButton(<span class="stringliteral">&quot;Save Changes&quot;</span>, ImVec2(-1, 0))) {</div>
<div class="line">    SaveToRom();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (DangerButton(<span class="stringliteral">&quot;Discard All&quot;</span>, ImVec2(-1, 0))) {</div>
<div class="line">    DiscardChanges();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  ImGui::Separator();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#a5fa374aea4d5d783b38f9fc32e937eb0">SectionHeader</a>(<span class="stringliteral">&quot;Quick Actions&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#af838352fb69ef974c47008f982b42213">ThemedIconButton</a>(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a5921579d0045db598703371c5a9b54a6">ICON_MD_REFRESH</a>, <span class="stringliteral">&quot;Reload&quot;</span>)) {</div>
<div class="line">    Reload();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  ImGui::SameLine();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#af838352fb69ef974c47008f982b42213">ThemedIconButton</a>(ICON_MD_COPY, <span class="stringliteral">&quot;Duplicate&quot;</span>)) {</div>
<div class="line">    Duplicate();</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceyaze_1_1gui_html_a5fa374aea4d5d783b38f9fc32e937eb0"><div class="ttname"><a href="../../d3/dbf/namespaceyaze_1_1gui.html#a5fa374aea4d5d783b38f9fc32e937eb0">yaze::gui::SectionHeader</a></div><div class="ttdeci">void SectionHeader(const char *icon, const char *label, const ImVec4 &amp;color)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dfa/ui__helpers_8cc_source.html#l00155">ui_helpers.cc:155</a></div></div>
<div class="ttc" id="anamespaceyaze_1_1gui_html_af838352fb69ef974c47008f982b42213"><div class="ttname"><a href="../../d3/dbf/namespaceyaze_1_1gui.html#af838352fb69ef974c47008f982b42213">yaze::gui::ThemedIconButton</a></div><div class="ttdeci">bool ThemedIconButton(const char *icon, const char *tooltip)</div><div class="ttdoc">Themed button with icon (Material Design Icons)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d03/themed__widgets_8cc_source.html#l00025">themed_widgets.cc:25</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1434"></a>
Theme Colors</h2>
<p>Access theme colors via <code>AgentUITheme</code> (despite the name, it's used project-wide):</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d3/d4c/agent__ui__theme_8h.html">app/editor/agent/agent_ui_theme.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> DrawCustomUI() {</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; theme = AgentUI::GetTheme();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Use semantic colors</span></div>
<div class="line">  ImGui::PushStyleColor(ImGuiCol_ChildBg, theme.panel_bg_color);</div>
<div class="line">  ImGui::PushStyleColor(ImGuiCol_Text, theme.text_color);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Draw content</span></div>
<div class="line">  ImGui::BeginChild(<span class="stringliteral">&quot;MyPanel&quot;</span>);</div>
<div class="line">  ImGui::Text(<span class="stringliteral">&quot;Themed panel content&quot;</span>);</div>
<div class="line">  ImGui::EndChild();</div>
<div class="line"> </div>
<div class="line">  ImGui::PopStyleColor(2);</div>
<div class="line">}</div>
<div class="ttc" id="aagent__ui__theme_8h_html"><div class="ttname"><a href="../../d3/d4c/agent__ui__theme_8h.html">agent_ui_theme.h</a></div></div>
</div><!-- fragment --><p><b>Common Theme Colors:</b></p><ul>
<li><code>panel_bg_color</code> - Background for panels</li>
<li><code>text_color</code> - Primary text</li>
<li><code>text_dim_color</code> - Secondary/disabled text</li>
<li><code>accent_color</code> - Highlights and accents</li>
<li><code>status_success</code> - Success indicators (green)</li>
<li><code>status_warning</code> - Warning indicators (yellow)</li>
<li><code>status_error</code> - Error indicators (red)</li>
</ul>
<h2><a class="anchor" id="autotoc_md1435"></a>
Migration from Hardcoded Colors</h2>
<p><b>Before (Bad):</b> </p><div class="fragment"><div class="line">ImGui::PushStyleColor(ImGuiCol_ChildBg, ImVec4(0.2f, 0.2f, 0.25f, 1.0f));</div>
<div class="line">ImGui::TextColored(ImVec4(1.0f, 0.0f, 0.0f, 1.0f), <span class="stringliteral">&quot;Error!&quot;</span>);</div>
</div><!-- fragment --><p><b>After (Good):</b> </p><div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">auto</span>&amp; theme = AgentUI::GetTheme();</div>
<div class="line">ImGui::PushStyleColor(ImGuiCol_ChildBg, theme.panel_bg_color);</div>
<div class="line">ImGui::TextColored(theme.status_error, <span class="stringliteral">&quot;Error!&quot;</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1436"></a>
WhichKey Command System</h2>
<p>Spacemacs-style hierarchical command navigation:</p>
<div class="fragment"><div class="line"><span class="comment">// Press Space → Shows root menu with colored categories</span></div>
<div class="line"><span class="comment">// Press category key (e.g., w) → Shows window submenu</span></div>
<div class="line"><span class="comment">// Press command key → Executes command and closes</span></div>
<div class="line"><span class="comment">// Press ESC → Go back or close</span></div>
</div><!-- fragment --><p><b>Features:</b></p><ul>
<li>Fixed bottom bar (150px height)</li>
<li>Color-coded categories</li>
<li>Breadcrumb navigation ("Space &gt; w")</li>
<li>Auto-close after 5 seconds of inactivity</li>
</ul>
<p><b>Integration:</b> </p><div class="fragment"><div class="line">command_manager_.RegisterPrefix(<span class="stringliteral">&quot;w&quot;</span>, <span class="charliteral">&#39;w&#39;</span>, <span class="stringliteral">&quot;Window&quot;</span>, <span class="stringliteral">&quot;Window management&quot;</span>);</div>
<div class="line">command_manager_.RegisterSubcommand(<span class="stringliteral">&quot;w&quot;</span>, <span class="stringliteral">&quot;w.s&quot;</span>, <span class="charliteral">&#39;s&#39;</span>, <span class="stringliteral">&quot;Show All&quot;</span>, <span class="stringliteral">&quot;Show all windows&quot;</span>,</div>
<div class="line">    [<span class="keyword">this</span>]() { workspace_manager_.ShowAllWindows(); });</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1437"></a>
7. Begin/End Patterns</h1>
<h2><a class="anchor" id="autotoc_md1438"></a>
Philosophy</h2>
<p>All resource-managing UI elements use the Begin/End pattern for RAII-style cleanup. This prevents resource leaks and ensures proper <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> state management.</p>
<h2><a class="anchor" id="autotoc_md1439"></a>
EditorCard Begin/End</h2>
<p><b>Pattern:</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> DrawMyCard() {</div>
<div class="line">  gui::EditorCard card(<span class="stringliteral">&quot;Title&quot;</span>, ICON_MD_ICON, &amp;show_flag_);</div>
<div class="line">  card.SetDefaultSize(400, 300);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Begin returns false if window is collapsed/hidden</span></div>
<div class="line">  <span class="keywordflow">if</span> (card.Begin(&amp;show_flag_)) {</div>
<div class="line">    <span class="comment">// Draw content only when visible</span></div>
<div class="line">    DrawCardContent();</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// End MUST be called regardless of Begin result</span></div>
<div class="line">  card.End();</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Critical Rules:</b></p><ol type="1">
<li>Always call <code>End()</code> even if <code>Begin()</code> returns false</li>
<li>Put Begin/End calls in same scope for exception safety</li>
<li>Check Begin() return value before expensive drawing</li>
<li>Pass <code>p_open</code> to both constructor and Begin() for proper close button handling</li>
</ol>
<h2><a class="anchor" id="autotoc_md1440"></a>
ImGui Native Begin/End</h2>
<p><b>Window Pattern:</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> DrawWindow() {</div>
<div class="line">  ImGui::SetNextWindowSize(ImVec2(400, 300), ImGuiCond_FirstUseEver);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (ImGui::Begin(<span class="stringliteral">&quot;Window Title&quot;</span>, &amp;show_window_)) {</div>
<div class="line">    <span class="comment">// Draw window content</span></div>
<div class="line">    ImGui::Text(<span class="stringliteral">&quot;Content&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  ImGui::End();  <span class="comment">// ALWAYS call, even if Begin returns false</span></div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Table Pattern:</b> </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (ImGui::BeginTable(<span class="stringliteral">&quot;##MyTable&quot;</span>, 3, ImGuiTableFlags_Borders)) {</div>
<div class="line">  ImGui::TableSetupColumn(<span class="stringliteral">&quot;Column 1&quot;</span>);</div>
<div class="line">  ImGui::TableSetupColumn(<span class="stringliteral">&quot;Column 2&quot;</span>);</div>
<div class="line">  ImGui::TableSetupColumn(<span class="stringliteral">&quot;Column 3&quot;</span>);</div>
<div class="line">  ImGui::TableHeadersRow();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; 10; row++) {</div>
<div class="line">    ImGui::TableNextRow();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; 3; col++) {</div>
<div class="line">      ImGui::TableNextColumn();</div>
<div class="line">      ImGui::Text(<span class="stringliteral">&quot;Cell %d,%d&quot;</span>, row, col);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  ImGui::EndTable();</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Child Window Pattern:</b> </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (ImGui::BeginChild(<span class="stringliteral">&quot;##ScrollRegion&quot;</span>, ImVec2(0, 200), <span class="keyword">true</span>)) {</div>
<div class="line">  <span class="comment">// Scrollable content</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 100; i++) {</div>
<div class="line">    ImGui::Text(<span class="stringliteral">&quot;Item %d&quot;</span>, i);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line">ImGui::EndChild();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1441"></a>
Toolset Begin/End</h2>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> DrawToolbar() {</div>
<div class="line">  <span class="keyword">static</span> gui::Toolset toolbar;</div>
<div class="line"> </div>
<div class="line">  toolbar.Begin();</div>
<div class="line">  <span class="comment">// Add toolbar items</span></div>
<div class="line">  toolbar.AddToggle(ICON_MD_ICON, &amp;flag_, <span class="stringliteral">&quot;Tooltip&quot;</span>);</div>
<div class="line">  toolbar.End();  <span class="comment">// Finalizes layout</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1442"></a>
Error Handling</h2>
<p><b>With Status Returns:</b> </p><div class="fragment"><div class="line">absl::Status DrawEditor() {</div>
<div class="line">  gui::EditorCard card(<span class="stringliteral">&quot;Editor&quot;</span>, <a class="code hl_define" href="../../de/dbf/icons_8h.html#a731bc03bc277fde24e1c99c9b0d5541b">ICON_MD_EDIT</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (card.Begin()) {</div>
<div class="line">    <a class="code hl_define" href="../../d4/d9e/macro_8h.html#a755e0e0d964b4d81ae730d174c5fa3ce">RETURN_IF_ERROR</a>(DrawContent());  <span class="comment">// Can early return</span></div>
<div class="line">  }</div>
<div class="line">  card.End();  <span class="comment">// Still called via normal flow</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> absl::OkStatus();</div>
<div class="line">}</div>
<div class="ttc" id="aicons_8h_html_a731bc03bc277fde24e1c99c9b0d5541b"><div class="ttname"><a href="../../de/dbf/icons_8h.html#a731bc03bc277fde24e1c99c9b0d5541b">ICON_MD_EDIT</a></div><div class="ttdeci">#define ICON_MD_EDIT</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l00643">icons.h:643</a></div></div>
<div class="ttc" id="amacro_8h_html_a755e0e0d964b4d81ae730d174c5fa3ce"><div class="ttname"><a href="../../d4/d9e/macro_8h.html#a755e0e0d964b4d81ae730d174c5fa3ce">RETURN_IF_ERROR</a></div><div class="ttdeci">#define RETURN_IF_ERROR(expression)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d9e/macro_8h_source.html#l00053">macro.h:53</a></div></div>
</div><!-- fragment --><p><b>Exception Safety:</b> </p><div class="fragment"><div class="line"><span class="comment">// If exceptions are enabled, use RAII wrappers</span></div>
<div class="line"><span class="keyword">struct </span>ScopedCard {</div>
<div class="line">  gui::EditorCard&amp; card;</div>
<div class="line">  <span class="keyword">explicit</span> ScopedCard(gui::EditorCard&amp; c) : card(c) { card.Begin(); }</div>
<div class="line">  ~ScopedCard() { card.End(); }</div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1443"></a>
8. Currently Integrated Editors</h1>
<p>The card system is integrated across 11 of 13 editors:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Editor   </th><th class="markdownTableHeadNone">Cards   </th><th class="markdownTableHeadNone">Status    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>DungeonEditorV2</b>   </td><td class="markdownTableBodyNone">Room selector, canvas, object selector, object editor, entrance editor, tile painter, sprite placer   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>PaletteEditor</b>   </td><td class="markdownTableBodyNone">Group editor, animation editor, color picker   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>GraphicsEditor</b>   </td><td class="markdownTableBodyNone">Sheet editor, browser, player animations, prototype viewer   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>ScreenEditor</b>   </td><td class="markdownTableBodyNone">Dungeon maps, inventory, overworld map, title screen, naming screen   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>SpriteEditor</b>   </td><td class="markdownTableBodyNone">Vanilla sprites, custom sprites   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>OverworldEditor</b>   </td><td class="markdownTableBodyNone">Canvas, tile16/tile8 selectors, area graphics, scratch workspace, GFX groups, usage stats, properties, exits, items, sprites, settings   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>MessageEditor</b>   </td><td class="markdownTableBodyNone">Message list, editor, font atlas, dictionary   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>HexEditor</b>   </td><td class="markdownTableBodyNone">Hex editor with comparison   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>AssemblyEditor</b>   </td><td class="markdownTableBodyNone">Assembly editor, file browser   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>MusicEditor</b>   </td><td class="markdownTableBodyNone">Music tracker, instrument editor, assembly view   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Emulator</b>   </td><td class="markdownTableBodyNone">CPU debugger, PPU viewer, memory viewer, breakpoints, performance, AI agent, save states, keyboard config, APU debugger, audio mixer   </td><td class="markdownTableBodyNone">Complete   </td></tr>
</table>
<p><b>Not Yet Ported:</b></p><ul>
<li><b>SettingsEditor</b> - Monolithic settings window, low usage frequency</li>
<li><b>AgentEditor</b> - Complex AI agent UI, under active development</li>
</ul>
<h1><a class="anchor" id="autotoc_md1444"></a>
9. Layout Helpers</h1>
<h2><a class="anchor" id="autotoc_md1445"></a>
Overview</h2>
<p><code>app/gui/layout_helpers.h</code> provides utilities for consistent spacing, sizing, and layout across all editors.</p>
<h2><a class="anchor" id="autotoc_md1446"></a>
Standard Input Widths</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../de/d0f/layout__helpers_8h.html">app/gui/core/layout_helpers.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>gui::LayoutHelpers;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> DrawSettings() {</div>
<div class="line">  ImGui::Text(<span class="stringliteral">&quot;Property:&quot;</span>);</div>
<div class="line">  ImGui::SameLine();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Standard width for input fields (120px)</span></div>
<div class="line">  ImGui::SetNextItemWidth(LayoutHelpers::GetStandardInputWidth());</div>
<div class="line">  ImGui::InputInt(<span class="stringliteral">&quot;##value&quot;</span>, &amp;my_value_);</div>
<div class="line">}</div>
<div class="ttc" id="alayout__helpers_8h_html"><div class="ttname"><a href="../../de/d0f/layout__helpers_8h.html">layout_helpers.h</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1447"></a>
Help Markers</h2>
<div class="fragment"><div class="line">ImGui::Text(<span class="stringliteral">&quot;Complex Setting&quot;</span>);</div>
<div class="line">ImGui::SameLine();</div>
<div class="line">LayoutHelpers::HelpMarker(</div>
<div class="line">  <span class="stringliteral">&quot;This is a detailed explanation of what this setting does. &quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;It appears as a tooltip when hovering the (?) icon.&quot;</span></div>
<div class="line">);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1448"></a>
Spacing Utilities</h2>
<div class="fragment"><div class="line"><span class="comment">// Vertical spacing</span></div>
<div class="line">LayoutHelpers::VerticalSpacing(10.0f);  <span class="comment">// 10px vertical space</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Horizontal spacing</span></div>
<div class="line">ImGui::SameLine();</div>
<div class="line">LayoutHelpers::HorizontalSpacing(20.0f);  <span class="comment">// 20px horizontal space</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Separator with text</span></div>
<div class="line">LayoutHelpers::SeparatorText(<span class="stringliteral">&quot;Section Name&quot;</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1449"></a>
Responsive Layout</h2>
<div class="fragment"><div class="line"><span class="comment">// Get available width</span></div>
<div class="line"><span class="keywordtype">float</span> available_width = ImGui::GetContentRegionAvail().x;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Calculate dynamic widths</span></div>
<div class="line"><span class="keywordtype">float</span> button_width = available_width * 0.5f;  <span class="comment">// 50% of available</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (ImGui::Button(<span class="stringliteral">&quot;Full Width&quot;</span>, ImVec2(-1, 0))) {</div>
<div class="line">  <span class="comment">// -1 = fill available width</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (ImGui::Button(<span class="stringliteral">&quot;Half Width&quot;</span>, ImVec2(button_width, 0))) {</div>
<div class="line">  <span class="comment">// Fixed to 50%</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1450"></a>
Grid Layouts</h2>
<div class="fragment"><div class="line"><span class="comment">// Two-column grid</span></div>
<div class="line"><span class="keywordflow">if</span> (ImGui::BeginTable(<span class="stringliteral">&quot;##Grid&quot;</span>, 2, ImGuiTableFlags_SizingStretchSame)) {</div>
<div class="line">  ImGui::TableNextRow();</div>
<div class="line">  ImGui::TableNextColumn();</div>
<div class="line">  ImGui::Text(<span class="stringliteral">&quot;Label 1:&quot;</span>);</div>
<div class="line">  ImGui::TableNextColumn();</div>
<div class="line">  ImGui::InputText(<span class="stringliteral">&quot;##input1&quot;</span>, buffer1, <span class="keyword">sizeof</span>(buffer1));</div>
<div class="line"> </div>
<div class="line">  ImGui::TableNextRow();</div>
<div class="line">  ImGui::TableNextColumn();</div>
<div class="line">  ImGui::Text(<span class="stringliteral">&quot;Label 2:&quot;</span>);</div>
<div class="line">  ImGui::TableNextColumn();</div>
<div class="line">  ImGui::InputText(<span class="stringliteral">&quot;##input2&quot;</span>, buffer2, <span class="keyword">sizeof</span>(buffer2));</div>
<div class="line"> </div>
<div class="line">  ImGui::EndTable();</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1451"></a>
10. Workspace Management</h1>
<p>The workspace manager provides comprehensive window and layout operations:</p>
<p><b>Window Management:</b></p><ul>
<li><code>ShowAllWindows() / HideAllWindows()</code> - via EditorCardManager</li>
<li><code>MaximizeCurrentWindow()</code> - Dock to central node</li>
<li><code>RestoreAllWindows()</code> - Reset window sizes</li>
<li><code>CloseAllFloatingWindows()</code> - Close undocked windows</li>
</ul>
<p><b>Window Navigation:</b></p><ul>
<li><code>FocusNextWindow() / FocusPreviousWindow()</code> - Window cycling</li>
<li><code>SplitWindowHorizontal() / SplitWindowVertical()</code> - Split current window</li>
<li><code>CloseCurrentWindow()</code> - Close focused window</li>
</ul>
<p><b>Command Integration:</b> </p><div class="fragment"><div class="line">workspace_manager_.ExecuteWorkspaceCommand(command_id);</div>
<div class="line"><span class="comment">// Supports: w.s (show all), w.h (hide all), l.s (save layout), etc.</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1452"></a>
11. Future Editor Improvements</h1>
<p>This section outlines remaining improvements for editors not yet fully integrated.</p>
<h2><a class="anchor" id="autotoc_md1453"></a>
SettingsEditor</h2>
<p><b>Current State:</b> Monolithic settings window</p>
<p><b>Potential Improvements:</b></p><ol type="1">
<li>Split into categorized cards</li>
<li>Register with EditorCardManager</li>
<li>Add search/filter functionality</li>
</ol>
<h2><a class="anchor" id="autotoc_md1454"></a>
AgentEditor</h2>
<p><b>Current State:</b> Complex AI agent UI, under active development</p>
<p><b>Potential Improvements:</b></p><ol type="1">
<li>Consider card-based refactoring when stable</li>
<li>Integrate with EditorCardManager</li>
<li>Add keyboard shortcuts for common operations</li>
</ol>
<h1><a class="anchor" id="autotoc_md1455"></a>
12. Migration Checklist</h1>
<p>Use this checklist when converting an editor to the card-based architecture:</p>
<h2><a class="anchor" id="autotoc_md1456"></a>
Planning Phase</h2>
<ul>
<li>[ ] Identify all major UI components that should become cards</li>
<li>[ ] Design keyboard shortcut scheme (Ctrl+Alt+[1-9] for cards)</li>
<li>[ ] Plan <code>Toolset</code> contents (toggles, actions, properties)</li>
<li>[ ] List all hardcoded colors to be replaced</li>
</ul>
<h2><a class="anchor" id="autotoc_md1457"></a>
Implementation Phase - Core Structure</h2>
<ul>
<li>[ ] Add visibility flags for all cards (e.g., <code>bool show_my_card_ = false;</code>)</li>
<li>[ ] Create <code>Initialize()</code> method if not present</li>
<li>[ ] Register all cards with <code>EditorCardManager</code> in <code>Initialize()</code></li>
<li>[ ] Add card priority values (10, 20, 30, etc.)</li>
<li>[ ] Include shortcut hints in registration</li>
</ul>
<h2><a class="anchor" id="autotoc_md1458"></a>
Implementation Phase - Toolset</h2>
<ul>
<li>[ ] Create <code>DrawToolset()</code> method</li>
<li>[ ] Add toggle buttons for each card</li>
<li>[ ] Include keyboard shortcut hints in tooltips</li>
<li>[ ] Add separators between logical groups</li>
<li>[ ] Add action buttons for common operations</li>
</ul>
<h2><a class="anchor" id="autotoc_md1459"></a>
Implementation Phase - Control Panel</h2>
<ul>
<li>[ ] Create <code>DrawControlPanel()</code> method</li>
<li>[ ] Call <code>DrawToolset()</code> at top of control panel</li>
<li>[ ] Add checkbox grid for quick toggles</li>
<li>[ ] Add minimize-to-icon button at bottom</li>
<li>[ ] Include modified status indicators if applicable</li>
<li>[ ] Add "Save All" / "Discard All" buttons if applicable</li>
</ul>
<h2><a class="anchor" id="autotoc_md1460"></a>
Implementation Phase - Cards</h2>
<ul>
<li>[ ] Create card classes or Draw methods</li>
<li>[ ] Use <code>gui::EditorCard</code> wrapper with Begin/End</li>
<li>[ ] Set default size and position for each card</li>
<li>[ ] Pass visibility flag to both constructor and Begin()</li>
<li>[ ] Implement proper card content</li>
</ul>
<h2><a class="anchor" id="autotoc_md1461"></a>
Implementation Phase - Update Method</h2>
<ul>
<li>[ ] Update <code>Update()</code> to draw control panel (if visible)</li>
<li>[ ] Update <code>Update()</code> to draw minimize-to-icon (if minimized)</li>
<li>[ ] Add visibility flag synchronization for each card: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (show_card_ &amp;&amp; card_instance_) {</div>
<div class="line">  <span class="keywordflow">if</span> (!card_instance_-&gt;IsVisible()) card_instance_-&gt;Show();</div>
<div class="line">  card_instance_-&gt;Draw();</div>
<div class="line">  <span class="keywordflow">if</span> (!card_instance_-&gt;IsVisible()) show_card_ = <span class="keyword">false</span>;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="autotoc_md1462"></a>
Implementation Phase - Theming</h2>
<ul>
<li>[ ] Replace all <code>ImVec4</code> color literals with theme colors</li>
<li>[ ] Use <code>ThemedButton()</code> instead of <code>ImGui::Button()</code> where appropriate</li>
<li>[ ] Use <code>PrimaryButton()</code> for save/apply actions</li>
<li>[ ] Use <code>DangerButton()</code> for delete/discard actions</li>
<li>[ ] Use <code>SectionHeader()</code> for visual hierarchy</li>
<li>[ ] Use <code>ThemedIconButton()</code> for icon-only buttons</li>
</ul>
<h2><a class="anchor" id="autotoc_md1463"></a>
Testing Phase</h2>
<ul>
<li>[ ] Test opening each card via control panel checkbox</li>
<li>[ ] Test opening each card via keyboard shortcut</li>
<li>[ ] Test closing cards with X button</li>
<li>[ ] Test minimize-to-icon on control panel</li>
<li>[ ] Test reopening from icon</li>
<li>[ ] Verify EditorCardManager shows all cards in View menu</li>
<li>[ ] Test that closing control panel doesn't affect other cards</li>
<li>[ ] Verify visibility flags sync properly</li>
<li>[ ] Test docking behavior (if enabled)</li>
<li>[ ] Verify all themed widgets render correctly</li>
</ul>
<h2><a class="anchor" id="autotoc_md1464"></a>
Documentation Phase</h2>
<ul>
<li>[ ] Document keyboard shortcuts in header comment</li>
<li>[ ] Update <a class="el" href="../../de/dfd/E2-development-guide_8md.html">E2-development-guide.md</a> editor status if applicable</li>
<li>[ ] Add example to this guide if pattern is novel</li>
<li>[ ] Update CLAUDE.md if editor behavior changed significantly</li>
</ul>
<h1><a class="anchor" id="autotoc_md1465"></a>
13. Code Examples</h1>
<h2><a class="anchor" id="autotoc_md1466"></a>
Complete Editor Implementation</h2>
<p>This example shows a minimal but complete editor implementation using all the patterns:</p>
<div class="fragment"><div class="line"><span class="comment">// my_editor.h</span></div>
<div class="line"><span class="preprocessor">#ifndef YAZE_APP_EDITOR_MY_EDITOR_H</span></div>
<div class="line"><span class="preprocessor">#define YAZE_APP_EDITOR_MY_EDITOR_H</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../dd/d60/editor_8h.html">app/editor/editor.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../da/de5/rom_8h.html">app/rom.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../dc/d46/namespaceyaze.html">yaze</a> {</div>
<div class="line"><span class="keyword">namespace </span>editor {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MyEditor : <span class="keyword">public</span> Editor {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">explicit</span> MyEditor(Rom* rom = <span class="keyword">nullptr</span>) : rom_(rom) {</div>
<div class="line">    type_ = EditorType::kMyEditor;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> Initialize() <span class="keyword">override</span>;</div>
<div class="line">  absl::Status Load() <span class="keyword">override</span>;</div>
<div class="line">  absl::Status Update() <span class="keyword">override</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_rom(Rom* rom) { rom_ = rom; }</div>
<div class="line">  Rom* rom()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> rom_; }</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">private</span>:</div>
<div class="line">  <span class="keywordtype">void</span> DrawToolset();</div>
<div class="line">  <span class="keywordtype">void</span> DrawControlPanel();</div>
<div class="line">  <span class="keywordtype">void</span> DrawListCard();</div>
<div class="line">  <span class="keywordtype">void</span> DrawPropertiesCard();</div>
<div class="line"> </div>
<div class="line">  Rom* rom_;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Card visibility flags</span></div>
<div class="line">  <span class="keywordtype">bool</span> show_control_panel_ = <span class="keyword">true</span>;</div>
<div class="line">  <span class="keywordtype">bool</span> show_list_card_ = <span class="keyword">false</span>;</div>
<div class="line">  <span class="keywordtype">bool</span> show_properties_card_ = <span class="keyword">false</span>;</div>
<div class="line">  <span class="keywordtype">bool</span> control_panel_minimized_ = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Data</span></div>
<div class="line">  <span class="keywordtype">int</span> selected_item_ = -1;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}  <span class="comment">// namespace editor</span></div>
<div class="line">}  <span class="comment">// namespace yaze</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif  </span><span class="comment">// YAZE_APP_EDITOR_MY_EDITOR_H</span></div>
<div class="ttc" id="aeditor_8h_html"><div class="ttname"><a href="../../dd/d60/editor_8h.html">editor.h</a></div></div>
<div class="ttc" id="anamespaceyaze_html"><div class="ttname"><a href="../../dc/d46/namespaceyaze.html">yaze</a></div><div class="ttdoc">Main namespace for the application.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0c/controller_8cc_source.html#l00020">controller.cc:20</a></div></div>
<div class="ttc" id="arom_8h_html"><div class="ttname"><a href="../../da/de5/rom_8h.html">rom.h</a></div></div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// my_editor.cc</span></div>
<div class="line"><span class="preprocessor">#include &quot;my_editor.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;app/gui/app/editor_card_manager.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d5/d1d/editor__layout_8h.html">app/gui/app/editor_layout.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../de/dbf/icons_8h.html">app/gui/core/icons.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;app/gui/core/themed_widgets.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;imgui/imgui.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../dc/d46/namespaceyaze.html">yaze</a> {</div>
<div class="line"><span class="keyword">namespace </span>editor {</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> MyEditor::Initialize() {</div>
<div class="line">  <span class="keyword">auto</span>&amp; card_manager = gui::EditorCardManager::Get();</div>
<div class="line"> </div>
<div class="line">  card_manager.RegisterCard({</div>
<div class="line">      .card_id = <span class="stringliteral">&quot;myeditor.control_panel&quot;</span>,</div>
<div class="line">      .display_name = <span class="stringliteral">&quot;My Editor Controls&quot;</span>,</div>
<div class="line">      .icon = <a class="code hl_define" href="../../de/dbf/icons_8h.html#a14ded7148bef481ff6b688f261157597">ICON_MD_SETTINGS</a>,</div>
<div class="line">      .category = <span class="stringliteral">&quot;MyEditor&quot;</span>,</div>
<div class="line">      .shortcut_hint = <span class="stringliteral">&quot;Ctrl+Shift+M&quot;</span>,</div>
<div class="line">      .visibility_flag = &amp;show_control_panel_,</div>
<div class="line">      .priority = 10</div>
<div class="line">  });</div>
<div class="line"> </div>
<div class="line">  card_manager.RegisterCard({</div>
<div class="line">      .card_id = <span class="stringliteral">&quot;myeditor.list&quot;</span>,</div>
<div class="line">      .display_name = <span class="stringliteral">&quot;Item List&quot;</span>,</div>
<div class="line">      .icon = <a class="code hl_define" href="../../de/dbf/icons_8h.html#a8a19ab9cdceeeda80823c1fd98867a77">ICON_MD_LIST</a>,</div>
<div class="line">      .category = <span class="stringliteral">&quot;MyEditor&quot;</span>,</div>
<div class="line">      .shortcut_hint = <span class="stringliteral">&quot;Ctrl+Alt+1&quot;</span>,</div>
<div class="line">      .visibility_flag = &amp;show_list_card_,</div>
<div class="line">      .priority = 20</div>
<div class="line">  });</div>
<div class="line"> </div>
<div class="line">  card_manager.RegisterCard({</div>
<div class="line">      .card_id = <span class="stringliteral">&quot;myeditor.properties&quot;</span>,</div>
<div class="line">      .display_name = <span class="stringliteral">&quot;Properties&quot;</span>,</div>
<div class="line">      .icon = <a class="code hl_define" href="../../de/dbf/icons_8h.html#a5470d2bdad9b5fa0552bebdb828f3a0b">ICON_MD_TUNE</a>,</div>
<div class="line">      .category = <span class="stringliteral">&quot;MyEditor&quot;</span>,</div>
<div class="line">      .shortcut_hint = <span class="stringliteral">&quot;Ctrl+Alt+2&quot;</span>,</div>
<div class="line">      .visibility_flag = &amp;show_properties_card_,</div>
<div class="line">      .priority = 30</div>
<div class="line">  });</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">absl::Status MyEditor::Load() {</div>
<div class="line">  <span class="keywordflow">if</span> (!rom_ || !rom_-&gt;is_loaded()) {</div>
<div class="line">    <span class="keywordflow">return</span> absl::NotFoundError(<span class="stringliteral">&quot;ROM not loaded&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Load data from ROM</span></div>
<div class="line">  <span class="comment">// ...</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> absl::OkStatus();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">absl::Status MyEditor::Update() {</div>
<div class="line">  <span class="keywordflow">if</span> (!rom_ || !rom_-&gt;is_loaded()) {</div>
<div class="line">    gui::EditorCard loading_card(<span class="stringliteral">&quot;My Editor Loading&quot;</span>, <a class="code hl_define" href="../../de/dbf/icons_8h.html#a14ded7148bef481ff6b688f261157597">ICON_MD_SETTINGS</a>);</div>
<div class="line">    loading_card.SetDefaultSize(400, 200);</div>
<div class="line">    <span class="keywordflow">if</span> (loading_card.Begin()) {</div>
<div class="line">      ImGui::Text(<span class="stringliteral">&quot;Waiting for ROM to load...&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    loading_card.End();</div>
<div class="line">    <span class="keywordflow">return</span> absl::OkStatus();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Control panel (can be hidden/minimized)</span></div>
<div class="line">  <span class="keywordflow">if</span> (show_control_panel_) {</div>
<div class="line">    DrawControlPanel();</div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (control_panel_minimized_) {</div>
<div class="line">    <span class="comment">// Minimize-to-icon</span></div>
<div class="line">    ImGui::SetNextWindowPos(ImVec2(10, 100));</div>
<div class="line">    ImGui::SetNextWindowSize(ImVec2(50, 50));</div>
<div class="line">    ImGuiWindowFlags icon_flags = ImGuiWindowFlags_NoTitleBar |</div>
<div class="line">                                  ImGuiWindowFlags_NoResize |</div>
<div class="line">                                  ImGuiWindowFlags_NoScrollbar |</div>
<div class="line">                                  ImGuiWindowFlags_NoCollapse |</div>
<div class="line">                                  ImGuiWindowFlags_NoDocking;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ImGui::Begin(<span class="stringliteral">&quot;##MyEditorControlIcon&quot;</span>, <span class="keyword">nullptr</span>, icon_flags)) {</div>
<div class="line">      <span class="keywordflow">if</span> (ImGui::Button(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a14ded7148bef481ff6b688f261157597">ICON_MD_SETTINGS</a>, ImVec2(40, 40))) {</div>
<div class="line">        show_control_panel_ = <span class="keyword">true</span>;</div>
<div class="line">        control_panel_minimized_ = <span class="keyword">false</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (ImGui::IsItemHovered()) {</div>
<div class="line">        ImGui::SetTooltip(<span class="stringliteral">&quot;Open My Editor Controls&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    ImGui::End();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Independent cards</span></div>
<div class="line">  <span class="keywordflow">if</span> (show_list_card_) {</div>
<div class="line">    DrawListCard();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (show_properties_card_) {</div>
<div class="line">    DrawPropertiesCard();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> absl::OkStatus();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> MyEditor::DrawToolset() {</div>
<div class="line">  <span class="keyword">static</span> gui::Toolset toolbar;</div>
<div class="line">  toolbar.Begin();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (toolbar.AddToggle(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a8a19ab9cdceeeda80823c1fd98867a77">ICON_MD_LIST</a>, &amp;show_list_card_,</div>
<div class="line">                        <span class="stringliteral">&quot;Item List (Ctrl+Alt+1)&quot;</span>)) {</div>
<div class="line">    <span class="comment">// Toggled</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (toolbar.AddToggle(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a5470d2bdad9b5fa0552bebdb828f3a0b">ICON_MD_TUNE</a>, &amp;show_properties_card_,</div>
<div class="line">                        <span class="stringliteral">&quot;Properties (Ctrl+Alt+2)&quot;</span>)) {</div>
<div class="line">    <span class="comment">// Toggled</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  toolbar.AddSeparator();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (toolbar.AddAction(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a5921579d0045db598703371c5a9b54a6">ICON_MD_REFRESH</a>, <span class="stringliteral">&quot;Reload&quot;</span>)) {</div>
<div class="line">    Load();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  toolbar.End();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> MyEditor::DrawControlPanel() {</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#a74d33eb620c04e64868424a44073e5c0">gui::PrimaryButton</a>;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#a419003d38ef1b760235c0291c0e9db9f">gui::DangerButton</a>;</div>
<div class="line"> </div>
<div class="line">  ImGui::SetNextWindowSize(ImVec2(280, 220), ImGuiCond_FirstUseEver);</div>
<div class="line">  ImGui::SetNextWindowPos(ImVec2(10, 100), ImGuiCond_FirstUseEver);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (ImGui::Begin(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a14ded7148bef481ff6b688f261157597">ICON_MD_SETTINGS</a> <span class="stringliteral">&quot; My Editor Controls&quot;</span>,</div>
<div class="line">                   &amp;show_control_panel_)) {</div>
<div class="line">    DrawToolset();</div>
<div class="line"> </div>
<div class="line">    ImGui::Separator();</div>
<div class="line">    ImGui::Text(<span class="stringliteral">&quot;Quick Toggles:&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ImGui::BeginTable(<span class="stringliteral">&quot;##QuickToggles&quot;</span>, 2,</div>
<div class="line">                          ImGuiTableFlags_SizingStretchSame)) {</div>
<div class="line">      ImGui::TableNextRow();</div>
<div class="line">      ImGui::TableNextColumn();</div>
<div class="line">      ImGui::Checkbox(<span class="stringliteral">&quot;List&quot;</span>, &amp;show_list_card_);</div>
<div class="line"> </div>
<div class="line">      ImGui::TableNextColumn();</div>
<div class="line">      ImGui::Checkbox(<span class="stringliteral">&quot;Properties&quot;</span>, &amp;show_properties_card_);</div>
<div class="line"> </div>
<div class="line">      ImGui::EndTable();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ImGui::Separator();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ImGui::SmallButton(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a25040517a034b72a886e91272913cd7b">ICON_MD_MINIMIZE</a> <span class="stringliteral">&quot; Minimize to Icon&quot;</span>)) {</div>
<div class="line">      control_panel_minimized_ = <span class="keyword">true</span>;</div>
<div class="line">      show_control_panel_ = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  ImGui::End();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> MyEditor::DrawListCard() {</div>
<div class="line">  gui::EditorCard card(<span class="stringliteral">&quot;Item List&quot;</span>, <a class="code hl_define" href="../../de/dbf/icons_8h.html#a8a19ab9cdceeeda80823c1fd98867a77">ICON_MD_LIST</a>, &amp;show_list_card_);</div>
<div class="line">  card.SetDefaultSize(300, 500);</div>
<div class="line">  card.SetPosition(<a class="code hl_enumvalue" href="../../d4/d96/classyaze_1_1gui_1_1EditorCard.html#a6d7f9e282571c88aaf0e1d66c981af8ba945d5e233cf7d6240f6b783b36a374ff">gui::EditorCard::Position::Left</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (card.Begin(&amp;show_list_card_)) {</div>
<div class="line">    ImGui::Text(<span class="stringliteral">&quot;Item List Content&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ImGui::BeginChild(<span class="stringliteral">&quot;##ItemListScroll&quot;</span>, ImVec2(0, 0), <span class="keyword">true</span>)) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 50; i++) {</div>
<div class="line">        <span class="keywordtype">bool</span> is_selected = (selected_item_ == i);</div>
<div class="line">        <span class="keywordflow">if</span> (ImGui::Selectable(absl::StrFormat(<span class="stringliteral">&quot;Item %d&quot;</span>, i).c_str(),</div>
<div class="line">                              is_selected)) {</div>
<div class="line">          selected_item_ = i;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    ImGui::EndChild();</div>
<div class="line">  }</div>
<div class="line">  card.End();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> MyEditor::DrawPropertiesCard() {</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#af838352fb69ef974c47008f982b42213">gui::ThemedIconButton</a>;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#a5fa374aea4d5d783b38f9fc32e937eb0">gui::SectionHeader</a>;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#a74d33eb620c04e64868424a44073e5c0">gui::PrimaryButton</a>;</div>
<div class="line"> </div>
<div class="line">  gui::EditorCard card(<span class="stringliteral">&quot;Properties&quot;</span>, <a class="code hl_define" href="../../de/dbf/icons_8h.html#a5470d2bdad9b5fa0552bebdb828f3a0b">ICON_MD_TUNE</a>, &amp;show_properties_card_);</div>
<div class="line">  card.SetDefaultSize(350, 400);</div>
<div class="line">  card.SetPosition(<a class="code hl_enumvalue" href="../../d4/d96/classyaze_1_1gui_1_1EditorCard.html#a6d7f9e282571c88aaf0e1d66c981af8ba92b09c7c48c520c3c55e497875da437c">gui::EditorCard::Position::Right</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (card.Begin(&amp;show_properties_card_)) {</div>
<div class="line">    <span class="keywordflow">if</span> (selected_item_ &lt; 0) {</div>
<div class="line">      ImGui::TextDisabled(<span class="stringliteral">&quot;No item selected&quot;</span>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#a5fa374aea4d5d783b38f9fc32e937eb0">SectionHeader</a>(<span class="stringliteral">&quot;Item Properties&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      ImGui::Text(<span class="stringliteral">&quot;Item: %d&quot;</span>, selected_item_);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">static</span> <span class="keywordtype">char</span> name_buffer[64] = <span class="stringliteral">&quot;Item Name&quot;</span>;</div>
<div class="line">      ImGui::InputText(<span class="stringliteral">&quot;Name&quot;</span>, name_buffer, <span class="keyword">sizeof</span>(name_buffer));</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">static</span> <span class="keywordtype">int</span> value = 100;</div>
<div class="line">      ImGui::InputInt(<span class="stringliteral">&quot;Value&quot;</span>, &amp;value);</div>
<div class="line"> </div>
<div class="line">      ImGui::Separator();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#a74d33eb620c04e64868424a44073e5c0">PrimaryButton</a>(<span class="stringliteral">&quot;Save Changes&quot;</span>, ImVec2(-1, 0))) {</div>
<div class="line">        <span class="comment">// Save to ROM</span></div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/dbf/namespaceyaze_1_1gui.html#af838352fb69ef974c47008f982b42213">ThemedIconButton</a>(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a5921579d0045db598703371c5a9b54a6">ICON_MD_REFRESH</a>, <span class="stringliteral">&quot;Reset to defaults&quot;</span>)) {</div>
<div class="line">        <span class="comment">// Reset</span></div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  card.End();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">}  <span class="comment">// namespace editor</span></div>
<div class="line">}  <span class="comment">// namespace yaze</span></div>
<div class="ttc" id="aclassyaze_1_1gui_1_1EditorCard_html_a6d7f9e282571c88aaf0e1d66c981af8ba92b09c7c48c520c3c55e497875da437c"><div class="ttname"><a href="../../d4/d96/classyaze_1_1gui_1_1EditorCard.html#a6d7f9e282571c88aaf0e1d66c981af8ba92b09c7c48c520c3c55e497875da437c">yaze::gui::EditorCard::Position::Right</a></div><div class="ttdeci">@ Right</div></div>
<div class="ttc" id="aclassyaze_1_1gui_1_1EditorCard_html_a6d7f9e282571c88aaf0e1d66c981af8ba945d5e233cf7d6240f6b783b36a374ff"><div class="ttname"><a href="../../d4/d96/classyaze_1_1gui_1_1EditorCard.html#a6d7f9e282571c88aaf0e1d66c981af8ba945d5e233cf7d6240f6b783b36a374ff">yaze::gui::EditorCard::Position::Left</a></div><div class="ttdeci">@ Left</div></div>
<div class="ttc" id="aeditor__layout_8h_html"><div class="ttname"><a href="../../d5/d1d/editor__layout_8h.html">editor_layout.h</a></div></div>
<div class="ttc" id="aicons_8h_html"><div class="ttname"><a href="../../de/dbf/icons_8h.html">icons.h</a></div></div>
<div class="ttc" id="aicons_8h_html_a25040517a034b72a886e91272913cd7b"><div class="ttname"><a href="../../de/dbf/icons_8h.html#a25040517a034b72a886e91272913cd7b">ICON_MD_MINIMIZE</a></div><div class="ttdeci">#define ICON_MD_MINIMIZE</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l01209">icons.h:1209</a></div></div>
<div class="ttc" id="aicons_8h_html_a5470d2bdad9b5fa0552bebdb828f3a0b"><div class="ttname"><a href="../../de/dbf/icons_8h.html#a5470d2bdad9b5fa0552bebdb828f3a0b">ICON_MD_TUNE</a></div><div class="ttdeci">#define ICON_MD_TUNE</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbf/icons_8h_source.html#l02020">icons.h:2020</a></div></div>
<div class="ttc" id="anamespaceyaze_1_1gui_html_a419003d38ef1b760235c0291c0e9db9f"><div class="ttname"><a href="../../d3/dbf/namespaceyaze_1_1gui.html#a419003d38ef1b760235c0291c0e9db9f">yaze::gui::DangerButton</a></div><div class="ttdeci">bool DangerButton(const char *label, const ImVec2 &amp;size)</div><div class="ttdoc">Danger/destructive action button (uses error color)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d03/themed__widgets_8cc_source.html#l00052">themed_widgets.cc:52</a></div></div>
<div class="ttc" id="anamespaceyaze_1_1gui_html_a74d33eb620c04e64868424a44073e5c0"><div class="ttname"><a href="../../d3/dbf/namespaceyaze_1_1gui.html#a74d33eb620c04e64868424a44073e5c0">yaze::gui::PrimaryButton</a></div><div class="ttdeci">bool PrimaryButton(const char *label, const ImVec2 &amp;size)</div><div class="ttdoc">Primary action button (uses accent color)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d03/themed__widgets_8cc_source.html#l00036">themed_widgets.cc:36</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1467"></a>
14. Common Pitfalls</h1>
<h2><a class="anchor" id="autotoc_md1468"></a>
1. Forgetting Bidirectional Visibility Sync</h2>
<p><b>Problem:</b> Cards don't reopen after being closed with X button.</p>
<p><b>Cause:</b> Not syncing the visibility flag back when the card is closed.</p>
<p><b>Solution:</b> </p><div class="fragment"><div class="line"><span class="comment">// WRONG</span></div>
<div class="line"><span class="keywordflow">if</span> (show_my_card_) {</div>
<div class="line">  my_card_-&gt;Draw();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// CORRECT</span></div>
<div class="line"><span class="keywordflow">if</span> (show_my_card_ &amp;&amp; my_card_) {</div>
<div class="line">  <span class="keywordflow">if</span> (!my_card_-&gt;IsVisible()) my_card_-&gt;Show();</div>
<div class="line">  my_card_-&gt;Draw();</div>
<div class="line">  <span class="keywordflow">if</span> (!my_card_-&gt;IsVisible()) show_my_card_ = <span class="keyword">false</span>;  <span class="comment">// Sync back!</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1469"></a>
2. Using Hardcoded Colors</h2>
<p><b>Problem:</b> UI looks inconsistent, doesn't respect theme.</p>
<p><b>Cause:</b> Using <code>ImVec4</code> literals instead of theme colors.</p>
<p><b>Solution:</b> </p><div class="fragment"><div class="line"><span class="comment">// WRONG</span></div>
<div class="line">ImGui::TextColored(ImVec4(1.0f, 0.0f, 0.0f, 1.0f), <span class="stringliteral">&quot;Error!&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// CORRECT</span></div>
<div class="line"><span class="keyword">const</span> <span class="keyword">auto</span>&amp; theme = AgentUI::GetTheme();</div>
<div class="line">ImGui::TextColored(theme.status_error, <span class="stringliteral">&quot;Error!&quot;</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1470"></a>
3. Not Calling Show() Before Draw()</h2>
<p><b>Problem:</b> Newly opened cards don't appear.</p>
<p><b>Cause:</b> The card's internal <code>show_</code> flag isn't set when visibility flag changes.</p>
<p><b>Solution:</b> </p><div class="fragment"><div class="line"><span class="comment">// WRONG</span></div>
<div class="line"><span class="keywordflow">if</span> (show_my_card_) {</div>
<div class="line">  my_card_-&gt;Draw();  <span class="comment">// Card won&#39;t appear if internally hidden</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// CORRECT</span></div>
<div class="line"><span class="keywordflow">if</span> (show_my_card_) {</div>
<div class="line">  <span class="keywordflow">if</span> (!my_card_-&gt;IsVisible()) my_card_-&gt;Show();  <span class="comment">// Ensure visible</span></div>
<div class="line">  my_card_-&gt;Draw();</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1471"></a>
4. Missing EditorCardManager Registration</h2>
<p><b>Problem:</b> Cards don't appear in View menu, shortcuts don't work.</p>
<p><b>Cause:</b> Forgot to register cards in <code>Initialize()</code>.</p>
<p><b>Solution:</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> MyEditor::Initialize() {</div>
<div class="line">  <span class="keyword">auto</span>&amp; card_manager = gui::EditorCardManager::Get();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Register ALL cards</span></div>
<div class="line">  card_manager.RegisterCard({</div>
<div class="line">      .card_id = <span class="stringliteral">&quot;myeditor.my_card&quot;</span>,</div>
<div class="line">      .display_name = <span class="stringliteral">&quot;My Card&quot;</span>,</div>
<div class="line">      .icon = ICON_MD_ICON,</div>
<div class="line">      .category = <span class="stringliteral">&quot;MyEditor&quot;</span>,</div>
<div class="line">      .shortcut_hint = <span class="stringliteral">&quot;Ctrl+Alt+1&quot;</span>,</div>
<div class="line">      .visibility_flag = &amp;show_my_card_,</div>
<div class="line">      .priority = 20</div>
<div class="line">  });</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1472"></a>
5. Improper Begin/End Pairing</h2>
<p><b>Problem:</b> <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> asserts, UI state corruption.</p>
<p><b>Cause:</b> Not calling <code>End()</code> when <code>Begin()</code> returns false, or early returns.</p>
<p><b>Solution:</b> </p><div class="fragment"><div class="line"><span class="comment">// WRONG</span></div>
<div class="line"><span class="keywordflow">if</span> (card.Begin()) {</div>
<div class="line">  DrawContent();</div>
<div class="line">  card.End();  <span class="comment">// Only called if Begin succeeded</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// CORRECT</span></div>
<div class="line"><span class="keywordflow">if</span> (card.Begin()) {</div>
<div class="line">  DrawContent();</div>
<div class="line">}</div>
<div class="line">card.End();  <span class="comment">// ALWAYS called</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1473"></a>
6. Not Testing Minimize-to-Icon</h2>
<p><b>Problem:</b> Control panel can't be reopened after minimizing.</p>
<p><b>Cause:</b> Forgot to implement the minimize-to-icon floating button.</p>
<p><b>Solution:</b> </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (show_control_panel_) {</div>
<div class="line">  DrawControlPanel();</div>
<div class="line">} <span class="keywordflow">else</span> <span class="keywordflow">if</span> (control_panel_minimized_) {</div>
<div class="line">  <span class="comment">// Draw floating icon button</span></div>
<div class="line">  ImGui::SetNextWindowPos(ImVec2(10, 100));</div>
<div class="line">  ImGui::SetNextWindowSize(ImVec2(50, 50));</div>
<div class="line">  ImGuiWindowFlags flags = ImGuiWindowFlags_NoTitleBar |</div>
<div class="line">                          ImGuiWindowFlags_NoResize |</div>
<div class="line">                          ImGuiWindowFlags_NoScrollbar |</div>
<div class="line">                          ImGuiWindowFlags_NoCollapse |</div>
<div class="line">                          ImGuiWindowFlags_NoDocking;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (ImGui::Begin(<span class="stringliteral">&quot;##ControlIcon&quot;</span>, <span class="keyword">nullptr</span>, flags)) {</div>
<div class="line">    <span class="keywordflow">if</span> (ImGui::Button(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a14ded7148bef481ff6b688f261157597">ICON_MD_SETTINGS</a>, ImVec2(40, 40))) {</div>
<div class="line">      show_control_panel_ = <span class="keyword">true</span>;</div>
<div class="line">      control_panel_minimized_ = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  ImGui::End();</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1474"></a>
7. Wrong Card Position Enum</h2>
<p><b>Problem:</b> Card appears in unexpected location.</p>
<p><b>Cause:</b> Using wrong <code>Position</code> enum value.</p>
<p><b>Solution:</b> </p><div class="fragment"><div class="line"><span class="comment">// Card positions</span></div>
<div class="line">card.SetPosition(gui::EditorCard::Position::Right);   <span class="comment">// Dock to right side</span></div>
<div class="line">card.SetPosition(gui::EditorCard::Position::Left);    <span class="comment">// Dock to left side</span></div>
<div class="line">card.SetPosition(gui::EditorCard::Position::Bottom);  <span class="comment">// Dock to bottom</span></div>
<div class="line">card.SetPosition(gui::EditorCard::Position::Floating);<span class="comment">// Save position</span></div>
<div class="line">card.SetPosition(gui::EditorCard::Position::Free);    <span class="comment">// No positioning</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1475"></a>
8. Not Handling Null Rom</h2>
<p><b>Problem:</b> Editor crashes when ROM isn't loaded.</p>
<p><b>Cause:</b> Not checking <code>rom_</code> before access.</p>
<p><b>Solution:</b> </p><div class="fragment"><div class="line">absl::Status MyEditor::Update() {</div>
<div class="line">  <span class="keywordflow">if</span> (!rom_ || !rom_-&gt;is_loaded()) {</div>
<div class="line">    <span class="comment">// Show loading card</span></div>
<div class="line">    gui::EditorCard loading_card(<span class="stringliteral">&quot;Editor Loading&quot;</span>, ICON_MD_ICON);</div>
<div class="line">    loading_card.SetDefaultSize(400, 200);</div>
<div class="line">    <span class="keywordflow">if</span> (loading_card.Begin()) {</div>
<div class="line">      ImGui::Text(<span class="stringliteral">&quot;Waiting for ROM...&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    loading_card.End();</div>
<div class="line">    <span class="keywordflow">return</span> absl::OkStatus();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Safe to use rom_ now</span></div>
<div class="line">  DrawEditor();</div>
<div class="line">  <span class="keywordflow">return</span> absl::OkStatus();</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1476"></a>
9. Forgetting Toolset Begin/End</h2>
<p><b>Problem:</b> Toolset items don't render or layout is broken.</p>
<p><b>Cause:</b> Missing <code>Begin()</code> or <code>End()</code> calls.</p>
<p><b>Solution:</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> DrawToolset() {</div>
<div class="line">  <span class="keyword">static</span> gui::Toolset toolbar;</div>
<div class="line"> </div>
<div class="line">  toolbar.Begin();  <span class="comment">// REQUIRED</span></div>
<div class="line"> </div>
<div class="line">  toolbar.AddToggle(ICON_MD_ICON, &amp;flag_, <span class="stringliteral">&quot;Tooltip&quot;</span>);</div>
<div class="line">  toolbar.AddSeparator();</div>
<div class="line">  toolbar.AddAction(<a class="code hl_define" href="../../de/dbf/icons_8h.html#acbbc3590e0cc448734c935ed0f31a6b2">ICON_MD_SAVE</a>, <span class="stringliteral">&quot;Save&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  toolbar.End();  <span class="comment">// REQUIRED</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1477"></a>
10. Hardcoded Shortcuts in Tooltips</h2>
<p><b>Problem:</b> Shortcuts shown in tooltips don't match actual keybinds.</p>
<p><b>Cause:</b> Tooltip string doesn't match <code>shortcut_hint</code> in registration.</p>
<p><b>Solution:</b> </p><div class="fragment"><div class="line"><span class="comment">// In Registration</span></div>
<div class="line">card_manager.RegisterCard({</div>
<div class="line">    .shortcut_hint = <span class="stringliteral">&quot;Ctrl+Alt+1&quot;</span>,  <span class="comment">// Define once</span></div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// In Toolset</span></div>
<div class="line">toolbar.AddToggle(<a class="code hl_define" href="../../de/dbf/icons_8h.html#a8a19ab9cdceeeda80823c1fd98867a77">ICON_MD_LIST</a>, &amp;show_list_,</div>
<div class="line">                 <span class="stringliteral">&quot;Item List (Ctrl+Alt+1)&quot;</span>);  <span class="comment">// Match exactly</span></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1479"></a>
Summary</h1>
<p>Following this guide ensures:</p><ul>
<li><b>Consistency</b>: All editors use the same patterns and components</li>
<li><b>Maintainability</b>: Reusable components reduce code duplication</li>
<li><b>User Experience</b>: Predictable keyboard shortcuts and visual styling</li>
<li><b>Flexibility</b>: Independent cards allow custom workspace arrangements</li>
<li><b>Discoverability</b>: EditorCardManager makes all features accessible</li>
</ul>
<p>When adding new editors or refactoring existing ones, refer to:</p><ol type="1">
<li><b>Dungeon Editor v2</b> (<code><a class="el" href="../../d0/d0d/dungeon__editor__v2_8cc.html">dungeon_editor_v2.cc</a></code>) - Gold standard implementation</li>
<li><b>Palette Editor</b> (<code>palette_editor.cc</code>) - Recently refactored, clean patterns</li>
<li><b>This Guide</b> - Comprehensive reference for all patterns</li>
</ol>
<p>For questions or suggestions about GUI consistency, please open an issue on GitHub or discuss in the development chat.</p>
<hr  />
<p><b>Last Updated</b>: October 13, 2025 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
