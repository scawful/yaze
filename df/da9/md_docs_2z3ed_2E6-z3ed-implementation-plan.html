<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>yaze: z3ed Agentic Workflow Plan</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../yaze.ico"/></td>
  <td id="projectalign">
   <div id="projectname">yaze<span id="projectnumber">&#160;0.3.1</span>
   </div>
   <div id="projectbrief">Link to the Past ROM Editor</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('df/da9/md_docs_2z3ed_2E6-z3ed-implementation-plan.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">z3ed Agentic Workflow Plan</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1210"></a> <b>Last Updated</b>: October 2, 2025 <b>Status</b>: Core Infrastructure Complete | Test Harness Enhancement Phase üéØ</p>
<blockquote class="doxtable">
<p>&zwj;üìã <b>Quick Start</b>: See <a class="el" href="../../d0/d30/md_README.html">README.md</a> for essential links and project status. </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md1211"></a>
Executive Summary</h1>
<p>The z3ed CLI and AI agent workflow system has completed major infrastructure milestones:</p>
<p><b>‚úÖ Completed Phases</b>:</p><ul>
<li><b>Phase 6</b>: Resource Catalogue - Machine-readable API specs for AI consumption</li>
<li><b>AW-01/02/03</b>: Acceptance Workflow - Proposal tracking, sandbox management, GUI review with ROM merging</li>
<li><b>AW-04</b>: Policy Evaluation Framework - YAML-based constraint system for proposal acceptance</li>
<li><b>IT-01</b>: ImGuiTestHarness - Full GUI automation via gRPC + ImGuiTestEngine (all 3 phases complete)</li>
<li><b>IT-02</b>: CLI Agent Test - Natural language ‚Üí automated GUI testing (implementation complete)</li>
</ul>
<p><b>üîÑ Active Phase</b>:</p><ul>
<li><b>Test Harness Enhancements (IT-05 to IT-09)</b>: Expanding from basic automation to comprehensive testing platform with a renewed emphasis on system-wide error reporting</li>
</ul>
<p><b>üìã Next Phases</b>:</p><ul>
<li><b>Priority 1</b>: Test Introspection API (IT-05) - Enable test status querying and result polling</li>
<li><b>Priority 2</b>: Widget Discovery API (IT-06) - AI agents enumerate available GUI interactions</li>
<li><b>Priority 3</b>: Enhanced Error Reporting (IT-08+) - Holistic improvements spanning z3ed, ImGuiTestHarness, EditorManager, and core application services</li>
</ul>
<p><b>Recent Accomplishments</b> (Updated: October 2025):</p><ul>
<li><b>‚úÖ IT-08 Enhanced Error Reporting Complete</b>: Full diagnostic capture operational<ul>
<li>IT-08a: Screenshot RPC with SDL capture (BMP format, 1536x864) <br  />
</li>
<li>IT-08b: Auto-capture execution context on failures (frame, window, widget)</li>
<li>IT-08c: Widget state dumps with comprehensive UI snapshot (JSON, 45 min)</li>
<li>Proto schema updated with screenshot_path, failure_context, widget_state</li>
<li>GetTestResults RPC returns complete failure diagnostics</li>
</ul>
</li>
<li><b>‚úÖ IT-08a Screenshot RPC Complete</b>: SDL-based screenshot capture operational<ul>
<li>Captures 1536x864 BMP files via SDL_RenderReadPixels</li>
<li>Successfully tested via gRPC (5.3MB output files)</li>
<li>Foundation for auto-capture on test failures</li>
</ul>
</li>
<li><b>‚úÖ Policy Framework Complete</b>: PolicyEvaluator service fully integrated with ProposalDrawer GUI<ul>
<li>4 policy types implemented: test_requirement, change_constraint, forbidden_range, review_requirement</li>
<li>3 severity levels: Info (informational), Warning (overridable), Critical (blocks acceptance)</li>
<li>GUI displays color-coded violations (‚õî critical, ‚ö†Ô∏è warning, ‚ÑπÔ∏è info)</li>
<li>Accept button gating based on policy violations with override confirmation dialog</li>
<li>Example policy configuration at <code>.yaze/policies/agent.yaml</code></li>
</ul>
</li>
<li><b>‚úÖ E2E Validation Complete</b>: All 5 functional RPC tests passing (Ping, Click, Type, Wait, Assert)<ul>
<li>Window detection timing issue <b>resolved</b> with 10-frame yield buffer in Wait RPC</li>
<li>Thread safety issues <b>resolved</b> with shared_ptr state management</li>
<li>Test harness validated on macOS ARM64 with real YAZE GUI interactions</li>
</ul>
</li>
<li><b>gRPC Test Harness (IT-01 &amp; IT-02)</b>: Full implementation complete with natural language ‚Üí GUI testing</li>
<li><b>‚úÖ Test Recording &amp; Replay (IT-07)</b>: JSON recorder/replayer implemented, CLI and harness wired, end-to-end regression workflow captured in <code>scripts/test_record_replay_e2e.sh</code></li>
<li><b>Build System</b>: Hardened CMake configuration with reliable gRPC integration</li>
<li><b>Proposal Workflow</b>: Agentic proposal system fully operational (create, list, diff, review in GUI)</li>
</ul>
<p><b>Known Limitations &amp; Improvement Opportunities</b>:</p><ul>
<li><b>Screenshot Auto-Capture</b>: Manual RPC only ‚Üí needs integration with TestManager failure detection</li>
<li><b>Test Introspection</b>: ‚úÖ Complete - GetTestStatus/ListTests/GetResults RPCs operational</li>
<li><b>Widget Discovery</b>: AI agents can't enumerate available widgets ‚Üí add DiscoverWidgets RPC</li>
<li><b>Test Recording</b>: No record/replay for regression testing ‚Üí add RecordSession/ReplaySession RPCs</li>
<li><b>Synchronous Wait</b>: Async tests return immediately ‚Üí add blocking mode or result polling</li>
<li><b>Error Context</b>: Test failures lack screenshots/state dumps ‚Üí enhance error reporting</li>
<li><b>Performance</b>: Tests add ~166ms per Wait call due to frame yielding (acceptable trade-off)</li>
<li><b>YAML Parsing</b>: Simple parser implemented, consider yaml-cpp for complex scenarios</li>
</ul>
<p><b>Time Investment</b>: 28.5 hours total (IT-01: 11h, IT-02: 7.5h, E2E: 2h, Policy: 6h, Docs: 2h)</p>
<h1><a class="anchor" id="autotoc_md1212"></a>
Quick Reference</h1>
<p><b>Start Test Harness</b>: </p><div class="fragment"><div class="line">./build-grpc-test/bin/yaze.app/Contents/MacOS/yaze \</div>
<div class="line">  --enable_test_harness \</div>
<div class="line">  --test_harness_port=50052 \</div>
<div class="line">  --rom_file=assets/zelda3.sfc &amp;</div>
</div><!-- fragment --><p><b>Test All RPCs</b>: </p><div class="fragment"><div class="line">./scripts/test_harness_e2e.sh</div>
</div><!-- fragment --><p><b>Create Proposal</b>: </p><div class="fragment"><div class="line">./build/bin/z3ed agent run &quot;Test prompt&quot; --sandbox</div>
<div class="line">./build/bin/z3ed agent list</div>
<div class="line">./build/bin/z3ed agent diff --proposal-id &lt;ID&gt;</div>
</div><!-- fragment --><p><b>Review in GUI</b>:</p><ul>
<li>Open YAZE ‚Üí <code>Debug ‚Üí Agent Proposals</code></li>
<li>Select proposal ‚Üí Review ‚Üí Accept/Reject/Delete</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md1214"></a>
1. Current Priorities (Week of Oct 2-8, 2025)</h1>
<p><b>Status</b>: Core Infrastructure Complete ‚úÖ | Test Harness Enhancement Phase üîß</p>
<h2><a class="anchor" id="autotoc_md1215"></a>
Priority 1: Test Harness Enhancements (IT-05 to IT-09) üîß ACTIVE</h2>
<p><b>Goal</b>: Transform test harness from basic automation to comprehensive testing platform <b>and deliver holistic error reporting across YAZE</b> <br  />
 <b>Time Estimate</b>: 20-25 hours total (7.5h completed in IT-07) <br  />
 <b>Blocking Dependency</b>: IT-01 Complete ‚úÖ</p>
<p><b>Motivation</b>: The harness now supports AI workflows, regression capture, and automation‚Äîbut error surfaces remain shallow:</p><ul>
<li><b>AI Agent Development</b>: Still needs widget discovery for adaptive planning</li>
<li><b>Regression Testing</b>: Recording/replay finished; reporting pipeline must surface actionable failures</li>
<li><b>CI/CD Integration</b>: Requires reliable artifacts (logs, screenshots, structured context)</li>
<li><b>Debugging</b>: Failures lack screenshots, widget hierarchies, and EditorManager state snapshots</li>
<li><b>Application Consistency</b>: z3ed, EditorManager, and core services emit heterogeneous error formats</li>
</ul>
<h3><a class="anchor" id="autotoc_md1216"></a>
IT-05: Test Introspection API (6-8 hours)</h3>
<p><b>Status (Oct 2, 2025)</b>: üü° <em>Server-side RPCs implemented; CLI + E2E pending</em></p>
<p><b>Progress</b>:</p><ul>
<li>‚úÖ <code>imgui_test_harness.proto</code> expanded with GetTestStatus/ListTests/GetTestResults messages.</li>
<li>‚úÖ <code>TestManager</code> maintains execution history (queued‚Üírunning‚Üícompleted) with logs, metrics, and aggregates.</li>
<li>‚úÖ <code>ImGuiTestHarnessServiceImpl</code> exposes the three introspection RPCs with pagination, status conversion, and log/metric marshalling.</li>
<li>‚ö†Ô∏è <code>agent</code> CLI commands (<code>test status</code>, <code>test list</code>, <code>test results</code>) still stubbed.</li>
<li>‚ö†Ô∏è End-to-end introspection script (<code>scripts/test_introspection_e2e.sh</code>) not implemented; regression script <code>test_harness_e2e.sh</code> currently failing because it references the unfinished CLI.</li>
</ul>
<p><b>Immediate Next Steps</b>:</p><ol type="1">
<li><b>Wire CLI Client Methods</b><ul>
<li>Implement gRPC client wrappers for the new RPCs in the automation client.</li>
<li>Add user-facing commands under <code>z3ed agent test ...</code> with JSON/YAML output options.</li>
</ul>
</li>
<li><b>Author E2E Validation Script</b><ul>
<li>Spin up harness, run Click/Assert workflow, poll via <code>agent test status</code>, fetch results.</li>
<li>Update CI notes with the new script and expected output.</li>
</ul>
</li>
<li><b>Documentation &amp; Examples</b><ul>
<li>Extend <code><a class="el" href="../../db/d7d/E6-z3ed-reference_8md.html">E6-z3ed-reference.md</a></code> with full usage examples and sample outputs.</li>
<li>Add troubleshooting section covering common errors (unknown test_id, timeout, etc.).</li>
</ul>
</li>
<li><b>Stretch (Optional Before IT-06)</b><ul>
<li>Capture assertion metadata (expected/actual) for richer <code>AssertionResult</code> payloads.</li>
</ul>
</li>
</ol>
<p><b>Example Usage</b>: </p><div class="fragment"><div class="line"># Queue a test</div>
<div class="line">z3ed agent test --prompt &quot;Open Overworld editor&quot;</div>
<div class="line"> </div>
<div class="line"># Poll for completion</div>
<div class="line">z3ed test status --test-id grpc_click_12345678</div>
<div class="line"> </div>
<div class="line"># Retrieve results</div>
<div class="line">z3ed test results --test-id grpc_click_12345678 --format json</div>
</div><!-- fragment --><p><b>API Schema</b>: </p><div class="fragment"><div class="line">message GetTestStatusRequest {</div>
<div class="line">  string test_id = 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">message GetTestStatusResponse {</div>
<div class="line">  enum Status { QUEUED = 0; RUNNING = 1; PASSED = 2; FAILED = 3; TIMEOUT = 4; }</div>
<div class="line">  Status status = 1;</div>
<div class="line">  int64 execution_time_ms = 2;</div>
<div class="line">  string error_message = 3;</div>
<div class="line">  repeated string assertion_failures = 4;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">message ListTestsRequest {</div>
<div class="line">  string category_filter = 1;  // Optional: &quot;grpc&quot;, &quot;unit&quot;, etc.</div>
<div class="line">  int32 page_size = 2;</div>
<div class="line">  string page_token = 3;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">message ListTestsResponse {</div>
<div class="line">  repeated TestInfo tests = 1;</div>
<div class="line">  string next_page_token = 2;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">message TestInfo {</div>
<div class="line">  string test_id = 1;</div>
<div class="line">  string name = 2;</div>
<div class="line">  string category = 3;</div>
<div class="line">  int64 last_run_timestamp_ms = 4;</div>
<div class="line">  int32 total_runs = 5;</div>
<div class="line">  int32 pass_count = 6;</div>
<div class="line">  int32 fail_count = 7;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1217"></a>
IT-06: Widget Discovery API (4-6 hours)</h3>
<p><b>Implementation Tasks</b>:</p><ol type="1">
<li><b>Add DiscoverWidgets RPC</b>:<ul>
<li>Enumerate all windows currently open in YAZE GUI</li>
<li>List all interactive widgets (buttons, inputs, menus, tabs) per window</li>
<li>Return widget metadata: ID, type, label, enabled state, position</li>
<li>Support filtering by window name or widget type</li>
</ul>
</li>
<li><b>AI-Friendly Output Format</b>:<ul>
<li>JSON schema describing available interactions</li>
<li>Natural language descriptions for each widget</li>
<li>Suggested action templates (e.g., "Click button:{label}")</li>
</ul>
</li>
</ol>
<p><b>Example Usage</b>: </p><div class="fragment"><div class="line"># Discover all widgets</div>
<div class="line">z3ed gui discover</div>
<div class="line"> </div>
<div class="line"># Filter by window</div>
<div class="line">z3ed gui discover --window &quot;Overworld&quot;</div>
<div class="line"> </div>
<div class="line"># Get only buttons</div>
<div class="line">z3ed gui discover --type button</div>
</div><!-- fragment --><p><b>API Schema</b>: </p><div class="fragment"><div class="line">message DiscoverWidgetsRequest {</div>
<div class="line">  string window_filter = 1;  // Optional: filter by window name</div>
<div class="line">  enum WidgetType { ALL = 0; BUTTON = 1; INPUT = 2; MENU = 3; TAB = 4; CHECKBOX = 5; }</div>
<div class="line">  WidgetType type_filter = 2;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">message DiscoverWidgetsResponse {</div>
<div class="line">  repeated WindowInfo windows = 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">message WindowInfo {</div>
<div class="line">  string name = 1;</div>
<div class="line">  bool is_visible = 2;</div>
<div class="line">  repeated WidgetInfo widgets = 3;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">message WidgetInfo {</div>
<div class="line">  string id = 1;</div>
<div class="line">  string label = 2;</div>
<div class="line">  string type = 3;  // &quot;button&quot;, &quot;input&quot;, &quot;menu&quot;, etc.</div>
<div class="line">  bool is_enabled = 4;</div>
<div class="line">  string position = 5;  // &quot;x,y,width,height&quot;</div>
<div class="line">  string suggested_action = 6;  // &quot;Click button:Open ROM&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Benefits for AI Agents</b>:</p><ul>
<li>LLMs can dynamically learn available GUI interactions</li>
<li>Agents can adapt to UI changes without hardcoded widget names</li>
<li>Natural language descriptions enable better prompt engineering</li>
</ul>
<h3><a class="anchor" id="autotoc_md1218"></a>
IT-07: Test Recording &amp; Replay ‚úÖ COMPLETE (Oct 2, 2025)</h3>
<p><b>Highlights</b>:</p><ul>
<li>Implemented <code>StartRecording</code>, <code>StopRecording</code>, and <code>ReplayTest</code> RPCs with persistent JSON scripts</li>
<li>Added CLI commands: <code>z3ed test record start|stop</code>, <code>z3ed test replay</code></li>
<li>Scripts stored in <code>tests/gui/</code> with metadata (name, tags, assertions, timing hints)</li>
<li>Added regression coverage via <code>scripts/test_record_replay_e2e.sh</code></li>
<li>Documentation updates in <code><a class="el" href="../../db/d7d/E6-z3ed-reference_8md.html">E6-z3ed-reference.md</a></code> and new quick-start snippets in README</li>
<li>Confirmed compatibility with natural language prompts generated by the agent workflow</li>
</ul>
<p><b>Outcome</b>: Recording/replay is production-ready; focus shifts to surfacing rich failure diagnostics (IT-08).</p>
<h3><a class="anchor" id="autotoc_md1219"></a>
IT-08: Enhanced Error Reporting (5-7 hours) ‚úÖ COMPLETE</h3>
<p><b>Status</b>: IT-08a Complete ‚úÖ | IT-08b Complete ‚úÖ | IT-08c Complete ‚úÖ <b>Objective</b>: Deliver a unified, high-signal error reporting pipeline spanning ImGuiTestHarness, z3ed CLI, EditorManager, and core application services.</p>
<p><b>Implementation Tracks</b>:</p><ol type="1">
<li><b>Harness-Level Diagnostics</b><ul>
<li>‚úÖ IT-08a: Screenshot RPC implemented (SDL-based, BMP format, 1536x864)</li>
<li>‚úÖ IT-08b: Auto-capture screenshots and context on test failure</li>
<li>ÔøΩ IT-08c: Widget tree dumps and recent <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> events on failure (NEXT)</li>
<li>Serialize results to both structured JSON (for automation) and human-friendly HTML bundles</li>
<li>Persist artifacts under <code>test-results/&lt;test_id&gt;/</code> with timestamped directories</li>
</ul>
</li>
<li><b>CLI Experience Improvements</b><ul>
<li>Standardize error envelopes in z3ed (<code>absl::Status</code> + structured payload)</li>
<li>Surface artifact paths, summarized failure reason, and next-step hints in CLI output</li>
<li>Add <code>--format html</code> / <code>--format json</code> flags to <code>z3ed agent test results</code> to emit richer context</li>
<li>Integrate with recording workflow: replay failures using captured state for fast reproduction</li>
</ul>
</li>
<li><b>EditorManager &amp; Application Integration</b><ul>
<li>Introduce shared <code>ErrorAnnotatedResult</code> utility exposing <code>status</code>, <code>context</code>, <code>actionable_hint</code></li>
<li>Adapt EditorManager subsystems (ProposalDrawer, OverworldEditor, DungeonEditor) to adopt the shared structure</li>
<li>Add in-app failure overlay (<a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> modal) that references harness artifacts when available</li>
<li>Hook proposal acceptance/replay flows to display enriched diagnostics when sandbox merges fail</li>
</ul>
</li>
<li><b>Telemetry &amp; Storage Hooks</b> (Stretch)<ul>
<li>Optionally emit error metadata to a ring buffer for future analytics/telemetry workstreams</li>
<li>Provide CLI flag <code>--error-artifact-dir</code> to customize storage (supports CI separation)</li>
</ul>
</li>
</ol>
<p><b>Error Report Example</b>: </p><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;test_id&quot;: &quot;grpc_assert_12345678&quot;,</div>
<div class="line">  &quot;failure_time&quot;: &quot;2025-10-02T14:23:45Z&quot;,</div>
<div class="line">  &quot;assertion&quot;: &quot;visible:Overworld&quot;,</div>
<div class="line">  &quot;expected&quot;: &quot;visible&quot;,</div>
<div class="line">  &quot;actual&quot;: &quot;hidden&quot;,</div>
<div class="line">  &quot;screenshot&quot;: &quot;/tmp/yaze_test_12345678.png&quot;,</div>
<div class="line">  &quot;widget_state&quot;: {</div>
<div class="line">    &quot;active_window&quot;: &quot;Main Window&quot;,</div>
<div class="line">    &quot;focused_widget&quot;: null,</div>
<div class="line">    &quot;visible_windows&quot;: [&quot;Main Window&quot;, &quot;Debug&quot;],</div>
<div class="line">    &quot;overworld_window&quot;: { &quot;exists&quot;: true, &quot;visible&quot;: false, &quot;position&quot;: &quot;0,0,0,0&quot; }</div>
<div class="line">  },</div>
<div class="line">  &quot;execution_context&quot;: {</div>
<div class="line">    &quot;frame_count&quot;: 1234,</div>
<div class="line">    &quot;recent_events&quot;: [&quot;Click: menuitem: Overworld Editor&quot;, &quot;Wait: window_visible:Overworld&quot;],</div>
<div class="line">    &quot;resource_stats&quot;: { &quot;memory_mb&quot;: 245, &quot;textures&quot;: 12, &quot;framerate&quot;: 60.0 },</div>
<div class="line">    &quot;editor_manager_snapshot&quot;: {</div>
<div class="line">      &quot;active_module&quot;: &quot;OverworldEditor&quot;,</div>
<div class="line">      &quot;dirty_buffers&quot;: [&quot;overworld_layer_1&quot;],</div>
<div class="line">      &quot;last_error&quot;: null</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1220"></a>
IT-09: CI/CD Integration (2-3 hours)</h3>
<p><b>Implementation Tasks</b>:</p><ol type="1">
<li><b>Standardized Test Suite Format</b>:<ul>
<li>YAML/JSON format for test suite definitions</li>
<li>Support test groups (smoke, regression, nightly)</li>
<li>Enable parallel execution with dependencies</li>
</ul>
</li>
<li><b>CI-Friendly CLI</b>:<ul>
<li><code>z3ed test run-suite tests/suite.yaml --ci-mode</code></li>
<li>Exit codes: 0 = all passed, 1 = failures, 2 = errors</li>
<li>JUnit XML output for CI parsers</li>
<li>GitHub Actions integration examples</li>
</ul>
</li>
<li><b>Documentation</b>:<ul>
<li>Add <code>.github/workflows/gui-tests.yml</code> example</li>
<li>Create sample test suites for common scenarios</li>
<li>Document best practices for flaky test handling</li>
</ul>
</li>
</ol>
<p><b>Test Suite Format</b>: </p><div class="fragment"><div class="line">name: YAZE GUI Test Suite</div>
<div class="line">description: Comprehensive tests for YAZE editor functionality</div>
<div class="line">version: 1.0</div>
<div class="line"> </div>
<div class="line">config:</div>
<div class="line">  timeout_per_test: 30s</div>
<div class="line">  retry_on_failure: 2</div>
<div class="line">  parallel_execution: false</div>
<div class="line"> </div>
<div class="line">test_groups:</div>
<div class="line">  - name: smoke</div>
<div class="line">    description: Fast tests for basic functionality</div>
<div class="line">    tests:</div>
<div class="line">      - tests/overworld_load.json</div>
<div class="line">      - tests/dungeon_load.json</div>
<div class="line">  </div>
<div class="line">  - name: regression</div>
<div class="line">    description: Full test suite for release validation</div>
<div class="line">    depends_on: [smoke]</div>
<div class="line">    tests:</div>
<div class="line">      - tests/palette_edit.json</div>
<div class="line">      - tests/sprite_load.json</div>
<div class="line">      - tests/rom_save.json</div>
</div><!-- fragment --><p><b>GitHub Actions Integration</b>: </p><div class="fragment"><div class="line">name: GUI Tests</div>
<div class="line">on: [push, pull_request]</div>
<div class="line"> </div>
<div class="line">jobs:</div>
<div class="line">  gui-tests:</div>
<div class="line">    runs-on: macos-latest</div>
<div class="line">    steps:</div>
<div class="line">      - uses: actions/checkout@v2</div>
<div class="line">      - name: Build YAZE with test harness</div>
<div class="line">        run: |</div>
<div class="line">          cmake -B build -DYAZE_WITH_GRPC=ON</div>
<div class="line">          cmake --build build --target yaze --target z3ed</div>
<div class="line">      - name: Start test harness</div>
<div class="line">        run: |</div>
<div class="line">          ./build/bin/yaze --enable_test_harness --headless &amp;</div>
<div class="line">          sleep 5</div>
<div class="line">      - name: Run test suite</div>
<div class="line">        run: |</div>
<div class="line">          ./build/bin/z3ed test run-suite tests/suite.yaml --ci-mode</div>
<div class="line">      - name: Upload test results</div>
<div class="line">        if: always()</div>
<div class="line">        uses: actions/upload-artifact@v2</div>
<div class="line">        with:</div>
<div class="line">          name: test-results</div>
<div class="line">          path: test-results/</div>
</div><!-- fragment --><hr  />
<h3><a class="anchor" id="autotoc_md1222"></a>
IT-10: Collaborative Editing &amp; Multiplayer Sessions (12-15 hours)</h3>
<p><b>Implementation Tasks</b>:</p><ol type="1">
<li><b>Collaboration Server</b>:<ul>
<li>WebSocket server for real-time client communication</li>
<li>Session management (create, join, authentication)</li>
<li>Edit event broadcasting to all connected clients</li>
<li>Conflict resolution (last-write-wins with timestamps)</li>
</ul>
</li>
<li><b>Collaboration Client</b>:<ul>
<li>Connect to remote sessions via WebSocket</li>
<li>Send local edits to server</li>
<li>Receive and apply remote edits</li>
<li>ROM state synchronization on join</li>
</ul>
</li>
<li><b>Edit Event Protocol</b>:<ul>
<li>Protobuf definitions for edit events (tile, sprite, palette, map)</li>
<li>Cursor position tracking</li>
<li>AI proposal sharing and voting</li>
<li>Session state messages</li>
</ul>
</li>
<li><b>GUI Integration</b>:<ul>
<li>Status bar showing connected users</li>
<li>Collaboration panel (user list, activity feed)</li>
<li>Live cursor rendering (color-coded per user)</li>
<li>Proposal voting UI (Accept/Reject/Discuss)</li>
</ul>
</li>
<li><b>Session Recording &amp; Replay</b>:<ul>
<li>Record all events to YAML/JSON file</li>
<li>Replay engine with timeline controls</li>
<li>Export session summaries for review</li>
</ul>
</li>
</ol>
<p><b>CLI Commands</b>: </p><div class="fragment"><div class="line"># Host a collaborative session</div>
<div class="line">z3ed collab host --port 5000 --password &quot;dev123&quot;</div>
<div class="line"> </div>
<div class="line"># Join a session</div>
<div class="line">z3ed collab join yaze://connect/192.168.1.100:5000</div>
<div class="line"> </div>
<div class="line"># List active sessions (LAN discovery)</div>
<div class="line">z3ed collab list</div>
<div class="line"> </div>
<div class="line"># Disconnect from session</div>
<div class="line">z3ed collab disconnect</div>
<div class="line"> </div>
<div class="line"># Replay recorded session</div>
<div class="line">z3ed collab replay session_2025_10_02.yaml --speed 2x</div>
</div><!-- fragment --><p><b>User Stories</b>:</p><ul>
<li><b>US-1</b>: As a ROM hacker, I want to host a collaborative session so my teammates can join and work together</li>
<li><b>US-2</b>: As a collaborator, I want to see other users' edits in real-time so we stay synchronized</li>
<li><b>US-3</b>: As a team lead, I want to use AI agents with my team so we can all benefit from automation (shared proposals with majority voting)</li>
<li><b>US-4</b>: As a collaborator, I want to see where other users are working so we don't conflict (live cursors)</li>
<li><b>US-5</b>: As a project manager, I want to record collaborative sessions so we can review work later</li>
</ul>
<p><b>Benefits</b>:</p><ul>
<li><b>Real-Time Collaboration</b>: Multiple users can edit the same ROM simultaneously</li>
<li><b>Shared AI Assistance</b>: Team votes on AI proposals before execution</li>
<li><b>Conflict Prevention</b>: Live cursors show where teammates are working</li>
<li><b>Audit Trail</b>: Session recording for review and compliance</li>
<li><b>Remote Teams</b>: Connect over LAN or internet (with optional encryption)</li>
</ul>
<p><b>Technical Architecture</b>: </p><div class="fragment"><div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ  Client A    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ  Collab Server  ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  Client B    ‚îÇ</div>
<div class="line">‚îÇ  (Host)      ‚îÇ     ‚îÇ  (WebSocket)    ‚îÇ     ‚îÇ              ‚îÇ</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ                 ‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line">                     ‚îÇ  - Session Mgmt ‚îÇ</div>
<div class="line">                     ‚îÇ  - Event Broker ‚îÇ     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">                     ‚îÇ  - Conflict Res ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  Client C    ‚îÇ</div>
<div class="line">                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
</div><!-- fragment --><p><b>Security Considerations</b>:</p><ul>
<li>Optional password protection for sessions</li>
<li>Read-only vs read-write access levels</li>
<li>ROM checksum verification (prevents desync)</li>
<li>Rate limiting (prevent spam/DOS)</li>
<li>Optional TLS/SSL encryption for public internet</li>
</ul>
<p><b>See</b>: <a class="el" href="../../de/d5d/md_docs_2z3ed_2IT-10-COLLABORATIVE-EDITING.html">IT-10-COLLABORATIVE-EDITING.md</a> for complete specification</p>
<hr  />
<h2><a class="anchor" id="autotoc_md1224"></a>
Priority 2: Windows Cross-Platform Testing ü™ü</h2>
<p><b>Goal</b>: Validate z3ed and test harness on Windows <br  />
 <b>Time Estimate</b>: 8-10 hours <br  />
 <b>Blocking Dependency</b>: IT-05 Complete (need stable API)</p>
<blockquote class="doxtable">
<p>&zwj;üìã <b>Detailed Guides</b>: See NEXT_PRIORITIES_OCT2.md for complete implementation breakdowns with code examples. </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md1225"></a>
&lt;/blockquote&gt;</h1>
<h1><a class="anchor" id="autotoc_md1226"></a>
2. Workstreams Overview</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Workstream   </th><th class="markdownTableHeadNone">Goal   </th><th class="markdownTableHeadNone">Status   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Resource Catalogue   </td><td class="markdownTableBodyNone">Machine-readable CLI specs for AI consumption   </td><td class="markdownTableBodyNone">‚úÖ Complete   </td><td class="markdownTableBodyNone"><code>docs/api/z3ed-resources.yaml</code> generated    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Acceptance Workflow   </td><td class="markdownTableBodyNone">Human review/approval of agent proposals   </td><td class="markdownTableBodyNone">‚úÖ Complete   </td><td class="markdownTableBodyNone">ProposalDrawer with ROM merging operational    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Automated GUI testing via gRPC   </td><td class="markdownTableBodyNone">‚úÖ Complete   </td><td class="markdownTableBodyNone">All 3 phases done (11 hours)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Verification Pipeline   </td><td class="markdownTableBodyNone">Layered testing + CI coverage   </td><td class="markdownTableBodyNone">üìã In Progress   </td><td class="markdownTableBodyNone">E2E validation phase    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Telemetry &amp; Learning   </td><td class="markdownTableBodyNone">Capture signals for improvement   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">Optional/opt-in (Phase 8)   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1227"></a>
Completed Work Summary</h2>
<p><b>Resource Catalogue (RC)</b> ‚úÖ:</p><ul>
<li>CLI flag passthrough and resource catalog system</li>
<li><code>agent describe</code> exports YAML/JSON schemas</li>
<li><code>docs/api/z3ed-resources.yaml</code> maintained</li>
<li>All ROM/Palette/Overworld/Dungeon/Patch commands documented</li>
</ul>
<p><b>Acceptance Workflow (AW-01/02/03)</b> ‚úÖ:</p><ul>
<li><code>ProposalRegistry</code> with disk persistence and cross-session tracking</li>
<li><code>RomSandboxManager</code> for isolated ROM copies</li>
<li><code>agent list</code> and <code>agent diff</code> commands</li>
<li><b>ProposalDrawer GUI</b>: List/detail views, Accept/Reject/Delete, ROM merging</li>
<li>Integrated into EditorManager (<code>Debug ‚Üí Agent Proposals</code>)</li>
</ul>
<p><b>ImGuiTestHarness (IT-01)</b> ‚úÖ:</p><ul>
<li>Phase 1: gRPC infrastructure (6 RPC methods)</li>
<li>Phase 2: TestManager integration with dynamic tests</li>
<li>Phase 3: Full ImGuiTestEngine (Type/Wait/Assert RPCs)</li>
<li>E2E test script: <code>scripts/test_harness_e2e.sh</code></li>
<li>Documentation: IT-01-QUICKSTART.md</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md1229"></a>
3. Task Backlog</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">ID   </th><th class="markdownTableHeadNone">Task   </th><th class="markdownTableHeadNone">Workstream   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Status   </th><th class="markdownTableHeadNone">Dependencies    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RC-01   </td><td class="markdownTableBodyNone">Define schema for <code>ResourceCatalog</code> entries and implement serialization helpers.   </td><td class="markdownTableBodyNone">Resource Catalogue   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">Schema system complete with all resource types documented    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RC-02   </td><td class="markdownTableBodyNone">Auto-generate <code>docs/api/z3ed-resources.yaml</code> from command annotations.   </td><td class="markdownTableBodyNone">Resource Catalogue   </td><td class="markdownTableBodyNone">Tooling   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">Generated and committed to docs/api/    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RC-03   </td><td class="markdownTableBodyNone">Implement <code>z3ed agent describe</code> CLI surface returning JSON schemas.   </td><td class="markdownTableBodyNone">Resource Catalogue   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">Both YAML and JSON output formats working    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RC-04   </td><td class="markdownTableBodyNone">Integrate schema export with TUI command palette + help overlays.   </td><td class="markdownTableBodyNone">Resource Catalogue   </td><td class="markdownTableBodyNone">UX   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">RC-03    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RC-05   </td><td class="markdownTableBodyNone">Harden CLI command routing/flag parsing to unblock agent automation.   </td><td class="markdownTableBodyNone">Resource Catalogue   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">Fixed rom info handler to use FLAGS_rom    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">AW-01   </td><td class="markdownTableBodyNone">Implement sandbox ROM cloning and tracking (<code>RomSandboxManager</code>).   </td><td class="markdownTableBodyNone">Acceptance Workflow   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">ROM sandbox manager operational with lifecycle management    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">AW-02   </td><td class="markdownTableBodyNone">Build proposal registry service storing diffs, logs, screenshots.   </td><td class="markdownTableBodyNone">Acceptance Workflow   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">ProposalRegistry implemented with disk persistence    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">AW-03   </td><td class="markdownTableBodyNone">Add <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> drawer for proposals with accept/reject controls.   </td><td class="markdownTableBodyNone">Acceptance Workflow   </td><td class="markdownTableBodyNone">UX   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">ProposalDrawer GUI complete with ROM merging    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">AW-04   </td><td class="markdownTableBodyNone">Implement policy evaluation for gating accept buttons.   </td><td class="markdownTableBodyNone">Acceptance Workflow   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">PolicyEvaluator service with 4 policy types (test, constraint, forbidden, review), GUI integration complete (6 hours)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">AW-05   </td><td class="markdownTableBodyNone">Draft <code>.z3ed-diff</code> hybrid schema (binary deltas + JSON metadata).   </td><td class="markdownTableBodyNone">Acceptance Workflow   </td><td class="markdownTableBodyNone">Design   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">AW-01    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IT-01   </td><td class="markdownTableBodyNone">Create <code>ImGuiTestHarness</code> IPC service embedded in <code>yaze_test</code>.   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">Phase 1+2+3 Complete - Full GUI automation with gRPC + ImGuiTestEngine (11 hours)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IT-02   </td><td class="markdownTableBodyNone">Implement CLI agent step translation (<code>imgui_action</code> ‚Üí harness call).   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone"><code>z3ed agent test</code> command with natural language prompts (7.5 hours)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IT-03   </td><td class="markdownTableBodyNone">Provide synchronization primitives (<code>WaitForIdle</code>, etc.).   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">Wait RPC with condition polling already implemented in IT-01 Phase 3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IT-04   </td><td class="markdownTableBodyNone">Complete E2E validation with real YAZE widgets   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Test   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">IT-02 - All 5 functional tests passing, window detection fixed with yield buffer    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IT-05   </td><td class="markdownTableBodyNone">Add test introspection RPCs (GetTestStatus, ListTests, GetResults)   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">IT-01 - Enable clients to poll test results and query execution state (Oct 2, 2025)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IT-06   </td><td class="markdownTableBodyNone">Implement widget discovery API for AI agents   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">IT-01 - DiscoverWidgets RPC to enumerate windows, buttons, inputs    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IT-07   </td><td class="markdownTableBodyNone">Add test recording/replay for regression testing   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">IT-05 - RecordSession/ReplaySession RPCs with JSON test scripts    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IT-08   </td><td class="markdownTableBodyNone">Enhance error reporting with screenshots and state dumps   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">üîÑ Active   </td><td class="markdownTableBodyNone">IT-01 - Capture widget state on failure for debugging (67% complete: IT-08a ‚úÖ, IT-08b ‚úÖ, IT-08c üîÑ)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IT-08a   </td><td class="markdownTableBodyNone">Screenshot RPC implementation (SDL capture)   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">IT-01 - Screenshot capture complete (Oct 2, 2025)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IT-08b   </td><td class="markdownTableBodyNone">Auto-capture screenshots on test failure   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">‚úÖ Done   </td><td class="markdownTableBodyNone">IT-08a - Integrated with TestManager (Oct 2, 2025)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IT-08c   </td><td class="markdownTableBodyNone">Widget state dumps and execution context   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">ÔøΩ Active   </td><td class="markdownTableBodyNone">IT-08b - Enhanced failure diagnostics (NEXT PRIORITY)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IT-09   </td><td class="markdownTableBodyNone">Create standardized test suite format for CI integration   </td><td class="markdownTableBodyNone">ImGuiTest Bridge   </td><td class="markdownTableBodyNone">Infra   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">IT-07 - JSON/YAML test suite format compatible with CI/CD pipelines    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IT-10   </td><td class="markdownTableBodyNone">Collaborative editing &amp; multiplayer sessions with shared AI   </td><td class="markdownTableBodyNone">Collaboration   </td><td class="markdownTableBodyNone">Feature   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">IT-05, IT-08 - Real-time multi-user editing with live cursors, shared proposals (12-15 hours)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">VP-01   </td><td class="markdownTableBodyNone">Expand CLI unit tests for new commands and sandbox flow.   </td><td class="markdownTableBodyNone">Verification Pipeline   </td><td class="markdownTableBodyNone">Test   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">RC/AW tasks    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VP-02   </td><td class="markdownTableBodyNone">Add harness integration tests with replay scripts.   </td><td class="markdownTableBodyNone">Verification Pipeline   </td><td class="markdownTableBodyNone">Test   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">IT tasks    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">VP-03   </td><td class="markdownTableBodyNone">Create CI job running agent smoke tests with <code>YAZE_WITH_JSON</code>.   </td><td class="markdownTableBodyNone">Verification Pipeline   </td><td class="markdownTableBodyNone">Infra   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">VP-01, VP-02    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TL-01   </td><td class="markdownTableBodyNone">Capture accept/reject metadata and push to telemetry log.   </td><td class="markdownTableBodyNone">Telemetry &amp; Learning   </td><td class="markdownTableBodyNone">Code   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">AW tasks    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TL-02   </td><td class="markdownTableBodyNone">Build anonymized metrics exporter + opt-in toggle.   </td><td class="markdownTableBodyNone">Telemetry &amp; Learning   </td><td class="markdownTableBodyNone">Infra   </td><td class="markdownTableBodyNone">üìã Planned   </td><td class="markdownTableBodyNone">TL-01   </td></tr>
</table>
<p><em>Status Legend: üîÑ Active ¬∑ üìã Planned ¬∑ ‚úÖ Done</em></p>
<p><b>Progress Summary</b>:</p><ul>
<li>‚úÖ Completed: 13 tasks (54%)</li>
<li>üîÑ Active: 0 tasks (0%)</li>
<li>üìã Planned: 11 tasks (46%)</li>
<li><b>Total</b>: 24 tasks (6 test harness enhancements + 1 collaborative feature)</li>
</ul>
<h1><a class="anchor" id="autotoc_md1230"></a>
3. Immediate Next Steps (Week of Oct 1-7, 2025)</h1>
<h2><a class="anchor" id="autotoc_md1231"></a>
Priority 0: Testing &amp; Validation (Active)</h2>
<ol type="1">
<li><b>TEST</b>: Complete end-to-end proposal workflow<ul>
<li>Launch YAZE and verify ProposalDrawer displays live proposals</li>
<li>Test Accept action ‚Üí verify ROM merge and save prompt</li>
<li>Test Reject and Delete actions</li>
<li>Validate filtering and refresh functionality</li>
</ul>
</li>
<li><b>Widget ID Refactoring</b> (Started Oct 2, 2025) üéØ NEW<ul>
<li>‚úÖ Added widget_id_registry to build system</li>
<li>‚úÖ Registered 13 Overworld toolset buttons with hierarchical IDs</li>
<li>üìã Next: Test widget discovery and update test harness</li>
<li>See: WIDGET_ID_REFACTORING_PROGRESS.md</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md1232"></a>
Priority 1: ImGuiTestHarness Foundation (IT-01) ‚úÖ COMPLETE</h2>
<p><b>Rationale</b>: Required for automated GUI testing and remote control of YAZE for AI workflows <br  />
 <b>Decision</b>: ‚úÖ <b>Use gRPC</b> - Production-grade, cross-platform, type-safe (see <code>IT-01-grpc-evaluation.md</code>)</p>
<p><b>Status</b>: Phase 1 Complete ‚úÖ | Phase 2 Complete ‚úÖ | Phase 3 Planned ÔøΩ</p>
<h3><a class="anchor" id="autotoc_md1233"></a>
Phase 1: gRPC Infrastructure ‚úÖ COMPLETE</h3>
<ul>
<li>‚úÖ Add gRPC to build system via FetchContent</li>
<li>‚úÖ Create .proto schema (Ping, Click, Type, Wait, Assert, Screenshot)</li>
<li>‚úÖ Implement gRPC server with all 6 RPC stubs</li>
<li>‚úÖ Test with grpcurl - all RPCs responding</li>
<li>‚úÖ Server lifecycle management (Start/Shutdown)</li>
<li>‚úÖ Cross-platform build verified (macOS ARM64)</li>
</ul>
<p><b>See</b>: <code>GRPC_TEST_SUCCESS.md</code> for Phase 1 completion details</p>
<h3><a class="anchor" id="autotoc_md1234"></a>
Phase 2: ImGuiTestEngine Integration ‚úÖ COMPLETE</h3>
<p><b>Goal</b>: Replace stub RPC handlers with actual GUI automation <br  />
 <b>Status</b>: Infrastructure complete, dynamic test registration implemented <br  />
 <b>Time Spent</b>: ~4 hours</p>
<p><b>Implementation Guide</b>: üìñ <b>IT-01-PHASE2-IMPLEMENTATION-GUIDE.md</b></p>
<p><b>Completed Tasks</b>:</p><ol type="1">
<li>‚úÖ <b>TestManager Integration</b> - gRPC service receives TestManager reference</li>
<li>‚úÖ <b>Build System</b> - Successfully compiles with ImGuiTestEngine support <br  />
</li>
<li>‚úÖ <b>Server Startup</b> - gRPC server starts correctly on macOS with test harness flag</li>
<li>‚úÖ <b>Dynamic Test Registration</b> - Click RPC uses <code>IM_REGISTER_TEST()</code> macro for dynamic tests</li>
<li>‚úÖ <b>Stub Handlers</b> - Type/Wait/Assert RPCs return success (implementation pending Phase 3)</li>
<li>‚úÖ <b>Ping RPC</b> - Fully functional, returns YAZE version and timestamp</li>
</ol>
<p><b>Key Learnings</b>:</p><ul>
<li>ImGuiTestEngine requires test registration - can't call test functions directly</li>
<li>Test context provided by engine via <code>test-&gt;Output.Status</code> not <code>test-&gt;Status</code></li>
<li>YAZE uses custom flag system with <code>FLAGS_name-&gt;Get()</code> pattern</li>
<li>Correct flags: <code>--enable_test_harness</code>, <code>--test_harness_port</code>, <code>--rom_file</code></li>
</ul>
<p><b>Testing Results</b>: </p><div class="fragment"><div class="line"># Server starts successfully</div>
<div class="line">./build-grpc-test/bin/yaze.app/Contents/MacOS/yaze \</div>
<div class="line">  --enable_test_harness \</div>
<div class="line">  --test_harness_port=50052 \</div>
<div class="line">  --rom_file=assets/zelda3.sfc &amp;</div>
<div class="line"> </div>
<div class="line"># Ping RPC working</div>
<div class="line">grpcurl -plaintext -d &#39;{&quot;message&quot;:&quot;test&quot;}&#39; \</div>
<div class="line">  127.0.0.1:50052 yaze.test.ImGuiTestHarness/Ping</div>
<div class="line"># Response: {&quot;message&quot;:&quot;Pong: test&quot;,&quot;timestampMs&quot;:&quot;...&quot;,&quot;yazeVersion&quot;:&quot;0.3.2&quot;}</div>
</div><!-- fragment --><p><b>Issues Fixed</b>:</p><ul>
<li>‚ùå‚Üí‚úÖ SIGSEGV on TestManager initialization (deferred ImGuiTestEngine init to Phase 3)</li>
<li>‚ùå‚Üí‚úÖ ImGuiTestEngine API mismatch (switched to dynamic test registration)</li>
<li>‚ùå‚Üí‚úÖ Status field access (corrected to <code>test-&gt;Output.Status</code>)</li>
<li>‚ùå‚Üí‚úÖ Port conflicts (use port 50052, <code>killall yaze</code> to cleanup)</li>
<li>‚ùå‚Üí‚úÖ Flag naming (documented correct underscore format)</li>
</ul>
<h3><a class="anchor" id="autotoc_md1235"></a>
Phase 3: Full ImGuiTestEngine Integration ‚úÖ COMPLETE (Oct 2, 2025)</h3>
<p><b>Goal</b>: Complete implementation of all GUI automation RPCs</p>
<p><b>Completed Tasks</b>:</p><ol type="1">
<li>‚úÖ <b>Type RPC Implementation</b> - Full text input automation<ul>
<li>ItemInfo API usage corrected (returns by value, not pointer)</li>
<li>Focus management with ItemClick before typing</li>
<li>Clear-first functionality with keyboard shortcuts</li>
<li>Dynamic test registration with timeout handling</li>
</ul>
</li>
<li>‚úÖ <b>Wait RPC Implementation</b> - Condition polling with timeout<ul>
<li>Three condition types: window_visible, element_visible, element_enabled</li>
<li>Configurable timeout (default 5000ms) and poll interval (default 100ms)</li>
<li>Proper Yield() calls to allow <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> event processing</li>
<li>Extended timeout for test execution</li>
</ul>
</li>
<li>‚úÖ <b>Assert RPC Implementation</b> - State validation with structured responses<ul>
<li>Multiple assertion types: visible, enabled, exists, text_contains</li>
<li>Actual vs expected value reporting</li>
<li>Detailed error messages for debugging</li>
<li>text_contains partially implemented (text retrieval needs refinement)</li>
</ul>
</li>
<li>‚úÖ <b>API Compatibility Fixes</b><ul>
<li>Corrected ItemInfo usage (by value, check ID != 0)</li>
<li>Fixed flag names (ItemFlags instead of StatusFlags)</li>
<li>Proper visibility checks using RectClipped dimensions</li>
<li>All dynamic tests properly registered and cleaned up</li>
</ul>
</li>
</ol>
<p><b>Testing</b>:</p><ul>
<li>Build successful on macOS ARM64</li>
<li>All RPCs respond correctly</li>
<li>Test script created: <code>scripts/test_harness_e2e.sh</code></li>
<li>See <code>IT-01-PHASE3-COMPLETE.md</code> for full implementation details</li>
</ul>
<p><b>Known Limitations</b>:</p><ul>
<li>Screenshot RPC not implemented (placeholder stub)</li>
<li>text_contains assertion uses placeholder text retrieval</li>
<li>Need end-to-end workflow testing with real YAZE widgets</li>
</ul>
<ol type="1">
<li><b>End-to-End Testing</b> (1 hour)<ul>
<li>Create shell script workflow: start server ‚Üí click button ‚Üí wait for window ‚Üí type text ‚Üí assert state</li>
<li>Test with real YAZE editors (Overworld, Dungeon, etc.)</li>
<li>Document edge cases and troubleshooting</li>
</ul>
</li>
</ol>
<h3><a class="anchor" id="autotoc_md1236"></a>
Phase 4: CLI Integration &amp; Windows Testing (4-5 hours)</h3>
<ol type="1">
<li><b>CLI Client</b> (<code>z3ed agent test</code>)<ul>
<li>Generate gRPC calls from AI prompts</li>
<li>Natural language ‚Üí <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> action translation</li>
<li>Screenshot capture for LLM feedback</li>
<li>Emit structured error envelopes with artifact links (IT-08)</li>
</ul>
</li>
<li><b>Windows Testing</b><ul>
<li>Detailed build instructions for vcpkg setup</li>
<li>Test on Windows VM or with contributor</li>
<li>Add Windows CI job to GitHub Actions</li>
<li>Document troubleshooting</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md1237"></a>
IT-01 Quick Reference</h2>
<p><b>Start YAZE with Test Harness</b>: </p><div class="fragment"><div class="line">./build-grpc-test/bin/yaze.app/Contents/MacOS/yaze \</div>
<div class="line">  --enable_test_harness \</div>
<div class="line">  --test_harness_port=50052 \</div>
<div class="line">  --rom_file=assets/zelda3.sfc &amp;</div>
</div><!-- fragment --><p><b>Test RPCs with grpcurl</b>: </p><div class="fragment"><div class="line"># Ping - Health check</div>
<div class="line">grpcurl -plaintext -import-path src/app/core/proto -proto imgui_test_harness.proto \</div>
<div class="line">  -d &#39;{&quot;message&quot;:&quot;test&quot;}&#39; 127.0.0.1:50052 yaze.test.ImGuiTestHarness/Ping</div>
<div class="line"> </div>
<div class="line"># Click - Click UI element</div>
<div class="line">grpcurl -plaintext -import-path src/app/core/proto -proto imgui_test_harness.proto \</div>
<div class="line">  -d &#39;{&quot;target&quot;:&quot;button:Overworld&quot;,&quot;type&quot;:&quot;LEFT&quot;}&#39; \</div>
<div class="line">  127.0.0.1:50052 yaze.test.ImGuiTestHarness/Click</div>
<div class="line"> </div>
<div class="line"># Type - Input text</div>
<div class="line">grpcurl -plaintext -import-path src/app/core/proto -proto imgui_test_harness.proto \</div>
<div class="line">  -d &#39;{&quot;target&quot;:&quot;input:Filename&quot;,&quot;text&quot;:&quot;zelda3.sfc&quot;,&quot;clear_first&quot;:true}&#39; \</div>
<div class="line">  127.0.0.1:50052 yaze.test.ImGuiTestHarness/Type</div>
<div class="line"> </div>
<div class="line"># Wait - Wait for condition</div>
<div class="line">grpcurl -plaintext -import-path src/app/core/proto -proto imgui_test_harness.proto \</div>
<div class="line">  -d &#39;{&quot;condition&quot;:&quot;window_visible:Overworld Editor&quot;,&quot;timeout_ms&quot;:5000}&#39; \</div>
<div class="line">  127.0.0.1:50052 yaze.test.ImGuiTestHarness/Wait</div>
<div class="line"> </div>
<div class="line"># Assert - Validate state</div>
<div class="line">grpcurl -plaintext -import-path src/app/core/proto -proto imgui_test_harness.proto \</div>
<div class="line">  -d &#39;{&quot;condition&quot;:&quot;visible:Main Window&quot;}&#39; \</div>
<div class="line">  127.0.0.1:50052 yaze.test.ImGuiTestHarness/Assert</div>
</div><!-- fragment --><p><b>Troubleshooting</b>:</p><ul>
<li><b>Port in use</b>: <code>killall yaze</code> or use <code>--test_harness_port=50053</code></li>
<li><b>Connection refused</b>: Check server started with <code>lsof -i :50052</code></li>
<li><b>Unrecognized flag</b>: Use underscores not hyphens (e.g., <code>--rom_file</code> not <code>--rom</code>)</li>
</ul>
<h2><a class="anchor" id="autotoc_md1238"></a>
Priority 2: Policy Evaluation Framework (AW-04, 4-6 hours)</h2>
<ol type="1">
<li><b>DESIGN</b>: YAML-based Policy Configuration <div class="fragment"><div class="line"># .yaze/policies/agent.yaml</div>
<div class="line">version: 1.0</div>
<div class="line">policies:</div>
<div class="line">  - name: require_tests</div>
<div class="line">    type: test_requirement</div>
<div class="line">    enabled: true</div>
<div class="line">    rules:</div>
<div class="line">      - test_suite: &quot;overworld_rendering&quot;</div>
<div class="line">        min_pass_rate: 0.95</div>
<div class="line">      - test_suite: &quot;palette_integrity&quot;</div>
<div class="line">        min_pass_rate: 1.0</div>
<div class="line">  </div>
<div class="line">  - name: limit_change_scope</div>
<div class="line">    type: change_constraint</div>
<div class="line">    enabled: true</div>
<div class="line">    rules:</div>
<div class="line">      - max_bytes_changed: 10240  # 10KB</div>
<div class="line">      - allowed_banks: [0x00, 0x01, 0x0E]  # Graphics banks only</div>
<div class="line">      - forbidden_ranges:</div>
<div class="line">        - start: 0xFFB0  # ROM header</div>
<div class="line">          end: 0xFFFF</div>
<div class="line">  </div>
<div class="line">  - name: human_review_required</div>
<div class="line">    type: review_requirement</div>
<div class="line">    enabled: true</div>
<div class="line">    rules:</div>
<div class="line">      - if: bytes_changed &gt; 1024</div>
<div class="line">        then: require_diff_review: true</div>
<div class="line">      - if: commands_executed &gt; 10</div>
<div class="line">        then: require_log_review: true</div>
</div><!-- fragment --></li>
<li><b>IMPLEMENT</b>: PolicyEvaluator Service<ul>
<li><code>src/cli/service/policy_evaluator.{h,cc}</code></li>
<li>Singleton service loads policies from <code>.yaze/policies/</code></li>
<li><code>EvaluateProposal(proposal_id) -&gt; PolicyResult</code></li>
<li>Returns: pass/fail + list of violations with severity</li>
<li>Hook into ProposalRegistry lifecycle</li>
</ul>
</li>
<li><b>INTEGRATE</b>: Policy UI in ProposalDrawer<ul>
<li>Add "Policy Status" section in detail view</li>
<li>Display violations with icons: ‚õî Critical, ‚ö†Ô∏è Warning, ‚ÑπÔ∏è Info</li>
<li>Gate Accept button: disabled if critical violations exist</li>
<li>Show helpful messages: "Accept blocked: Test pass rate 0.85 &lt; 0.95"</li>
<li>Allow policy overrides with confirmation: "Override policy? This action will be logged."</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md1239"></a>
Priority 3: Documentation &amp; Consolidation (2-3 hours)</h2>
<ol type="1">
<li><b>CONSOLIDATE</b>: Merge standalone docs into main plan<ul>
<li>‚úÖ AW-03 summary ‚Üí already in main plan, delete standalone doc</li>
<li>Check for other AW-* or task-specific docs to merge</li>
<li>Update main plan with architecture diagrams</li>
</ul>
</li>
<li><b>CREATE</b>: Architecture Flow Diagram<ul>
<li>Visual representation of proposal lifecycle</li>
<li>Component interaction diagram</li>
<li>Add to implementation plan</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md1240"></a>
Later: Advanced Features</h2>
<ul>
<li>VP-01: Expand CLI unit tests</li>
<li>VP-02: Integration tests with replay scripts</li>
<li>TL-01: Telemetry capture for learning</li>
</ul>
<h1><a class="anchor" id="autotoc_md1241"></a>
4. Current Issues &amp; Blockers</h1>
<h2><a class="anchor" id="autotoc_md1242"></a>
Active Issues</h2>
<p>None - all blocking issues resolved as of Oct 1, 2025</p>
<h2><a class="anchor" id="autotoc_md1243"></a>
Known Limitations (Non-Blocking)</h2>
<ol type="1">
<li>ProposalDrawer lacks keyboard navigation</li>
<li>Large diffs/logs truncated at 1000 lines (consider pagination)</li>
<li>Proposals don't persist full metadata to disk (prompt, description, sandbox_id reconstructed)</li>
<li>No policy evaluation yet (AW-04)</li>
</ol>
<h1><a class="anchor" id="autotoc_md1244"></a>
5. Architecture Overview</h1>
<h2><a class="anchor" id="autotoc_md1245"></a>
5.1. Proposal Lifecycle Flow</h2>
<div class="fragment"><div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ 1. CREATION (CLI: z3ed agent run)                               ‚îÇ</div>
<div class="line">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
<div class="line">‚îÇ User Prompt                                                      ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ MockAIService / GeminiAIService                                 ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (generates commands)                                     ‚îÇ</div>
<div class="line">‚îÇ [&quot;palette export ...&quot;, &quot;overworld set-tile ...&quot;]                ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ RomSandboxManager::CreateSandbox(rom)                           ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (creates isolated copy)                                  ‚îÇ</div>
<div class="line">‚îÇ /tmp/yaze/sandboxes/&lt;timestamp&gt;/zelda3.sfc                      ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ Execute commands on sandbox ROM                                 ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (logs each command)                                      ‚îÇ</div>
<div class="line">‚îÇ ProposalRegistry::CreateProposal(sandbox_id, prompt, desc)      ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (creates proposal directory)                             ‚îÇ</div>
<div class="line">‚îÇ /tmp/yaze/proposals/proposal-&lt;timestamp&gt;-&lt;seq&gt;/                 ‚îÇ</div>
<div class="line">‚îÇ   ‚îú‚îÄ execution.log (command outputs)                            ‚îÇ</div>
<div class="line">‚îÇ   ‚îú‚îÄ diff.txt (if generated)                                    ‚îÇ</div>
<div class="line">‚îÇ   ‚îî‚îÄ screenshots/ (if any)                                      ‚îÇ</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line"> </div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ 2. DISCOVERY (CLI: z3ed agent list)                             ‚îÇ</div>
<div class="line">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
<div class="line">‚îÇ ProposalRegistry::ListProposals()                               ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (lazy loads from disk)                                   ‚îÇ</div>
<div class="line">‚îÇ LoadProposalsFromDiskLocked()                                   ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (scans /tmp/yaze/proposals/)                             ‚îÇ</div>
<div class="line">‚îÇ Reconstructs metadata from filesystem                           ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (parses timestamps, reads logs)                          ‚îÇ</div>
<div class="line">‚îÇ Returns vector&lt;ProposalMetadata&gt;                                ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ Display table: ID | Status | Created | Prompt | Stats           ‚îÇ</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line"> </div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ 3. REVIEW (GUI: Debug ‚Üí Agent Proposals)                        ‚îÇ</div>
<div class="line">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
<div class="line">‚îÇ ProposalDrawer::Draw()                                          ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (called every frame from EditorManager)                  ‚îÇ</div>
<div class="line">‚îÇ ProposalDrawer::RefreshProposals()                              ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (calls ProposalRegistry::ListProposals)                  ‚îÇ</div>
<div class="line">‚îÇ Display proposal list (selectable table)                        ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (user clicks proposal)                                   ‚îÇ</div>
<div class="line">‚îÇ ProposalDrawer::SelectProposal(id)                              ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (loads detail content)                                   ‚îÇ</div>
<div class="line">‚îÇ Read execution.log and diff.txt from proposal directory         ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ Display detail view:                                            ‚îÇ</div>
<div class="line">‚îÇ   ‚îú‚îÄ Metadata (sandbox_id, timestamp, stats)                   ‚îÇ</div>
<div class="line">‚îÇ   ‚îú‚îÄ Diff (syntax highlighted)                                  ‚îÇ</div>
<div class="line">‚îÇ   ‚îî‚îÄ Log (command execution trace)                              ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ User decides: [Accept] [Reject] [Delete]                        ‚îÇ</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line"> </div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ 4. ACCEPTANCE (GUI: Click &quot;Accept&quot; button)                      ‚îÇ</div>
<div class="line">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
<div class="line">‚îÇ ProposalDrawer::AcceptProposal(proposal_id)                     ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ Get proposal metadata (includes sandbox_id)                     ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ RomSandboxManager::ListSandboxes()                              ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (find sandbox by ID)                                     ‚îÇ</div>
<div class="line">‚îÇ sandbox_rom_path = sandbox.rom_path                             ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ Load sandbox ROM from disk                                      ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ rom_-&gt;WriteVector(0, sandbox_rom.vector())                      ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì (copies entire sandbox ROM ‚Üí main ROM)                   ‚îÇ</div>
<div class="line">‚îÇ ROM marked dirty (save prompt appears)                          ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ ProposalRegistry::UpdateStatus(id, kAccepted)                   ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ User: File ‚Üí Save ROM                                           ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ Changes committed ‚úÖ                                            ‚îÇ</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line"> </div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ 5. REJECTION (GUI: Click &quot;Reject&quot; button)                       ‚îÇ</div>
<div class="line">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
<div class="line">‚îÇ ProposalDrawer::RejectProposal(proposal_id)                     ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ ProposalRegistry::UpdateStatus(id, kRejected)                   ‚îÇ</div>
<div class="line">‚îÇ      ‚Üì                                                           ‚îÇ</div>
<div class="line">‚îÇ Proposal preserved for audit trail                              ‚îÇ</div>
<div class="line">‚îÇ Sandbox ROM left untouched (can be cleaned up later)            ‚îÇ</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1246"></a>
5.2. Component Interaction Diagram</h2>
<div class="fragment"><div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ   CLI Layer        ‚îÇ</div>
<div class="line">‚îÇ  (z3ed commands)   ‚îÇ</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line">         ‚îÇ</div>
<div class="line">         ‚îú‚îÄ‚îÄ‚ñ∫ agent run ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">         ‚îú‚îÄ‚îÄ‚ñ∫ agent list ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
<div class="line">         ‚îî‚îÄ‚îÄ‚ñ∫ agent diff ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
<div class="line">                                  ‚îÇ</div>
<div class="line">         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">         ‚îÇ         CLI Service Layer                     ‚îÇ</div>
<div class="line">         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
<div class="line">         ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ ProposalRegistry (Singleton)            ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ CreateProposal()                     ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ ListProposals()                      ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ GetProposal()                        ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ UpdateStatus()                       ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ RemoveProposal()                     ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ LoadProposalsFromDiskLocked()        ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ</div>
<div class="line">         ‚îÇ               ‚îÇ                               ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ RomSandboxManager (Singleton)          ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ CreateSandbox()                     ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ ActiveSandbox()                     ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ ListSandboxes()                     ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ RemoveSandbox()                     ‚îÇ  ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ</div>
<div class="line">         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line">                         ‚îÇ</div>
<div class="line">         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">         ‚îÇ         Filesystem Layer                       ‚îÇ</div>
<div class="line">         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
<div class="line">         ‚îÇ  /tmp/yaze/proposals/                          ‚îÇ</div>
<div class="line">         ‚îÇ    ‚îî‚îÄ proposal-&lt;timestamp&gt;-&lt;seq&gt;/              ‚îÇ</div>
<div class="line">         ‚îÇ         ‚îú‚îÄ execution.log                       ‚îÇ</div>
<div class="line">         ‚îÇ         ‚îú‚îÄ diff.txt                            ‚îÇ</div>
<div class="line">         ‚îÇ         ‚îî‚îÄ screenshots/                        ‚îÇ</div>
<div class="line">         ‚îÇ                                                ‚îÇ</div>
<div class="line">         ‚îÇ  /tmp/yaze/sandboxes/                          ‚îÇ</div>
<div class="line">         ‚îÇ    ‚îî‚îÄ &lt;timestamp&gt;-&lt;seq&gt;/                       ‚îÇ</div>
<div class="line">         ‚îÇ         ‚îî‚îÄ zelda3.sfc (isolated ROM copy)      ‚îÇ</div>
<div class="line">         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line">                         ‚ñ≤</div>
<div class="line">                         ‚îÇ</div>
<div class="line">         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">         ‚îÇ         GUI Layer                              ‚îÇ</div>
<div class="line">         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
<div class="line">         ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ EditorManager                           ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ current_rom_                         ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ proposal_drawer_                     ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ Update() { proposal_drawer_.Draw() } ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ</div>
<div class="line">         ‚îÇ               ‚îÇ                                ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ ProposalDrawer                          ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ rom_ (ptr to EditorManager&#39;s ROM)    ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ Draw()                               ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ DrawProposalList()                   ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ DrawProposalDetail()                 ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ AcceptProposal() ‚Üê ROM MERGE         ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ RejectProposal()                     ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îÇ  ‚Ä¢ DeleteProposal()                     ‚îÇ   ‚îÇ</div>
<div class="line">         ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ</div>
<div class="line">         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1247"></a>
5.3. Data Flow: Agent Run to ROM Merge</h2>
<div class="fragment"><div class="line">User: &quot;Make soldiers wear red armor&quot;</div>
<div class="line">         ‚îÇ</div>
<div class="line">         ‚ñº</div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ MockAIService          ‚îÇ Generates: [&quot;palette export sprites_aux1 4 soldier.col&quot;]</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line">         ‚îÇ</div>
<div class="line">         ‚ñº</div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ RomSandboxManager      ‚îÇ Creates: /tmp/.../sandboxes/20251001T200215-1/zelda3.sfc</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line">         ‚îÇ</div>
<div class="line">         ‚ñº</div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ Command Executor       ‚îÇ Runs: palette export on sandbox ROM</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line">         ‚îÇ</div>
<div class="line">         ‚ñº</div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ ProposalRegistry       ‚îÇ Creates: proposal-20251001T200215-1/</div>
<div class="line">‚îÇ                        ‚îÇ   ‚Ä¢ execution.log: &quot;[timestamp] palette export succeeded&quot;</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚Ä¢ diff.txt: (if diff generated)</div>
<div class="line">         ‚îÇ</div>
<div class="line">         ‚îÇ Time passes... user launches GUI</div>
<div class="line">         ‚ñº</div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ ProposalDrawer loads   ‚îÇ Reads: /tmp/.../proposals/proposal-*/</div>
<div class="line">‚îÇ                        ‚îÇ Displays: List of proposals</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line">         ‚îÇ</div>
<div class="line">         ‚îÇ User clicks &quot;Accept&quot;</div>
<div class="line">         ‚ñº</div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ AcceptProposal()       ‚îÇ 1. Find sandbox ROM: /tmp/.../sandboxes/.../zelda3.sfc</div>
<div class="line">‚îÇ                        ‚îÇ 2. Load sandbox ROM</div>
<div class="line">‚îÇ                        ‚îÇ 3. rom_-&gt;WriteVector(0, sandbox_rom.vector())</div>
<div class="line">‚îÇ                        ‚îÇ 4. Main ROM now contains all sandbox changes</div>
<div class="line">‚îÇ                        ‚îÇ 5. ROM marked dirty</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
<div class="line">         ‚îÇ</div>
<div class="line">         ‚ñº</div>
<div class="line">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
<div class="line">‚îÇ User: File ‚Üí Save      ‚îÇ Changes persisted to disk ‚úÖ</div>
<div class="line">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1248"></a>
5. Open Questions</h1>
<ul>
<li>What serialization format should the proposal registry adopt for diff payloads (binary vs. textual vs. hybrid)? \ ‚û§ Decision: pursue a hybrid package (<code>.z3ed-diff</code>) that wraps binary tile/object deltas alongside a JSON metadata envelope (identifiers, texture descriptors, preview palette info). Capture format draft under RC/AW backlog.</li>
<li>How should the harness authenticate escalation requests for mutation actions? \ ‚û§ Still open‚Äîevaluate shared-secret vs. interactive user prompt in the harness spike (IT-01).</li>
<li>Can we reuse existing regression test infrastructure for nightly <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> runs or should we spin up a dedicated binary? \ ‚û§ Investigate during the ImGuiTestHarness spike; compare extending <code>yaze_test</code> jobs versus introducing a lightweight automation runner.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1249"></a>
4. Work History &amp; Key Decisions</h1>
<p>This section provides a high-level summary of completed workstreams and major architectural decisions.</p>
<h2><a class="anchor" id="autotoc_md1250"></a>
Resource Catalogue Workstream (RC) - ‚úÖ COMPLETE</h2>
<ul>
<li><b>Outcome</b>: A machine-readable API specification for all <code>z3ed</code> commands.</li>
<li><b>Artifact</b>: <code>docs/api/z3ed-resources.yaml</code> is the generated source of truth.</li>
<li><b>Details</b>: Implemented a schema system and serialization for all CLI resources (ROM, Palette, Agent, etc.), enabling AI consumption.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1251"></a>
Acceptance Workflow (AW-01, AW-02, AW-03) - ‚úÖ COMPLETE</h2>
<ul>
<li><b>Outcome</b>: A complete, human-in-the-loop proposal review system.</li>
<li><b>Components</b>:<ul>
<li><code>RomSandboxManager</code>: For creating isolated ROM copies.</li>
<li><code>ProposalRegistry</code>: For tracking proposals, diffs, and logs with disk persistence.</li>
<li><code>ProposalDrawer</code>: An <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> panel for reviewing, accepting, and rejecting proposals, with full ROM merging capabilities.</li>
</ul>
</li>
<li><b>Integration</b>: The <code>agent run</code>, <code>agent list</code>, and <code>agent diff</code> commands are fully integrated with the registry. The GUI and CLI share the same underlying proposal data.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1252"></a>
ImGuiTestHarness (IT-01, IT-02) - ‚úÖ CORE COMPLETE</h2>
<ul>
<li><b>Outcome</b>: A gRPC-based service for automated GUI testing.</li>
<li><b>Decision</b>: Chose <b>gRPC</b> for its performance, cross-platform support, and type safety.</li>
<li><b>Features</b>: Implemented 6 core RPCs: <code>Ping</code>, <code>Click</code>, <code>Type</code>, <code>Wait</code>, <code>Assert</code>, and a stubbed <code>Screenshot</code>.</li>
<li><b>Integration</b>: The <code>z3ed agent test</code> command can translate natural language prompts into a sequence of gRPC calls to execute tests.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1253"></a>
Files Modified/Created</h2>
<p>A summary of files created or changed during the implementation of the core <code>z3ed</code> infrastructure.</p>
<p><b>Core Services &amp; CLI Handlers</b>:</p><ul>
<li><code>src/cli/service/proposal_registry.{h,cc}</code></li>
<li><code>src/cli/service/rom_sandbox_manager.{h,cc}</code></li>
<li><code>src/cli/service/resource_catalog.{h,cc}</code></li>
<li><code><a class="el" href="../../d2/d0e/agent_8cc.html">src/cli/handlers/agent.cc</a></code></li>
<li><code><a class="el" href="../../d4/d1a/cli_2handlers_2rom_8cc.html">src/cli/handlers/rom.cc</a></code></li>
</ul>
<p><b>GUI &amp; Application Integration</b>:</p><ul>
<li><code>src/app/editor/system/proposal_drawer.{h,cc}</code></li>
<li><code>src/app/editor/editor_manager.{h,cc}</code></li>
<li><code>src/app/core/service/imgui_test_harness_service.{h,cc}</code></li>
<li><code>src/app/core/proto/imgui_test_harness.proto</code></li>
</ul>
<p><b>Build System (CMake)</b>:</p><ul>
<li><code>src/app/app.cmake</code></li>
<li><code>src/app/emu/emu.cmake</code></li>
<li><code>src/cli/z3ed.cmake</code></li>
<li><code>src/CMakeLists.txt</code></li>
</ul>
<p><b>Documentation &amp; API Specs</b>:</p><ul>
<li><code>docs/api/z3ed-resources.yaml</code></li>
<li><code><a class="el" href="../../d3/d33/E6-z3ed-cli-design_8md.html">docs/z3ed/E6-z3ed-cli-design.md</a></code></li>
<li><code><a class="el" href="../../df/d90/E6-z3ed-implementation-plan_8md.html">docs/z3ed/E6-z3ed-implementation-plan.md</a></code></li>
<li><code><a class="el" href="../../db/d7d/E6-z3ed-reference_8md.html">docs/z3ed/E6-z3ed-reference.md</a></code></li>
<li><code><a class="el" href="../../de/d12/docs_2z3ed_2README_8md.html">docs/z3ed/README.md</a></code></li>
</ul>
<h1><a class="anchor" id="autotoc_md1254"></a>
5. Open Questions</h1>
<ul>
<li>What serialization format should the proposal registry adopt for diff payloads (binary vs. textual vs. hybrid)? \ ‚û§ Decision: pursue a hybrid package (<code>.z3ed-diff</code>) that wraps binary tile/object deltas alongside a JSON metadata envelope (identifiers, texture descriptors, preview palette info). Capture format draft under RC/AW backlog.</li>
<li>How should the harness authenticate escalation requests for mutation actions? \ ‚û§ Still open‚Äîevaluate shared-secret vs. interactive user prompt in the harness spike (IT-01).</li>
<li>Can we reuse existing regression test infrastructure for nightly <a class="el" href="../../df/de4/namespaceImGui.html">ImGui</a> runs or should we spin up a dedicated binary? \ ‚û§ Investigate during the ImGuiTestHarness spike; compare extending <code>yaze_test</code> jobs versus introducing a lightweight automation runner.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1255"></a>
6. References</h1>
<p><b>Active Documentation</b>:</p><ul>
<li><code><a class="el" href="../../d3/d33/E6-z3ed-cli-design_8md.html">E6-z3ed-cli-design.md</a></code> - Overall CLI design and architecture</li>
<li><code><a class="el" href="../../db/d7d/E6-z3ed-reference_8md.html">E6-z3ed-reference.md</a></code> - Technical command and API reference</li>
<li><code>docs/api/z3ed-resources.yaml</code> - Machine-readable API reference (generated)</li>
</ul>
<p><b>Source Code</b>:</p><ul>
<li><code>src/cli/service/</code> - Core services (proposal registry, sandbox manager, resource catalog)</li>
<li><code>src/app/editor/system/proposal_drawer.{h,cc}</code> - GUI review panel</li>
<li><code>src/app/core/service/imgui_test_harness_service.{h,cc}</code> - gRPC automation server</li>
</ul>
<hr  />
<p><b>Last Updated</b>: [Current Date] <b>Contributors</b>: @scawful, GitHub Copilot <b>License</b>: Same as YAZE (see ../../LICENSE) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
